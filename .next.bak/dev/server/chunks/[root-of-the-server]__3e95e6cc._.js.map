{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Studio/kodiack-dashboard-5500/src/lib/db.ts"],"sourcesContent":["/**\r\n * Local PostgreSQL Database Client\r\n * Provides Supabase-compatible interface for local PostgreSQL (kodiack_ai)\r\n *\r\n * This replaces @supabase/supabase-js for all dev_* and dev_ai_* tables\r\n */\r\n\r\nimport { Pool, PoolClient } from 'pg';\r\n\r\n// Create connection pool\r\nconst pool = new Pool({\r\n  host: process.env.PG_HOST || '161.35.229.220',\r\n  port: parseInt(process.env.PG_PORT || '9432'),\r\n  database: process.env.PG_DATABASE || 'kodiack_ai',\r\n  user: process.env.PG_USER || 'kodiack_admin',\r\n  password: process.env.PG_PASSWORD || 'K0d1ack_Stud10_2024',\r\n  max: 20,\r\n  idleTimeoutMillis: 30000,\r\n  connectionTimeoutMillis: 2000,\r\n});\r\n\r\n// Types\r\ninterface QueryResult<T = Record<string, unknown>> {\r\n  data: T | T[] | null;\r\n  error: Error | null;\r\n  count?: number;\r\n}\r\n\r\ninterface FilterCondition {\r\n  column: string;\r\n  operator: string;\r\n  value: unknown;\r\n}\r\n\r\n/**\r\n * QueryBuilder - Supabase-compatible query builder\r\n */\r\nclass QueryBuilder<T = Record<string, unknown>> {\r\n  private tableName: string;\r\n  private selectColumns: string = '*';\r\n  private filters: FilterCondition[] = [];\r\n  private orFilters: string[] = [];\r\n  private orderByClause: string = '';\r\n  private limitCount: number | null = null;\r\n  private offsetCount: number | null = null;\r\n  private insertData: Record<string, unknown> | Record<string, unknown>[] | null = null;\r\n  private updateData: Record<string, unknown> | null = null;\r\n  private isDelete: boolean = false;\r\n  private returnData: boolean = false;\r\n  private isSingle: boolean = false;\r\n  private isCount: boolean = false;\r\n\r\n  constructor(tableName: string) {\r\n    this.tableName = tableName;\r\n  }\r\n\r\n  select(columns: string = '*'): this {\r\n    if (columns.includes('(')) {\r\n      this.selectColumns = columns.split(',')\r\n        .map(c => c.trim())\r\n        .filter(c => !c.includes('('))\r\n        .join(', ') || '*';\r\n    } else {\r\n      this.selectColumns = columns;\r\n    }\r\n    this.returnData = true;\r\n    return this;\r\n  }\r\n\r\n  eq(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '=', value });\r\n    return this;\r\n  }\r\n\r\n  neq(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '!=', value });\r\n    return this;\r\n  }\r\n\r\n  gt(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '>', value });\r\n    return this;\r\n  }\r\n\r\n  gte(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '>=', value });\r\n    return this;\r\n  }\r\n\r\n  lt(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '<', value });\r\n    return this;\r\n  }\r\n\r\n  lte(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '<=', value });\r\n    return this;\r\n  }\r\n\r\n  like(column: string, pattern: string): this {\r\n    this.filters.push({ column, operator: 'LIKE', value: pattern });\r\n    return this;\r\n  }\r\n\r\n  ilike(column: string, pattern: string): this {\r\n    this.filters.push({ column, operator: 'ILIKE', value: pattern });\r\n    return this;\r\n  }\r\n\r\n  is(column: string, value: unknown): this {\r\n    if (value === null) {\r\n      this.filters.push({ column, operator: 'IS', value: 'NULL' });\r\n    } else {\r\n      this.filters.push({ column, operator: 'IS', value });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  not(column: string, operator: string, value: unknown): this {\r\n    if (operator === 'is' && value === null) {\r\n      this.filters.push({ column, operator: 'IS NOT', value: 'NULL' });\r\n    } else {\r\n      this.filters.push({ column, operator: `NOT ${operator.toUpperCase()}`, value });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  in(column: string, values: unknown[]): this {\r\n    this.filters.push({ column, operator: 'IN', value: values });\r\n    return this;\r\n  }\r\n\r\n  contains(column: string, value: unknown): this {\r\n    this.filters.push({ column, operator: '@>', value });\r\n    return this;\r\n  }\r\n\r\n  or(conditions: string): this {\r\n    this.orFilters.push(conditions);\r\n    return this;\r\n  }\r\n\r\n  order(column: string, options: { ascending?: boolean } = {}): this {\r\n    const direction = options.ascending === false ? 'DESC' : 'ASC';\r\n    this.orderByClause = `ORDER BY ${column} ${direction}`;\r\n    return this;\r\n  }\r\n\r\n  limit(count: number): this {\r\n    this.limitCount = count;\r\n    return this;\r\n  }\r\n\r\n  offset(count: number): this {\r\n    this.offsetCount = count;\r\n    return this;\r\n  }\r\n\r\n  single(): this {\r\n    this.isSingle = true;\r\n    this.limitCount = 1;\r\n    return this;\r\n  }\r\n\r\n  insert(data: Record<string, unknown> | Record<string, unknown>[]): this {\r\n    this.insertData = data;\r\n    return this;\r\n  }\r\n\r\n  update(data: Record<string, unknown>): this {\r\n    this.updateData = data;\r\n    return this;\r\n  }\r\n\r\n  delete(): this {\r\n    this.isDelete = true;\r\n    return this;\r\n  }\r\n\r\n  private buildWhereClause(): { clause: string; values: unknown[] } {\r\n    const conditions: string[] = [];\r\n    const values: unknown[] = [];\r\n    let paramIndex = 1;\r\n\r\n    for (const filter of this.filters) {\r\n      if (filter.operator === 'IS') {\r\n        conditions.push(`${filter.column} IS ${filter.value}`);\r\n      } else if (filter.operator === 'IN') {\r\n        const arr = filter.value as unknown[];\r\n        const placeholders = arr.map(() => `$${paramIndex++}`).join(', ');\r\n        conditions.push(`${filter.column} IN (${placeholders})`);\r\n        values.push(...arr);\r\n      } else if (filter.operator === '@>') {\r\n        conditions.push(`${filter.column} @> $${paramIndex++}`);\r\n        values.push(JSON.stringify(filter.value));\r\n      } else {\r\n        conditions.push(`${filter.column} ${filter.operator} $${paramIndex++}`);\r\n        values.push(filter.value);\r\n      }\r\n    }\r\n\r\n    for (const orCondition of this.orFilters) {\r\n      conditions.push(`(${orCondition})`);\r\n    }\r\n\r\n    const clause = conditions.length > 0 ? `WHERE ${conditions.join(' AND ')}` : '';\r\n    return { clause, values };\r\n  }\r\n\r\n  async execute(): Promise<QueryResult<T>> {\r\n    let client: PoolClient | null = null;\r\n\r\n    try {\r\n      client = await pool.connect();\r\n\r\n      // INSERT\r\n      if (this.insertData) {\r\n        const dataArray = Array.isArray(this.insertData) ? this.insertData : [this.insertData];\r\n        const columns = Object.keys(dataArray[0]);\r\n        const results: T[] = [];\r\n\r\n        for (const row of dataArray) {\r\n          const values = columns.map(col => row[col]);\r\n          const placeholders = columns.map((_, i) => `$${i + 1}`).join(', ');\r\n          const returning = this.returnData ? 'RETURNING *' : '';\r\n\r\n          const query = `INSERT INTO ${this.tableName} (${columns.join(', ')}) VALUES (${placeholders}) ${returning}`;\r\n          const result = await client.query(query, values);\r\n\r\n          if (this.returnData && result.rows.length > 0) {\r\n            results.push(result.rows[0] as T);\r\n          }\r\n        }\r\n\r\n        return {\r\n          data: this.isSingle ? (results[0] || null) : results,\r\n          error: null,\r\n        };\r\n      }\r\n\r\n      // UPDATE\r\n      if (this.updateData) {\r\n        const columns = Object.keys(this.updateData);\r\n        const { clause: whereClause, values: whereValues } = this.buildWhereClause();\r\n\r\n        const setClause = columns\r\n          .map((col, i) => `${col} = $${i + 1}`)\r\n          .join(', ');\r\n\r\n        const updateValues = columns.map(col => this.updateData![col]);\r\n\r\n        let adjustedWhere = whereClause;\r\n        whereValues.forEach((_, i) => {\r\n          const oldIndex = i + 1;\r\n          const newIndex = columns.length + i + 1;\r\n          adjustedWhere = adjustedWhere.replace(`$${oldIndex}`, `$${newIndex}`);\r\n        });\r\n\r\n        const returning = this.returnData ? 'RETURNING *' : '';\r\n        const query = `UPDATE ${this.tableName} SET ${setClause} ${adjustedWhere} ${returning}`;\r\n\r\n        const result = await client.query(query, [...updateValues, ...whereValues]);\r\n\r\n        return {\r\n          data: this.isSingle ? (result.rows[0] as T || null) : (result.rows as T[]),\r\n          error: null,\r\n        };\r\n      }\r\n\r\n      // DELETE\r\n      if (this.isDelete) {\r\n        const { clause: whereClause, values } = this.buildWhereClause();\r\n        const returning = this.returnData ? 'RETURNING *' : '';\r\n        const query = `DELETE FROM ${this.tableName} ${whereClause} ${returning}`;\r\n\r\n        const result = await client.query(query, values);\r\n        return {\r\n          data: result.rows as T[],\r\n          error: null,\r\n        };\r\n      }\r\n\r\n      // SELECT\r\n      const { clause: whereClause, values } = this.buildWhereClause();\r\n      let query = `SELECT ${this.selectColumns} FROM ${this.tableName} ${whereClause}`;\r\n\r\n      if (this.orderByClause) {\r\n        query += ` ${this.orderByClause}`;\r\n      }\r\n\r\n      if (this.limitCount !== null) {\r\n        query += ` LIMIT ${this.limitCount}`;\r\n      }\r\n\r\n      if (this.offsetCount !== null) {\r\n        query += ` OFFSET ${this.offsetCount}`;\r\n      }\r\n\r\n      const result = await client.query(query, values);\r\n\r\n      if (this.isSingle) {\r\n        return {\r\n          data: result.rows[0] as T || null,\r\n          error: null,\r\n        };\r\n      }\r\n\r\n      return {\r\n        data: result.rows as T[],\r\n        error: null,\r\n        count: result.rowCount || 0,\r\n      };\r\n\r\n    } catch (error) {\r\n      console.error('[DB Error]', error);\r\n      return {\r\n        data: null,\r\n        error: error as Error,\r\n      };\r\n    } finally {\r\n      if (client) {\r\n        client.release();\r\n      }\r\n    }\r\n  }\r\n\r\n  then<TResult1 = QueryResult<T>, TResult2 = never>(\r\n    onfulfilled?: ((value: QueryResult<T>) => TResult1 | PromiseLike<TResult1>) | null,\r\n    onrejected?: ((reason: unknown) => TResult2 | PromiseLike<TResult2>) | null\r\n  ): Promise<TResult1 | TResult2> {\r\n    return this.execute().then(onfulfilled, onrejected);\r\n  }\r\n}\r\n\r\n/**\r\n * Database client with Supabase-compatible interface\r\n */\r\nexport const db = {\r\n  from<T = Record<string, unknown>>(tableName: string): QueryBuilder<T> {\r\n    return new QueryBuilder<T>(tableName);\r\n  },\r\n\r\n  async query<T = Record<string, unknown>>(sql: string, params: unknown[] = []): Promise<QueryResult<T>> {\r\n    let client: PoolClient | null = null;\r\n    try {\r\n      client = await pool.connect();\r\n      const result = await client.query(sql, params);\r\n      return {\r\n        data: result.rows as T[],\r\n        error: null,\r\n        count: result.rowCount || 0,\r\n      };\r\n    } catch (error) {\r\n      return {\r\n        data: null,\r\n        error: error as Error,\r\n      };\r\n    } finally {\r\n      if (client) {\r\n        client.release();\r\n      }\r\n    }\r\n  },\r\n\r\n  getPool(): Pool {\r\n    return pool;\r\n  },\r\n};\r\n\r\nexport function createLocalClient() {\r\n  return db;\r\n}\r\n\r\nexport default db;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 431, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/Studio/kodiack-dashboard-5500/src/app/project-management/api/clients/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { db } from '@/lib/db';\r\n\r\n/**\r\n * GET /project-management/api/clients\r\n * List all active clients for the project form dropdown\r\n */\r\nexport async function GET() {\r\n  try {\r\n    const { data: clients, error } = await db\r\n      .from('dev_clients')\r\n      .select('id, name, slug')\r\n      .eq('active', true)\r\n      .order('name', { ascending: true });\r\n\r\n    if (error) {\r\n      console.error('Error fetching clients:', error);\r\n      return NextResponse.json({ success: false, error: 'Failed to fetch clients' }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      clients: clients || [],\r\n    });\r\n  } catch (error) {\r\n    console.error('Error in clients GET:', error);\r\n    return NextResponse.json({ success: false, error: 'Internal server error' }, { status: 500 });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;;;;AAMO,eAAe;IACpB,IAAI;QACF,MAAM,EAAE,MAAM,OAAO,EAAE,KAAK,EAAE,GAAG,MAAM,kKAAE,CACtC,IAAI,CAAC,eACL,MAAM,CAAC,kBACP,EAAE,CAAC,UAAU,MACb,KAAK,CAAC,QAAQ;YAAE,WAAW;QAAK;QAEnC,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO,0LAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAO,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/F;QAEA,OAAO,0LAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS,WAAW,EAAE;QACxB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,0LAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAO,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7F;AACF"}}]
}