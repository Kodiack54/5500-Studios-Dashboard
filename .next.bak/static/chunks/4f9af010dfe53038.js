(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14287,e=>{"use strict";var t=e.i(4828);function s({ticket:e}){let s=e=>new Date(e).toLocaleString();return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-gray-700",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 text-lg font-bold",children:e.user_name?.charAt(0)||e.user_email?.charAt(0)||"?"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium text-white",children:e.user_name||"Unknown User"}),(0,t.jsx)("div",{className:"text-sm text-gray-400",children:e.user_email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${{open:"bg-blue-500/20 text-blue-400",awaiting_response:"bg-yellow-500/20 text-yellow-400",in_progress:"bg-purple-500/20 text-purple-400",resolved:"bg-green-500/20 text-green-400",closed:"bg-gray-500/20 text-gray-400"}[e.status]}`,children:e.status.replace(/_/g," ")}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded ${{low:"bg-gray-500/20 text-gray-400",normal:"bg-blue-500/20 text-blue-400",high:"bg-yellow-500/20 text-yellow-400",urgent:"bg-red-500/20 text-red-400"}[e.priority]}`,children:e.priority}),(0,t.jsx)("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded",children:e.category})]}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Original Message"}),e.description?(0,t.jsx)("div",{className:"text-gray-300 whitespace-pre-wrap",children:e.description}):(0,t.jsx)("div",{className:"text-gray-500 italic",children:"No description provided"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-gray-700 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Created ",s(e.created_at)]}),(0,t.jsx)("span",{children:"·"}),(0,t.jsxs)("span",{children:["Updated ",s(e.updated_at)]})]})]})}e.s(["default",()=>s])},74329,e=>{"use strict";var t=e.i(4828),s=e.i(65508);function r({ticketId:e,history:r,cannedResponses:a}){let[l,n]=(0,s.useState)(""),[i,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1),[x,u]=(0,s.useState)(!1),p=async t=>{if(t.preventDefault(),l.trim()){c(!0);try{let t=await fetch(`/api/helpdesk/user-tickets/${e}/reply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:l,is_internal:i})}),s=await t.json();s.success?(n(""),window.location.reload()):alert(s.error||"Failed to send reply")}catch(e){alert(e.message)}finally{c(!1)}}},g=e=>new Date(e).toLocaleString();return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Conversation"}),(0,t.jsxs)("div",{className:"space-y-4 mb-6 max-h-[500px] overflow-y-auto",children:[r.map(e=>{if("status_change"===e.type)return(0,t.jsxs)("div",{className:"text-center text-xs text-gray-500 py-2",children:[e.content," · ",g(e.created_at)]},e.id);let s="agent"===e.author_type;return(0,t.jsx)("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[80%] rounded-lg p-4 ${e.is_internal?"bg-yellow-500/10 border border-yellow-500/30":s?"bg-purple-500/20":"bg-gray-900"}`,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${s?"bg-purple-500/30 text-purple-400":"bg-blue-500/30 text-blue-400"}`,children:e.author.charAt(0)}),(0,t.jsx)("span",{className:"text-sm text-gray-400",children:e.author}),e.is_internal&&(0,t.jsx)("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"Internal Note"}),(0,t.jsx)("span",{className:"text-xs text-gray-600 ml-auto",children:g(e.created_at)})]}),(0,t.jsx)("div",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:e.content})]})},e.id)}),0===r.length&&(0,t.jsx)("div",{className:"text-center py-8 text-gray-500 text-sm",children:"No conversation yet"})]}),(0,t.jsxs)("form",{onSubmit:p,children:[a.length>0&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>u(!x),className:"text-xs text-purple-400 hover:text-purple-300",children:[x?"Hide":"Show"," Canned Responses"]}),x&&(0,t.jsx)("div",{className:"mt-2 p-3 bg-gray-900 rounded-lg max-h-[150px] overflow-y-auto",children:(0,t.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>{var t;return t=e.content,void(n(e=>e+t),u(!1))},className:"w-full text-left p-2 rounded bg-gray-800 hover:bg-gray-700 transition-colors",children:[(0,t.jsx)("div",{className:"text-sm text-white",children:e.title}),(0,t.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.content})]},e.id))})})]}),(0,t.jsx)("textarea",{value:l,onChange:e=>n(e.target.value),placeholder:i?"Add an internal note...":"Type your reply to the customer...",rows:4,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-purple-500 focus:outline-none resize-none mb-3"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,t.jsx)("input",{type:"checkbox",checked:i,onChange:e=>o(e.target.checked),className:"rounded bg-gray-700 border-gray-600"}),"Internal note (not visible to customer)"]}),(0,t.jsx)("button",{type:"submit",disabled:d||!l.trim(),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50 ${i?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500 hover:text-black":"bg-purple-500 text-white hover:bg-purple-600"}`,children:d?"Sending...":i?"Add Note":"Send Reply"})]})]})]})}e.s(["default",()=>r])},78568,e=>{"use strict";var t=e.i(4828),s=e.i(65508),r=e.i(72043);function a({ticket:e,assignableUsers:a}){let l=(0,r.useRouter)(),[n,i]=(0,s.useState)(null),o=async(t,s)=>{i(t);try{let r=await fetch(`/api/helpdesk/user-tickets/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[t]:s||null})}),a=await r.json();a.success?window.location.reload():alert(a.error||`Failed to update ${t}`)}catch(e){alert(e.message)}finally{i(null)}},d=async()=>{let t=prompt("Enter resolution notes:");if(null!==t){i("resolve");try{let s=await fetch(`/api/helpdesk/user-tickets/${e.id}/close`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resolution:t})}),r=await s.json();r.success?l.push("/helpdesk/user-tickets"):alert(r.error||"Failed to resolve ticket")}catch(e){alert(e.message)}finally{i(null)}}};return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-5 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Actions"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Status"}),(0,t.jsxs)("select",{value:e.status,onChange:e=>o("status",e.target.value),disabled:"status"===n,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,t.jsx)("option",{value:"open",children:"Open"}),(0,t.jsx)("option",{value:"awaiting_response",children:"Awaiting Response"}),(0,t.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,t.jsx)("option",{value:"resolved",children:"Resolved"}),(0,t.jsx)("option",{value:"closed",children:"Closed"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Priority"}),(0,t.jsxs)("select",{value:e.priority,onChange:e=>o("priority",e.target.value),disabled:"priority"===n,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,t.jsx)("option",{value:"low",children:"Low"}),(0,t.jsx)("option",{value:"normal",children:"Normal"}),(0,t.jsx)("option",{value:"high",children:"High"}),(0,t.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Category"}),(0,t.jsxs)("select",{value:e.category,onChange:e=>o("category",e.target.value),disabled:"category"===n,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,t.jsx)("option",{value:"general",children:"General"}),(0,t.jsx)("option",{value:"billing",children:"Billing"}),(0,t.jsx)("option",{value:"technical",children:"Technical"}),(0,t.jsx)("option",{value:"account",children:"Account"}),(0,t.jsx)("option",{value:"feedback",children:"Feedback"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Assigned To"}),(0,t.jsxs)("select",{value:e.assigned_to||"",onChange:e=>o("assigned_to",e.target.value),disabled:"assigned_to"===n,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,t.jsx)("option",{value:"",children:"Unassigned"}),a.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsx)("hr",{className:"border-gray-700"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Customer"}),(0,t.jsxs)("div",{className:"bg-gray-900 rounded-lg p-3",children:[(0,t.jsx)("div",{className:"text-sm text-white",children:e.user_email}),(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",e.user_id]})]})]}),(0,t.jsx)("hr",{className:"border-gray-700"}),(0,t.jsx)("div",{className:"space-y-2",children:"resolved"!==e.status&&"closed"!==e.status&&(0,t.jsx)("button",{onClick:d,disabled:null!==n,className:"w-full px-4 py-2 bg-green-500/15 text-green-400 border border-green-500/30 rounded-lg text-sm font-semibold hover:bg-green-500 hover:text-white transition-colors disabled:opacity-50",children:"resolve"===n?"Resolving...":"Mark as Resolved"})})]})}e.s(["default",()=>a])}]);