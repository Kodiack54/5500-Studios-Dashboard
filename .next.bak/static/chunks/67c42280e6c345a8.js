(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7233,e=>{"use strict";let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},74886,43531,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>s],74886);let r=(0,t.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>r],43531)},27612,e=>{"use strict";let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["Trash2",()=>t],27612)},78917,e=>{"use strict";let t=(0,e.i(75254).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);e.s(["ExternalLink",()=>t],78917)},18716,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(53642),l=e.i(7486),i=e.i(71689);let n=(0,e.i(75254).default)("folder-git-2",[["path",{d:"M18 19a5 5 0 0 1-5-5v8",key:"sz5oeg"}],["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5",key:"1w6njk"}],["circle",{cx:"13",cy:"12",r:"2",key:"1j92g6"}],["circle",{cx:"20",cy:"19",r:"2",key:"1obnsp"}]]);var o=e.i(61911),d=e.i(7233),c=e.i(27612),p=e.i(74886),x=e.i(43531),g=e.i(78917),u=e.i(22016);function m(){(0,r.useRouter)();let e=(0,r.useParams)().id,m=(0,s.useContext)(a.PageTitleContext),h=(0,s.useContext)(a.PageActionsContext),[y,b]=(0,s.useState)(null),[f,j]=(0,s.useState)([]),[v,N]=(0,s.useState)(!0),[w,_]=(0,s.useState)(null),[k,C]=(0,s.useState)(!1),[P,S]=(0,s.useState)(!1),[D,M]=(0,s.useState)(!1),[T,$]=(0,s.useState)({name:"",slug:"",description:"",server_path:"",local_path:"",git_repo:"",droplet_name:"",droplet_ip:"",port_dev:"",port_test:"",port_prod:"",table_prefix:""}),[A,E]=(0,s.useState)(""),[z,I]=(0,s.useState)("developer"),[L,U]=(0,s.useState)(!1);(0,s.useEffect)(()=>(y&&m({title:y.name,description:`Manage projects and team for ${y.slug}`}),h(null),()=>{m({title:"",description:""})}),[y,m,h]),(0,s.useEffect)(()=>{!async function(){try{let[t,s]=await Promise.all([fetch(`/api/clients/${e}`),fetch("/api/users")]);if(!t.ok)throw Error("Failed to load client");let r=await t.json();if(b(r),s.ok){let e=await s.json();j(e)}}catch(e){_(e.message)}finally{N(!1)}}()},[e]);let q=async()=>{y&&(await navigator.clipboard.writeText(y.id),C(!0),setTimeout(()=>C(!1),2e3))},R=async t=>{t.preventDefault(),U(!0);try{let t=await fetch(`/api/clients/${e}/projects`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...T,port_dev:T.port_dev?parseInt(T.port_dev):null,port_test:T.port_test?parseInt(T.port_test):null,port_prod:T.port_prod?parseInt(T.port_prod):null})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to create project")}let s=await fetch(`/api/clients/${e}`),r=await s.json();b(r),S(!1),$({name:"",slug:"",description:"",server_path:"",local_path:"",git_repo:"",droplet_name:"",droplet_ip:"",port_dev:"",port_test:"",port_prod:"",table_prefix:""})}catch(e){alert(e.message)}finally{U(!1)}},F=async t=>{t.preventDefault(),U(!0);try{let t=await fetch(`/api/clients/${e}/devs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:A,role:z})});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to assign dev")}let s=await fetch(`/api/clients/${e}`),r=await s.json();b(r),M(!1),E(""),I("developer")}catch(e){alert(e.message)}finally{U(!1)}},O=async t=>{if(confirm("Remove this developer from the client?"))try{if(!(await fetch(`/api/clients/${e}/devs?assignmentId=${t}`,{method:"DELETE"})).ok)throw Error("Failed to remove dev");let s=await fetch(`/api/clients/${e}`),r=await s.json();b(r)}catch(e){alert(e.message)}},V=f.filter(e=>!y?.assignedDevs.some(t=>t.user_id===e.id));return v?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)("div",{className:"text-gray-400",children:"Loading client..."})}):w||!y?(0,t.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,t.jsx)("div",{className:"bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg",children:w||"Client not found"})}):(0,t.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,t.jsxs)(u.default,{href:"/settings/clients",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[(0,t.jsx)(i.ArrowLeft,{className:"w-4 h-4"}),"Back to Clients"]}),(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"w-14 h-14 bg-blue-600/20 rounded-xl flex items-center justify-center",children:(0,t.jsx)(l.Building2,{className:"w-7 h-7 text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-white",children:y.name}),(0,t.jsxs)("p",{className:"text-gray-400",children:["slug: ",y.slug]}),y.description&&(0,t.jsx)("p",{className:"text-gray-500 mt-1",children:y.description})]})]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded text-sm font-medium ${y.active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:y.active?"Active":"Inactive"})]}),(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-gray-500 text-xs uppercase font-medium",children:"Client UUID:"}),(0,t.jsx)("code",{className:"text-sm text-gray-300 bg-gray-900 px-2 py-1 rounded font-mono",children:y.id}),(0,t.jsx)("button",{onClick:q,className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Copy UUID",children:k?(0,t.jsx)(x.Check,{className:"w-4 h-4 text-green-400"}):(0,t.jsx)(p.Copy,{className:"w-4 h-4"})})]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n,{className:"w-5 h-5 text-purple-400"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Projects"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",y.projects.length,")"]})]}),(0,t.jsxs)("button",{onClick:()=>S(!0),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700 transition-colors",children:[(0,t.jsx)(d.Plus,{className:"w-4 h-4"}),"Add Project"]})]}),0===y.projects.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(n,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No projects yet"})]}):(0,t.jsx)("div",{className:"space-y-3",children:y.projects.map(e=>(0,t.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("p",{className:"text-gray-500 text-sm font-mono",children:e.slug})]}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-xs ${e.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:e.is_active?"Active":"Inactive"})]}),e.description&&(0,t.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:e.description}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:[e.droplet_ip&&(0,t.jsx)("span",{className:"bg-gray-800 px-2 py-1 rounded text-gray-400",children:e.droplet_name||e.droplet_ip}),e.port_dev&&(0,t.jsxs)("span",{className:"bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:["Dev: ",e.port_dev]}),e.port_prod&&(0,t.jsxs)("span",{className:"bg-green-500/20 text-green-400 px-2 py-1 rounded",children:["Prod: ",e.port_prod]}),e.git_repo&&(0,t.jsxs)("a",{href:e.git_repo,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 bg-gray-800 px-2 py-1 rounded text-gray-400 hover:text-white",children:[(0,t.jsx)(g.ExternalLink,{className:"w-3 h-3"}),"Git"]})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Users,{className:"w-5 h-5 text-green-400"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Assigned Developers"}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["(",y.assignedDevs.length,")"]})]}),(0,t.jsxs)("button",{onClick:()=>M(!0),disabled:0===V.length,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,t.jsx)(d.Plus,{className:"w-4 h-4"}),"Assign Dev"]})]}),0===y.assignedDevs.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(o.Users,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No developers assigned"})]}):(0,t.jsx)("div",{className:"space-y-3",children:y.assignedDevs.map(e=>(0,t.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-white",children:e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():e.email}),(0,t.jsx)("p",{className:"text-gray-500 text-sm",children:e.email}),(0,t.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,t.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:e.role}),(0,t.jsx)("span",{className:"text-xs bg-gray-700 text-gray-400 px-2 py-0.5 rounded",children:e.user_role})]})]}),(0,t.jsx)("button",{onClick:()=>O(e.assignment_id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-gray-800 rounded transition-colors",title:"Remove from client",children:(0,t.jsx)(c.Trash2,{className:"w-4 h-4"})})]},e.assignment_id))})]})]}),P&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>S(!1)}),(0,t.jsxs)("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-xl shadow-xl z-50 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-700",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Add Project"}),(0,t.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),(0,t.jsx)("input",{type:"text",value:T.name,onChange:e=>{var t;return t=e.target.value,void $({...T,name:t,slug:t.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()})},className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Slug *"}),(0,t.jsx)("input",{type:"text",value:T.slug,onChange:e=>$({...T,slug:e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Server Path *"}),(0,t.jsx)("input",{type:"text",value:T.server_path,onChange:e=>$({...T,server_path:e.target.value}),placeholder:"/var/www/project-name",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Local Path"}),(0,t.jsx)("input",{type:"text",value:T.local_path,onChange:e=>$({...T,local_path:e.target.value}),placeholder:"C:\\Projects\\project-name",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),(0,t.jsx)("textarea",{value:T.description,onChange:e=>$({...T,description:e.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Droplet Name"}),(0,t.jsx)("input",{type:"text",value:T.droplet_name,onChange:e=>$({...T,droplet_name:e.target.value}),placeholder:"Development",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Droplet IP"}),(0,t.jsx)("input",{type:"text",value:T.droplet_ip,onChange:e=>$({...T,droplet_ip:e.target.value}),placeholder:"161.35.229.220",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Dev Port"}),(0,t.jsx)("input",{type:"number",value:T.port_dev,onChange:e=>$({...T,port_dev:e.target.value}),placeholder:"3000",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Test Port"}),(0,t.jsx)("input",{type:"number",value:T.port_test,onChange:e=>$({...T,port_test:e.target.value}),placeholder:"3001",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Prod Port"}),(0,t.jsx)("input",{type:"number",value:T.port_prod,onChange:e=>$({...T,port_prod:e.target.value}),placeholder:"8080",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Git Repository"}),(0,t.jsx)("input",{type:"text",value:T.git_repo,onChange:e=>$({...T,git_repo:e.target.value}),placeholder:"https://github.com/...",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table Prefix"}),(0,t.jsx)("input",{type:"text",value:T.table_prefix,onChange:e=>$({...T,table_prefix:e.target.value}),placeholder:"client_",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[(0,t.jsx)("button",{type:"button",onClick:()=>S(!1),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:L,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:L?"Creating...":"Create Project"})]})]})]})]}),D&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>M(!1)}),(0,t.jsxs)("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-xl shadow-xl z-50 p-6 w-full max-w-md border border-gray-700",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Assign Developer"}),(0,t.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Developer"}),(0,t.jsxs)("select",{value:A,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Select a developer..."}),V.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():e.email," ","(",e.role,")"]},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Role on this Client"}),(0,t.jsxs)("select",{value:z,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,t.jsx)("option",{value:"developer",children:"Developer"}),(0,t.jsx)("option",{value:"lead",children:"Lead Developer"}),(0,t.jsx)("option",{value:"manager",children:"Project Manager"}),(0,t.jsx)("option",{value:"support",children:"Support"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[(0,t.jsx)("button",{type:"button",onClick:()=>M(!1),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:L||!A,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:L?"Assigning...":"Assign Developer"})]})]})]})]})]})}e.s(["default",()=>m],18716)}]);