(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76598,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(9912),a=e.i(16715),l=e.i(55716),n=e.i(75254);let i=(0,n.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var o=e.i(69638),d=e.i(73884),c=e.i(31278),x=e.i(18393),m=e.i(58041),g=e.i(61911),h=e.i(95116),u=e.i(39312),p=e.i(39951),b=e.i(53642),y=e.i(40688),v=e.i(70756);let j=(0,n.default)("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]),f=(0,n.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var N=e.i(3116),w=e.i(63209),k=e.i(22016);let S={"no-permission":{title:"This Area Is for Authorized Users Only",message:"You don't have the required permissions to access this page. Contact your administrator if you believe this is an error.",icon:"shield"},"no-project":{title:"Looks Like You Don't Have Access Yet",message:"This project hasn't been assigned to you. Ask your team lead to add you to this project.",icon:"lock"},"not-assigned":{title:"Oops! Access Is Limited Here",message:"You're not assigned to any projects yet. Your administrator needs to assign you to projects before you can access this area.",icon:"user"},pending:{title:"You're Almost There â€” Access Required",message:"Your account is pending approval. Once approved, you'll be able to access this area.",icon:"clock"},custom:{title:"This Page Isn't Available Right Now",message:"Something went wrong or you may not have access to this content.",icon:"alert"}},D={lock:v.Lock,shield:j,user:f,clock:N.Clock,alert:w.AlertCircle};function C({variant:e="no-permission",title:s,message:r,showBackButton:a=!0,showContactAdmin:l=!0,icon:n}){let i=S[e],o=s||i.title,d=r||i.message,c=D[n||i.icon];return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,t.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,t.jsx)("div",{className:"mb-6 flex justify-center",children:(0,t.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center",children:(0,t.jsx)(c,{className:"w-10 h-10 text-gray-500"})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-3",children:o}),(0,t.jsx)("p",{className:"text-gray-400 mb-8 leading-relaxed",children:d}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[a&&(0,t.jsx)("button",{onClick:()=>window.history.back(),className:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-lg text-white font-medium transition-colors",children:"Go Back"}),l&&(0,t.jsx)(k.default,{href:"/helpdesk/system-tickets/new",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-medium transition-colors",children:"Request Access"})]}),(0,t.jsx)("p",{className:"mt-8 text-xs text-gray-600",children:"Error code: ACCESS_DENIED"})]})})}var P=e.i(8203),T=e.i(52175);let A=[{id:"tradelines",name:"NextBid Engine"},{id:"sources",name:"NextSource"},{id:"nextbidder",name:"NextBidder"},{id:"portals",name:"NextBid Portal"},{id:"nexttech",name:"NextTech"},{id:"nexttask",name:"NextTask"},{id:"dashboard",name:"Dashboard"}];function $({locks:e,onLock:r,onUnlock:a,onRefresh:l}){let{user:n}=(0,y.useUser)(),[i,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),x=e.filter(e=>e.isActive),m=async e=>{if(confirm("Are you sure you want to release this lock?")){c(e);try{await a(e),l()}finally{c(null)}}};return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Dev Locks"}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Lock repos to prevent pulls during active development"})]}),(0,t.jsx)(T.RoleGate,{permission:"canPushToTest",children:(0,t.jsx)("button",{onClick:()=>o(!0),className:"px-3 py-1.5 bg-yellow-500/15 text-yellow-400 border border-yellow-500/30 rounded-lg text-sm font-semibold hover:bg-yellow-500 hover:text-white transition-colors",children:"+ Create Lock"})})]}),(0,t.jsx)("div",{className:"p-4",children:0===x.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ”“"}),(0,t.jsx)("div",{children:"No active locks"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"All projects are open for deployment"})]}):(0,t.jsx)("div",{className:"space-y-3",children:x.map(e=>{let s,r,a;return(0,t.jsx)("div",{className:"bg-gray-900 border border-yellow-500/30 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-yellow-400",children:"ðŸ”’"}),(0,t.jsx)("span",{className:"font-medium text-white",children:e.projectName}),(0,t.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:e.branch})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["Locked by ",(0,t.jsx)("span",{className:"text-white",children:e.lockedBy})," ",(s=new Date(e.lockedAt),a=Math.floor((r=Math.floor((new Date().getTime()-s.getTime())/6e4))/60),r<60?`${r}m ago`:a<24?`${a}h ago`:s.toLocaleDateString())]}),(0,t.jsxs)("div",{className:"text-sm text-yellow-400/80 mt-2",children:['"',e.reason,'"']}),e.expiresAt&&(0,t.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Auto-expires: ",new Date(e.expiresAt).toLocaleString()]})]}),(n?.id===e.lockedById||n?.role==="admin"||n?.role==="lead")&&(0,t.jsx)("button",{onClick:()=>m(e.id),disabled:d===e.id,className:"px-3 py-1.5 bg-gray-700 text-gray-300 rounded-lg text-xs font-semibold hover:bg-gray-600 transition-colors disabled:opacity-50",children:d===e.id?"Releasing...":"Release"})]})},e.id)})})}),i&&(0,t.jsx)(R,{onClose:()=>o(!1),onSubmit:async e=>{await r(e),o(!1),l()}})]})}function R({onClose:e,onSubmit:r}){let{user:a}=(0,y.useUser)(),[l,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)({project:"",branch:"main",reason:"",duration:"4h"}),d=async()=>{if(!i.project)return void alert("Please select a project");if(!i.reason.trim())return void alert("Please provide a reason for the lock");n(!0);try{let e=(e=>{switch(e){case"1h":return 36e5;case"4h":default:return 144e5;case"8h":return 288e5;case"24h":return 864e5;case"indefinite":return null}})(i.duration),t=A.find(e=>e.id===i.project);await r({project:i.project,projectName:t?.name||i.project,branch:i.branch,lockedBy:a?.name||"Unknown",lockedById:a?.id||"",reason:i.reason,expiresAt:e?new Date(Date.now()+e).toISOString():null})}finally{n(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 w-full max-w-md",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Create Dev Lock"}),(0,t.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-white text-xl",children:"Ã—"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Project"}),(0,t.jsxs)("select",{value:i.project,onChange:e=>o(t=>({...t,project:e.target.value})),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"Select project..."}),A.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Branch"}),(0,t.jsx)("input",{type:"text",value:i.branch,onChange:e=>o(t=>({...t,branch:e.target.value})),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Reason ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("textarea",{value:i.reason,onChange:e=>o(t=>({...t,reason:e.target.value})),placeholder:"e.g., Implementing new authentication flow...",rows:2,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-yellow-500 focus:outline-none resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Duration"}),(0,t.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["1h","4h","8h","24h","indefinite"].map(e=>(0,t.jsx)("button",{onClick:()=>o(t=>({...t,duration:e})),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${i.duration===e?"bg-yellow-500/15 text-yellow-400 border border-yellow-500/30":"bg-gray-900 text-gray-400 border border-gray-700 hover:border-gray-600"}`,children:"indefinite"===e?"âˆž":e},e))})]}),(0,t.jsx)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-400 px-3 py-2 rounded-lg text-sm",children:"This will block git pulls on this project until the lock is released."}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg text-sm font-semibold hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:d,disabled:l||!i.project||!i.reason.trim(),className:"flex-1 px-4 py-2 bg-yellow-500 text-black rounded-lg text-sm font-semibold hover:bg-yellow-400 transition-colors disabled:opacity-50",children:l?"Creating...":"Create Lock"})]})]})]})})}let I=[{id:"tradelines",name:"NextBid Engine",currentVersion:"v2.4.0"},{id:"sources",name:"NextSource",currentVersion:"v1.1.5"},{id:"nextbidder",name:"NextBidder",currentVersion:"v2.9.1"},{id:"portals",name:"NextBid Portal",currentVersion:"v4.0.3"},{id:"nexttech",name:"NextTech",currentVersion:"v1.0.4"},{id:"nexttask",name:"NextTask",currentVersion:"v0.8.5"},{id:"dashboard",name:"Dashboard",currentVersion:"v0.9.0"}],B={blocker:{label:"Blocker",color:"bg-red-500/15 text-red-400 border-red-500/30",icon:"!!!",description:"Completely blocks deployment"},critical:{label:"Critical",color:"bg-orange-500/15 text-orange-400 border-orange-500/30",icon:"!!",description:"Major functionality broken"},major:{label:"Major",color:"bg-yellow-500/15 text-yellow-400 border-yellow-500/30",icon:"!",description:"Significant issue needs fix"}};function L({flags:e,onFlag:r,onResolve:a,onRefresh:l}){let{user:n}=(0,y.useUser)(),[i,o]=(0,s.useState)(!1),[d,c]=(0,s.useState)(null),x=e.filter(e=>!e.resolvedAt),m=x.filter(e=>"blocker"===e.severity).length,g=async e=>{if(confirm("Are you sure this bug has been fixed and verified?")){c(e);try{await a(e),l()}finally{c(null)}}};return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Bug Flags"}),m>0&&(0,t.jsxs)("span",{className:"px-2 py-0.5 bg-red-500/15 text-red-400 border border-red-500/30 rounded text-xs font-semibold",children:[m," blocker",m>1?"s":""]})]}),(0,t.jsx)("p",{className:"text-sm text-gray-400",children:"Flag bugs to block promotion to production"})]}),(0,t.jsx)(T.RoleGate,{permission:"canPushToTest",children:(0,t.jsx)("button",{onClick:()=>o(!0),className:"px-3 py-1.5 bg-red-500/15 text-red-400 border border-red-500/30 rounded-lg text-sm font-semibold hover:bg-red-500 hover:text-white transition-colors",children:"+ Flag Bug"})})]}),(0,t.jsx)("div",{className:"p-4",children:0===x.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"âœ”"}),(0,t.jsx)("div",{children:"No active bug flags"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"All projects clear for production"})]}):(0,t.jsx)("div",{className:"space-y-3",children:x.map(e=>{let s,r,a,l,n=B[e.severity];return(0,t.jsx)("div",{className:`bg-gray-900 border rounded-lg p-4 ${n.color.split(" ")[2]}`,children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsxs)("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${n.color}`,children:[n.icon," ",n.label]}),(0,t.jsx)("span",{className:"font-medium text-white",children:e.projectName}),(0,t.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:e.version})]}),(0,t.jsx)("div",{className:"text-white mt-2 font-medium",children:e.title}),e.description&&(0,t.jsx)("div",{className:"text-sm text-gray-400 mt-1",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[(0,t.jsxs)("span",{children:["Flagged by ",e.flaggedBy]}),(0,t.jsx)("span",{children:(s=new Date(e.createdAt),l=Math.floor((a=Math.floor((r=Math.floor((new Date().getTime()-s.getTime())/6e4))/60))/24),r<60?`${r}m ago`:a<24?`${a}h ago`:l<7?`${l}d ago`:s.toLocaleDateString())}),e.linkedTicketId&&(0,t.jsxs)("span",{className:"text-cyan-400",children:["Ticket #",e.linkedTicketId.slice(0,8)]})]})]}),(0,t.jsx)(T.RoleGate,{permission:"canPushToTest",children:(0,t.jsx)("button",{onClick:()=>g(e.id),disabled:d===e.id,className:"px-3 py-1.5 bg-green-500/15 text-green-400 border border-green-500/30 rounded-lg text-xs font-semibold hover:bg-green-500 hover:text-white transition-colors disabled:opacity-50",children:d===e.id?"Resolving...":"Mark Resolved"})})]})},e.id)})})}),m>0&&(0,t.jsxs)("div",{className:"mx-4 mb-4 bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg",children:[(0,t.jsx)("div",{className:"font-medium",children:"Production Deploys Blocked"}),(0,t.jsxs)("div",{className:"text-sm mt-1",children:[m," blocker bug",m>1?"s":""," must be resolved before deploying to production."]})]}),i&&(0,t.jsx)(E,{onClose:()=>o(!1),onSubmit:async e=>{await r(e),o(!1),l()}})]})}function E({onClose:e,onSubmit:r}){let{user:a}=(0,y.useUser)(),[l,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)({project:"",version:"",severity:"major",title:"",description:"",linkedTicketId:""}),d=I.find(e=>e.id===i.project),c=async()=>{if(!i.project)return void alert("Please select a project");if(!i.title.trim())return void alert("Please provide a bug title");n(!0);try{await r({project:i.project,projectName:d?.name||i.project,version:i.version,severity:i.severity,title:i.title,description:i.description,flaggedBy:a?.name||"Unknown",flaggedById:a?.id||"",linkedTicketId:i.linkedTicketId||void 0})}finally{n(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 w-full max-w-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Flag Bug"}),(0,t.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-white text-xl",children:"Ã—"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Project"}),(0,t.jsxs)("select",{value:i.project,onChange:e=>{var t;let s;return t=e.target.value,s=I.find(e=>e.id===t),void o(e=>({...e,project:t,version:s?.currentVersion||""}))},className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-red-500 focus:outline-none",children:[(0,t.jsx)("option",{value:"",children:"Select project..."}),I.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Version"}),(0,t.jsx)("input",{type:"text",value:i.version,onChange:e=>o(t=>({...t,version:e.target.value})),placeholder:"e.g., v2.4.0 or commit hash",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Severity"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(B).map(([e,s])=>(0,t.jsxs)("button",{onClick:()=>o(t=>({...t,severity:e})),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${i.severity===e?s.color:"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:[(0,t.jsxs)("div",{className:"font-bold",children:[s.icon," ",s.label]}),(0,t.jsx)("div",{className:"text-xs opacity-70 mt-0.5",children:s.description})]},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Bug Title ",(0,t.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,t.jsx)("input",{type:"text",value:i.title,onChange:e=>o(t=>({...t,title:e.target.value})),placeholder:"e.g., SAM authentication fails after timeout",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Description"}),(0,t.jsx)("textarea",{value:i.description,onChange:e=>o(t=>({...t,description:e.target.value})),placeholder:"Describe the bug and how to reproduce it...",rows:3,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none resize-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Link to Ticket (optional)"}),(0,t.jsx)("input",{type:"text",value:i.linkedTicketId,onChange:e=>o(t=>({...t,linkedTicketId:e.target.value})),placeholder:"Ticket ID or URL",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),"blocker"===i.severity&&(0,t.jsx)("div",{className:"bg-red-500/15 border border-red-500/30 text-red-400 px-3 py-2 rounded-lg text-sm",children:"Blocker flags completely block production deployments for this project."}),(0,t.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,t.jsx)("button",{onClick:e,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg text-sm font-semibold hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,t.jsx)("button",{onClick:c,disabled:l||!i.project||!i.title.trim(),className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-semibold hover:bg-red-600 transition-colors disabled:opacity-50",children:l?"Flagging...":"Flag Bug"})]})]})]})})}let O=[{scope:1,label:"Canary",slots:1,description:"Single tradeline test"},{scope:5,label:"Limited",slots:5,description:"25% of tradelines"},{scope:20,label:"Wide",slots:20,description:"All tradelines"},{scope:-1,label:"Full",slots:-1,description:"Complete rollout"}],F=[{id:"01",name:"security",port:31001},{id:"02",name:"administrative",port:31002},{id:"03",name:"facilities",port:31003},{id:"04",name:"logistics",port:31004},{id:"05",name:"electrical",port:31005},{id:"06",name:"lowvoltage",port:31006},{id:"07",name:"landscaping",port:31007},{id:"08",name:"hvac",port:31008},{id:"09",name:"plumbing",port:31009},{id:"10",name:"janitorial",port:31010},{id:"11",name:"support",port:31011},{id:"12",name:"waste",port:31012},{id:"13",name:"construction",port:31013},{id:"14",name:"roofing",port:31014},{id:"15",name:"painting",port:31015},{id:"16",name:"flooring",port:31016},{id:"17",name:"demolition",port:31017},{id:"18",name:"environmental",port:31018},{id:"19",name:"concrete",port:31019},{id:"20",name:"fencing",port:31020}];function U({deployment:e,onExpand:r,onRollback:a,onComplete:l}){var n;let{hasPermission:i}=(0,y.useUser)();i("canPushToProd");let[o,d]=(0,s.useState)(!1),[c,x]=(0,s.useState)(!1);if(!e)return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Canary Deployment"}),(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)("div",{className:"text-4xl mb-2",children:"ðŸŽ®"}),(0,t.jsx)("div",{children:"No active canary deployment"}),(0,t.jsx)("div",{className:"text-sm mt-1",children:"Start a deployment to enable canary controls"})]})]});O.find(t=>t.scope===e.currentScope)||O[0];let m=O.findIndex(t=>t.scope===e.currentScope),g=O[m+1],h="complete"===e.status,u="failed"===e.status||"rolled_back"===e.status,p="monitoring"===e.status&&g&&e.healthScore>=95,b=async()=>{if(g&&p){d(!0);try{await r(e.id,g.scope)}finally{d(!1)}}},v=async()=>{if(confirm("Are you sure you want to rollback this deployment? This will revert all deployed slots.")){x(!0);try{await a(e.id)}finally{x(!1)}}},j=async()=>{confirm("Mark this canary deployment as complete?")&&await l(e.id)};return(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,t.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Canary Deployment"}),(0,t.jsxs)("p",{className:"text-sm text-gray-400",children:[e.projectName," ",e.version]})]}),(0,t.jsx)("div",{className:`px-3 py-1 rounded-lg text-sm font-semibold capitalize ${(e=>{switch(e){case"pending":default:return"text-gray-400";case"deploying":case"expanding":return"text-blue-400";case"monitoring":return"text-cyan-400";case"complete":return"text-green-400";case"failed":return"text-red-400";case"rolled_back":return"text-orange-400"}})(e.status)}`,children:e.status.replace("_"," ")})]})}),(0,t.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:O.map((e,s)=>{let r=s<m,a=s===m;return(0,t.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[(0,t.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold border-2 ${r?"bg-green-500/20 border-green-500 text-green-400":a?"bg-cyan-500/20 border-cyan-500 text-cyan-400":"bg-gray-900 border-gray-700 text-gray-500"}`,children:r?"&#10003;":-1===e.slots?"âˆž":e.slots}),(0,t.jsx)("div",{className:`text-xs mt-2 font-medium ${a?"text-cyan-400":r?"text-green-400":"text-gray-500"}`,children:e.label}),(0,t.jsx)("div",{className:"text-xs text-gray-600",children:e.description})]}),s<O.length-1&&(0,t.jsx)("div",{className:`h-0.5 flex-1 mx-2 ${r?"bg-green-500":"bg-gray-700"}`})]},e.scope)})})}),(0,t.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:`rounded-lg p-4 ${(n=e.healthScore)>=95?"text-green-400 bg-green-500/15":n>=80?"text-yellow-400 bg-yellow-500/15":"text-red-400 bg-red-500/15"}`,children:[(0,t.jsx)("div",{className:"text-xs uppercase tracking-wider opacity-60",children:"Health Score"}),(0,t.jsxs)("div",{className:"text-3xl font-bold mt-1",children:[e.healthScore,"%"]}),(0,t.jsx)("div",{className:"text-xs mt-1",children:e.healthScore>=95?"Healthy":e.healthScore>=80?"Degraded":"Critical"})]}),(0,t.jsxs)("div",{className:`rounded-lg p-4 ${e.errorRate<=1?"text-green-400 bg-green-500/15":e.errorRate<=5?"text-yellow-400 bg-yellow-500/15":"text-red-400 bg-red-500/15"}`,children:[(0,t.jsx)("div",{className:"text-xs uppercase tracking-wider opacity-60",children:"Error Rate"}),(0,t.jsxs)("div",{className:"text-3xl font-bold mt-1",children:[e.errorRate.toFixed(1),"%"]}),(0,t.jsx)("div",{className:"text-xs mt-1",children:e.errorRate<=1?"Normal":e.errorRate<=5?"Elevated":"High"})]})]})}),(0,t.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-400 mb-3",children:["Deployed Slots (",e.deployedSlots.length,"/",-1===e.currentScope?20:e.currentScope,")"]}),(0,t.jsx)("div",{className:"grid grid-cols-10 gap-2",children:F.map(s=>{let r=e.deployedSlots.includes(s.id),a=e.targetSlots.includes(s.id);return(0,t.jsx)("div",{className:`aspect-square rounded flex items-center justify-center text-xs font-mono ${r?"bg-green-500/20 text-green-400 border border-green-500/30":a?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-gray-900 text-gray-600 border border-gray-700"}`,title:`${s.name} (${s.port})`,children:s.id},s.id)})}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-green-500/20 border border-green-500/30"}),(0,t.jsx)("span",{className:"text-gray-500",children:"Deployed"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-blue-500/20 border border-blue-500/30"}),(0,t.jsx)("span",{className:"text-gray-500",children:"Target"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded bg-gray-900 border border-gray-700"}),(0,t.jsx)("span",{className:"text-gray-500",children:"Pending"})]})]})]}),!h&&!u&&(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:v,disabled:c,className:"flex-1 px-4 py-2 bg-red-500/15 text-red-400 border border-red-500/30 rounded-lg text-sm font-semibold hover:bg-red-500 hover:text-white transition-colors disabled:opacity-50",children:c?"Rolling back...":"Rollback"}),g?(0,t.jsx)(T.RoleGate,{permission:"production"===e.targetEnvironment?"canPushToProd":"canPushToTest",children:(0,t.jsx)("button",{onClick:b,disabled:!p||o,className:"flex-1 px-4 py-2 bg-cyan-500 text-white rounded-lg text-sm font-semibold hover:bg-cyan-600 transition-colors disabled:opacity-50",children:o?"Expanding...":`Expand to ${g.label} (${-1===g.slots?"All":g.slots})`})}):(0,t.jsx)(T.RoleGate,{permission:"canPushToProd",children:(0,t.jsx)("button",{onClick:j,className:"flex-1 px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600 transition-colors",children:"Complete Deployment"})})]}),!p&&"monitoring"===e.status&&g&&(0,t.jsxs)("div",{className:"mt-3 text-sm text-yellow-400 text-center",children:["Health score must be 95%+ to expand. Current: ",e.healthScore,"%"]})]}),(0,t.jsxs)("div",{className:"p-4 bg-gray-900 rounded-b-xl",children:[(0,t.jsx)("div",{className:"text-xs font-medium text-gray-400 mb-2",children:"Timeline"}),(0,t.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Started"}),(0,t.jsx)("span",{className:"text-gray-400",children:new Date(e.startedAt).toLocaleString()})]}),e.expandedAt.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-gray-500",children:["Expanded to ",O[s+1]?.label]}),(0,t.jsx)("span",{className:"text-gray-400",children:new Date(e).toLocaleString()})]},s))]})]})]})}let M=[{id:"tradelines",name:"NextBid Engine",icon:(0,t.jsx)(x.Server,{className:"w-4 h-4"}),color:"cyan",patcherPort:7101,devPort:5101,testPort:5001,prodPort:"31001-31020",devDroplet:"161.35.229.220",prodDroplet:"64.23.151.201"},{id:"dev-environment",name:"Dev Studio",icon:(0,t.jsx)(u.Zap,{className:"w-4 h-4"}),color:"cyan",patcherPort:7100,devPort:5e3,testPort:5100,prodPort:"5000",devDroplet:"161.35.229.220",prodDroplet:"161.35.229.220"},{id:"sources",name:"NextSource",icon:(0,t.jsx)(m.Database,{className:"w-4 h-4"}),color:"orange",patcherPort:7102,devPort:5102,testPort:5002,prodPort:"8002",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nextbidder",name:"NextBidder",icon:(0,t.jsx)(g.Users,{className:"w-4 h-4"}),color:"purple",patcherPort:7103,devPort:5103,testPort:5003,prodPort:"8003",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"portals",name:"NextBid Portal",icon:(0,t.jsx)(g.Users,{className:"w-4 h-4"}),color:"green",patcherPort:7104,devPort:5104,testPort:5004,prodPort:"8004",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nexttech",name:"NextTech",icon:(0,t.jsx)(h.Wrench,{className:"w-4 h-4"}),color:"pink",patcherPort:7105,devPort:5105,testPort:5005,prodPort:"8005",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nexttask",name:"NextTask",icon:(0,t.jsx)(p.ListTodo,{className:"w-4 h-4"}),color:"yellow",patcherPort:7106,devPort:5106,testPort:5006,prodPort:"8006",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"}];function z(){let{user:e,hasProjectAccess:n,hasPermission:x,isLoading:m}=(0,y.useUser)(),[g,h]=(0,s.useState)("train"),[u,p]=(0,s.useState)("tradelines"),[v,j]=(0,s.useState)(!0),[f,N]=(0,s.useState)(!1),[w,k]=(0,s.useState)({devStatus:null,prodStatus:null,ahead:0,behind:0,needsSync:!1,slots:[],health:"unknown"}),[S,D]=(0,s.useState)(""),[T,A]=(0,s.useState)(!1),[R,I]=(0,s.useState)(null),[B,E]=(0,s.useState)(null),[O,F]=(0,s.useState)([]),[z,V]=(0,s.useState)(null),[G,H]=(0,s.useState)(null),q=(0,s.useContext)(b.PageTitleContext),Y=(0,s.useContext)(b.PageActionsContext),[_,J]=(0,s.useState)([]),[W,K]=(0,s.useState)([]),[X,Z]=(0,s.useState)(null),Q=M.filter(e=>n(e.id)),ee=M.find(e=>e.id===u)||Q[0]||M[0],et=x("canPushToTest");async function es(){N(!0);try{if("tradelines"===u){let[e,t]=await Promise.all([(0,P.getDevStatus)().catch(()=>null),(0,P.getHealthAll)().catch(()=>({servers:[]}))]),s=(t?.servers||t||[]).map(e=>({slotId:e.slotId||e.slot||"??",tradeline:e.tradeline||e.name||"unknown",port:e.port||e.mainPort||0,status:e.pm2Status||e.status||"unknown",health:e.health||("online"===e.pm2Status?"healthy":"offline")})),r=s.filter(e=>"healthy"===e.health||"online"===e.status).length,a=0===s.length?"unknown":r===s.length?"healthy":r>0?"degraded":"offline";k({devStatus:e?.dev?{commit:e.dev.commit?.slice(0,7)||"unknown",branch:e.dev.branch||"main",message:e.dev.message||"",author:e.dev.author||"",date:e.dev.date||""}:null,prodStatus:e?.prod?{commit:e.prod.commit?.slice(0,7)||"unknown",branch:e.prod.branch||"main",message:e.prod.message||"",author:e.prod.author||"",date:e.prod.date||""}:null,ahead:e?.ahead||0,behind:e?.behind||0,needsSync:(e?.ahead||0)>0,slots:s,health:a})}else if("dev-environment"===u){let e=await (0,P.getDevEnvironmentStatus)().catch(()=>null);k({devStatus:{commit:"local",branch:"main",message:"Windows dev"},prodStatus:{commit:e?.status==="online"?"running":"stopped",branch:"main",message:e?.status||"unknown"},ahead:0,behind:0,needsSync:!0,slots:[{slotId:"dev-env-7501",tradeline:"dev-environment",port:7501,status:e?.status||"unknown",health:e?.status==="online"?"healthy":"offline"}],health:e?.status==="online"?"healthy":"offline"})}else k({devStatus:{commit:"dev-xxx",branch:"main",message:"Latest changes"},prodStatus:{commit:"prod-xxx",branch:"main",message:"Running version"},ahead:0,behind:0,needsSync:!1,slots:[],health:"unknown"})}catch(e){console.error("Failed to fetch status:",e)}finally{j(!1),N(!1)}}async function er(){I("pull"),E(null);try{await (0,P.gitPullDev)(),E({success:!0,message:"Git pull completed on dev server"}),await es()}catch(e){E({success:!1,message:e.message})}finally{I(null)}}async function ea(){I("compare"),E(null);try{let e=await (0,P.compareDevProd)();E({success:!0,message:`Dev is ${e.ahead||0} commits ahead, ${e.behind||0} behind`}),await es()}catch(e){E({success:!1,message:e.message})}finally{I(null)}}async function el(){I("diff");try{let e=await (0,P.getDevDiff)();D(e.diff||e.output||JSON.stringify(e,null,2)),A(!0)}catch(e){D(`Error fetching diff: ${e.message}`),A(!0)}finally{I(null)}}async function en(){if(confirm("Push dev code to all production servers? This will restart all tradelines.")){I("push"),E(null);try{await (0,P.pushDevToAllTradelines)(),E({success:!0,message:"Code pushed to all production servers"}),await es()}catch(e){E({success:!1,message:e.message})}finally{I(null)}}}async function ei(){if(confirm("Full sync deploy: git pull â†’ push to prod â†’ npm install â†’ pm2 restart all. Continue?")){I("sync"),E(null);try{await (0,P.fullSyncDeploy)(),E({success:!0,message:"Full sync deploy completed successfully"}),await es()}catch(e){E({success:!1,message:e.message})}finally{I(null)}}}async function eo(e){if(confirm(`Deploy latest code to ${e}? This will restart the tradeline.`)){I(e),E(null);try{await (0,P.pushDevToTradeline)(e),E({success:!0,message:`Deployed to ${e}`}),await es()}catch(e){E({success:!1,message:e.message})}finally{I(null)}}}function ed(){H(null)}function ec(){V(null),H(null)}(0,s.useEffect)(()=>(q({title:"Push / Pull",description:`Deploy ${ee.name} from Dev â†’ Prod`}),Y((0,t.jsxs)("div",{className:"flex gap-1",children:[et&&(0,t.jsxs)("button",{onClick:()=>ei(),className:"flex items-center gap-1.5 px-3 py-1 bg-cyan-500/80 hover:bg-cyan-500 border border-black/30 rounded-lg text-white text-sm transition-colors",children:[(0,t.jsx)(r.Rocket,{className:"w-3.5 h-3.5"}),"Full Sync Deploy"]}),(0,t.jsxs)("button",{onClick:()=>es(),className:"flex items-center gap-1.5 px-3 py-1 bg-white/10 hover:bg-white/20 border border-black/30 rounded-lg text-white text-sm transition-colors",children:[(0,t.jsx)(a.RefreshCw,{className:"w-3.5 h-3.5"}),"Refresh"]})]})),()=>Y(null)),[q,Y,ee.name]),(0,s.useEffect)(()=>{es()},[u]),(0,s.useEffect)(()=>{let e=localStorage.getItem("slotOrder");if(e)try{F(JSON.parse(e))}catch(e){console.error("Failed to parse saved slot order")}},[]);let ex=async e=>{let t={...e,id:`lock-${Date.now()}`,lockedAt:new Date().toISOString(),isActive:!0};J(e=>[...e,t])},em=async e=>{J(t=>t.map(t=>t.id===e?{...t,isActive:!1}:t))},eg=async e=>{let t={...e,id:`flag-${Date.now()}`,createdAt:new Date().toISOString()};K(e=>[...e,t])},eh=async e=>{K(t=>t.map(t=>t.id===e?{...t,resolvedAt:new Date().toISOString(),resolvedBy:"Current User"}:t))},eu=async()=>{},ep=async()=>Z(e=>e?{...e,status:"rolled_back"}:null),eb=async()=>Z(e=>e?{...e,status:"complete"}:null),ey=[{id:"train",label:"Pipeline"},{id:"locks",label:"Dev Locks",badge:_.filter(e=>e.isActive).length},{id:"bugs",label:"Bug Flags",badge:W.filter(e=>!e.resolvedAt).length},{id:"canary",label:"Canary",badge:+!!X}],ev=w.slots.filter(e=>"healthy"===e.health||"online"===e.status).length,ej=w.slots.length,ef={cyan:{bg:"bg-cyan-500/15",border:"border-cyan-500/30",text:"text-cyan-400"},orange:{bg:"bg-orange-500/15",border:"border-orange-500/30",text:"text-orange-400"},purple:{bg:"bg-purple-500/15",border:"border-purple-500/30",text:"text-purple-400"},green:{bg:"bg-green-500/15",border:"border-green-500/30",text:"text-green-400"},pink:{bg:"bg-pink-500/15",border:"border-pink-500/30",text:"text-pink-400"},yellow:{bg:"bg-yellow-500/15",border:"border-yellow-500/30",text:"text-yellow-400"}};return m||0!==Q.length?(0,t.jsxs)("div",{className:"-mt-4",children:[(0,t.jsx)("div",{className:"sticky -top-4 z-20 bg-gray-900 -mx-8 px-8 pt-4 pb-3 border-b border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Product:"}),(0,t.jsx)("div",{className:"flex gap-2",children:Q.map(e=>{let s=ef[e.color]||ef.cyan,r=u===e.id;return(0,t.jsxs)("button",{onClick:()=>p(e.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all border ${r?`${s.bg} ${s.border} ${s.text}`:"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600 hover:text-gray-300"}`,children:[e.icon,e.name,"tradelines"===e.id&&w.slots.length>0&&(0,t.jsxs)("span",{className:`text-xs px-1.5 py-0.5 rounded ${"healthy"===w.health?"bg-green-500/20 text-green-400":"degraded"===w.health?"bg-yellow-500/20 text-yellow-400":"bg-gray-700 text-gray-400"}`,children:[w.slots.filter(e=>"healthy"===e.health||"online"===e.status).length,"/",w.slots.length]})]},e.id)})}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,t.jsxs)("span",{className:`text-xs px-2 py-1 rounded ${et?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:[e?.role?e.role.charAt(0).toUpperCase()+e.role.slice(1):"Guest",et?" (Can Deploy)":" (View Only)"]}),Q.length<M.length&&(0,t.jsxs)("span",{className:"text-xs text-gray-600",children:[M.length-Q.length," unassigned"]})]})]})}),(0,t.jsxs)("div",{className:"sticky top-10 z-10 bg-gray-900 flex items-center justify-between mb-6 border-b border-gray-700 pb-4 pt-4 -mx-8 px-8",children:[(0,t.jsx)("div",{className:"flex gap-2",children:ey.map(e=>(0,t.jsxs)("button",{onClick:()=>h(e.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${g===e.id?"bg-cyan-500/15 text-cyan-400 border border-cyan-500/30":"bg-gray-800 text-gray-400 border border-gray-700 hover:border-gray-600"}`,children:[e.label,void 0!==e.badge&&e.badge>0&&(0,t.jsx)("span",{className:`px-1.5 py-0.5 rounded text-xs font-bold ${"bugs"===e.id?"bg-red-500/20 text-red-400":"locks"===e.id?"bg-yellow-500/20 text-yellow-400":"bg-cyan-500/20 text-cyan-400"}`,children:e.badge})]},e.id))}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Online/Healthy"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500 animate-pulse"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Deploying"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Needs Sync"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),(0,t.jsx)("span",{className:"text-gray-400",children:"Offline/Error"})]})]})]}),"train"===g&&(0,t.jsxs)("div",{className:"space-y-6",children:[B&&(0,t.jsx)("div",{className:`p-4 rounded-xl border ${B.success?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[B.success?(0,t.jsx)(o.CheckCircle,{className:"w-5 h-5 text-green-400"}):(0,t.jsx)(d.XCircle,{className:"w-5 h-5 text-red-400"}),(0,t.jsx)("span",{className:B.success?"text-green-400":"text-red-400",children:B.message}),(0,t.jsx)("button",{onClick:()=>E(null),className:"ml-auto text-gray-500 hover:text-white",children:"Ã—"})]})}),(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-white",children:[ee.name," Pipeline"]}),(0,t.jsxs)("p",{className:"text-gray-400 text-sm",children:["Dev (",ee.devDroplet,") â†’ Prod (",ee.prodDroplet,")"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[f&&(0,t.jsx)(c.Loader2,{className:"w-4 h-4 text-gray-400 animate-spin"}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${w.needsSync?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:w.needsSync?`${w.ahead} commits ahead`:"In Sync"})]})]}),v?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(c.Loader2,{className:"w-8 h-8 text-gray-400 animate-spin"})}):(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"bg-gray-900 border border-blue-500/30 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,t.jsx)("h3",{className:"font-semibold text-white",children:"Development"})]}),(0,t.jsxs)("span",{className:"text-xs text-gray-500",children:[":",ee.devPort]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.GitBranch,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm text-gray-300",children:w.devStatus?.branch||"main"})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Latest Commit"}),(0,t.jsx)("div",{className:"font-mono text-sm text-cyan-400",children:w.devStatus?.commit||"..."}),w.devStatus?.message&&(0,t.jsx)("div",{className:"text-xs text-gray-400 mt-1 truncate",children:w.devStatus.message})]}),(0,t.jsxs)("button",{onClick:er,disabled:null!==R||!et,title:et?void 0:"Engineer+ required to deploy",className:"w-full py-2 px-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:["pull"===R?(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(a.RefreshCw,{className:"w-4 h-4"}),"Git Pull"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,t.jsx)("button",{onClick:ea,disabled:null!==R,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 text-sm transition-colors disabled:opacity-50",children:"compare"===R?"Comparing...":"Compare Versions"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-px w-12 bg-gray-600"}),(0,t.jsx)(i,{className:"w-6 h-6 text-gray-500"}),(0,t.jsx)("div",{className:"h-px w-12 bg-gray-600"})]}),(0,t.jsx)("button",{onClick:el,disabled:null!==R,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 text-sm transition-colors disabled:opacity-50",children:"diff"===R?"Loading...":"View Diff"}),et?(0,t.jsx)("button",{onClick:en,disabled:null!==R||!w.needsSync,className:"px-6 py-3 bg-green-500/80 hover:bg-green-500 disabled:bg-gray-700 rounded-lg text-white font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:"push"===R?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.Loader2,{className:"w-4 h-4 animate-spin"}),"Deploying..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Rocket,{className:"w-4 h-4"}),"Deploy to Prod"]})}):(0,t.jsxs)("div",{className:"px-4 py-2 bg-gray-800 rounded-lg text-gray-500 text-sm text-center",children:[(0,t.jsx)("div",{className:"text-xs text-yellow-500/70 mb-1",children:"Engineer+ required"}),"Deploy to Prod"]})]}),(0,t.jsxs)("div",{className:"bg-gray-900 border border-green-500/30 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-3 h-3 rounded-full ${"tradelines"===u?ev===ej?"bg-green-500":ev>0?"bg-yellow-500":"bg-red-500":"bg-gray-500"}`}),(0,t.jsx)("h3",{className:"font-semibold text-white",children:"Production"})]}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:ee.prodPort})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.GitBranch,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-sm text-gray-300",children:w.prodStatus?.branch||"main"})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Running Commit"}),(0,t.jsx)("div",{className:"font-mono text-sm text-green-400",children:w.prodStatus?.commit||"..."}),w.prodStatus?.message&&(0,t.jsx)("div",{className:"text-xs text-gray-400 mt-1 truncate",children:w.prodStatus.message})]}),(0,t.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,t.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Slot Health"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-gray-700 rounded-full h-2",children:(0,t.jsx)("div",{className:`h-2 rounded-full ${ev===ej?"bg-green-500":"bg-yellow-500"}`,style:{width:ej>0?`${ev/ej*100}%`:"0%"}})}),(0,t.jsxs)("span",{className:"text-xs text-gray-400",children:[ev,"/",ej]})]})]})]})]})]})]}),"tradelines"===u?(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Production Slots (20)"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Drag to reorder - your order is saved"})]}),0===w.slots.length?(0,t.jsx)("div",{className:"text-center py-8 text-gray-500",children:v?"Loading slots...":"No slot data available. Check patcher connection."}):(0,t.jsx)("div",{className:"grid grid-cols-5 gap-3",children:(function(){if(0===O.length)return w.slots;let e=new Map(w.slots.map(e=>[e.slotId,e])),t=[];for(let s of O){let r=e.get(s);r&&(t.push(r),e.delete(s))}for(let s of e.values())t.push(s);return t})().map(e=>(0,t.jsxs)("div",{draggable:!0,onDragStart:t=>{V(e.slotId),t.dataTransfer.effectAllowed="move"},onDragOver:t=>{var s;return s=e.slotId,void(t.preventDefault(),s!==z&&H(s))},onDragLeave:ed,onDrop:t=>(function(e,t){if(e.preventDefault(),!z||z===t){V(null),H(null);return}let s=O.length>0?[...O]:w.slots.map(e=>e.slotId),r=s.indexOf(z),a=s.indexOf(t);-1!==r&&-1!==a&&(s.splice(r,1),s.splice(a,0,z),F(s),localStorage.setItem("slotOrder",JSON.stringify(s))),V(null),H(null)})(t,e.slotId),onDragEnd:ec,className:`bg-gray-900 border rounded-lg p-3 cursor-grab active:cursor-grabbing transition-all ${z===e.slotId?"opacity-50 scale-95":G===e.slotId?"border-cyan-500 ring-2 ring-cyan-500/30 scale-105":"healthy"===e.health||"online"===e.status?"border-green-500/30 hover:border-green-500/50":"stopped"===e.status||"offline"===e.health?"border-gray-600 hover:border-gray-500":"border-red-500/30 hover:border-red-500/50"}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("span",{className:"font-mono text-xs text-gray-400",children:[":",e.port]}),(0,t.jsx)("div",{className:`w-2 h-2 rounded-full ${"healthy"===e.health||"online"===e.status?"bg-green-500":"stopped"===e.status||"offline"===e.health?"bg-gray-500":"bg-red-500"}`})]}),(0,t.jsx)("div",{className:"text-sm font-medium text-white capitalize truncate",children:e.tradeline}),et?(0,t.jsx)("button",{onClick:()=>eo(e.tradeline),disabled:null!==R,className:"mt-2 w-full py-1 px-2 text-xs bg-gray-800 hover:bg-gray-700 rounded text-gray-400 hover:text-white transition-colors disabled:opacity-50",children:R===e.tradeline?(0,t.jsx)(c.Loader2,{className:"w-3 h-3 animate-spin mx-auto"}):"Deploy"}):(0,t.jsx)("div",{className:"mt-2 w-full py-1 px-2 text-xs bg-gray-800/50 rounded text-gray-600 text-center",children:"View Only"})]},e.slotId))})]}):(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,t.jsxs)("h3",{className:"text-lg font-semibold text-white",children:[ee.name," Status"]})}),(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2",children:ee.icon}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Patcher for ",ee.name," (port ",ee.patcherPort,") coming soon."]}),(0,t.jsxs)("p",{className:"text-gray-600 text-sm mt-2",children:["Single instance running on ",ee.prodDroplet,":",ee.prodPort]})]})]}),(0,t.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Port Reference"}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-6 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Dev Droplet"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"161.35.229.220"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":5101 - Engine Dev"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Patcher Droplet"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"134.199.209.140"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":7100 - Orchestrator"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:":7101 - Tradeline Patcher"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Engine Droplet"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"64.23.151.201"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":31001-31020 - Main"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:":31101-31120 - Fetch"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Portal Droplet"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"146.190.169.112"}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":8002 - NextSource"}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:":8004 - Portal"})]})]})]})]}),"locks"===g&&(0,t.jsx)($,{locks:_,onLock:ex,onUnlock:em,onRefresh:()=>{}}),"bugs"===g&&(0,t.jsx)(L,{flags:W,onFlag:eg,onResolve:eh,onRefresh:()=>{}}),"canary"===g&&(0,t.jsx)(U,{deployment:X,onExpand:eu,onRollback:ep,onComplete:eb}),T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/70 z-50",onClick:()=>A(!1)}),(0,t.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] max-h-[80vh] bg-gray-900 border border-gray-700 rounded-xl shadow-2xl z-50 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Code Diff (Dev vs Prod)"}),(0,t.jsx)("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-white",children:"Ã—"})]}),(0,t.jsx)("div",{className:"p-4 overflow-auto max-h-[60vh]",children:(0,t.jsx)("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap",children:S})})]})]})]}):(0,t.jsx)(C,{variant:"not-assigned"})}e.s(["default",()=>z],76598)}]);