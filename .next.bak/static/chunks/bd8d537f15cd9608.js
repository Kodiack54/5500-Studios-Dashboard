(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90172,e=>{"use strict";let s=(0,e.i(42945).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],90172)},47904,e=>{"use strict";let s=(0,e.i(42945).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>s],47904)},38862,e=>{"use strict";let s=(0,e.i(42945).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>s],38862)},86403,e=>{"use strict";let s=(0,e.i(42945).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>s],86403)},86150,e=>{"use strict";var s=e.i(4828),t=e.i(65508),a=e.i(38862),r=e.i(47904),l=e.i(90172),n=e.i(86403),i=e.i(44142),d=e.i(76352),c=e.i(79443);let o=[{id:"global",name:"Global Team",workspace:"global"},{id:"dev1",name:"Dev Team 1",workspace:"dev1"},{id:"dev2",name:"Dev Team 2",workspace:"dev2"},{id:"dev3",name:"Dev Team 3",workspace:"dev3"}],x=["Bugs Open","Bugs Fixed","Todos","Journal","Work Log","Ideas","Decisions","Lessons","System Breakdown","How-To Guide","Schematic","Reference","Naming Conventions","File Structure","Database Patterns","API Patterns","Component Patterns","Quirks & Gotchas","Snippets","Other"];function m(){let[e,r]=(0,t.useState)([]),[l,n]=(0,t.useState)({}),[i,d]=(0,t.useState)({}),[c,m]=(0,t.useState)([]),[f,y]=(0,t.useState)(null),[v,N]=(0,t.useState)({}),[w,k]=(0,t.useState)(!1),[C,_]=(0,t.useState)(null),[S,D]=(0,t.useState)(null),[T,$]=(0,t.useState)("healthy"),P=(0,t.useCallback)(async()=>{k(!0),D(null);try{let[e,s,t,a,l]=await Promise.all([fetch("/api/ai-sessions?limit=100",{cache:"no-store"}),fetch("/api/ai-sessions/buckets",{cache:"no-store"}),fetch("/api/ai-extractions",{cache:"no-store"}),fetch("/project-management/api/projects",{cache:"no-store"}),fetch("/project-management/api/projects/summary",{cache:"no-store"})]);if(!e.ok||!s.ok)throw Error("Failed to fetch from database");let i=await e.json(),c=await s.json(),x=t.ok?await t.json():{success:!1},g=a.ok?await a.json():{success:!1},u=l.ok?await l.json():{success:!1};if(i.success){r(i.sessions||[]);let e=(i.sessions||[]).filter(e=>"transcript"===e.source_type);if(e.length>0){let s=e[0],t=new Date(s.started_at||0),a=(new Date().getTime()-t.getTime())/6e4;$(a<=18?"healthy":"missed")}else $("missed")}if(c.success&&(n(c.buckets||{}),y(c.stats||null)),x.success&&d(x.buckets||{}),g.success&&g.projects){let e=g.projects,s=u.success&&u.summaries||{},t={};for(let a of e){let e=s[a.id]||{};t[a.id]={id:a.id,name:a.name,slug:a.slug,server_path:a.server_path,parent_id:a.parent_id||null,todos:e.pending_todos||e.todos||0,knowledge:e.pending_knowledge||e.knowledge||0,bugs:e.pending_bugs||e.bugs||0,children:[]}}let a=[];for(let s of e){let r=t[s.id];if(!r.parent_id){let l=[],n=r.todos,i=r.knowledge,d=r.bugs;for(let a of e)if(a.parent_id===s.id){let e=t[a.id];l.push(e),n+=e.todos,i+=e.knowledge,d+=e.bugs}a.push({...r,todos:n,knowledge:i,bugs:d,children:l.sort((e,s)=>e.name.localeCompare(s.name))})}}a.sort((e,s)=>e.name.localeCompare(s.name)),m(a)}let h=o.map(async e=>{try{let s=await fetch(`/api/ai-sessions/buckets?workspace=${e.workspace}`,{cache:"no-store"});if(s.ok){let t=(await s.json()).stats||{};return{id:e.id,status:{captured:Number(t.active||0)+Number(t.captured||0),flagged:Number(t.flagged||0),filed:Number(t.pending||0)+Number(t.cleaned||0)+Number(t.archived||0)}}}}catch{}return{id:e.id,status:{captured:0,flagged:0,filed:0}}}),p=await Promise.all(h),b={};p.forEach(e=>{b[e.id]=e.status}),N(b),_(new Date)}catch(e){D(e instanceof Error?e.message:"Database connection failed")}finally{k(!1)}},[]);(0,t.useEffect)(()=>{P()},[]),(0,t.useEffect)(()=>{let e=setInterval(P,5e3);return()=>clearInterval(e)},[P]);let I={active:Number(f?.active||l.active||0),processed:Number(f?.scrubbed||l.processed||l.pending_review||0),flagged:Number(f?.flagged||l.flagged||0),pending:Number(f?.pending||l.pending||0),published:Number(l.published||l.cataloged||0),cleaned:Number(f?.cleaned||l.cleaned||0),archived:Number(f?.archived||l.archived||0),total:Number(f?.total_sessions||Object.values(l).reduce((e,s)=>e+Number(s),0)),last24h:Number(f?.last_24h||0)},L=S?"down":"healthy";return(0,s.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 bg-gray-800 border-b border-gray-700 flex items-center justify-between shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-xl font-bold",children:"Session Logs"}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Database View"}),(0,s.jsx)(j,{health:L})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[C&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Last updated: ",C.toLocaleTimeString()]}),(0,s.jsxs)("button",{onClick:P,disabled:w,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded-lg transition-colors",children:[(0,s.jsx)(a.RefreshCw,{className:`w-4 h-4 ${w?"animate-spin":""}`}),"Refresh"]})]})]}),S&&(0,s.jsxs)("div",{className:"px-6 py-2 bg-red-900/50 border-b border-red-700 text-red-300 text-sm",children:["Database Error: ",S]}),(0,s.jsx)("div",{className:"p-4 bg-gray-850 border-b border-gray-700 shrink-0",children:(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4",children:o.map(e=>{let t=v[e.id]||{captured:0,flagged:0,filed:0};return(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-700 bg-gray-800/50",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,s.jsx)("span",{className:"font-medium text-white",children:e.name})}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-blue-400",children:t.captured}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Captured"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-purple-400",children:t.flagged}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Flagged"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-green-400",children:t.filed}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Filed"})]})]})]},e.id)})})}),(0,s.jsxs)("div",{className:"flex border-b border-gray-700 shrink-0",children:[(0,s.jsxs)("div",{className:"flex-[3] px-4 py-3 bg-gray-800/50 border-r border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-around",children:[(0,s.jsx)(u,{label:"Active",value:I.active,color:"cyan"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Processed",value:I.processed,color:"blue"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Flagged",value:I.flagged,color:"purple"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Pending",value:I.pending,color:"yellow"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Published",value:I.published,color:"indigo"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Cleaned",value:I.cleaned,color:"teal"}),(0,s.jsx)(g,{}),(0,s.jsx)(u,{label:"Archived",value:I.archived,color:"green"})]}),(0,s.jsxs)("div",{className:"text-center mt-2 text-xs text-gray-500",children:[I.total," total sessions | ",I.last24h," in last 24h"]})]}),(0,s.jsx)("div",{className:"flex-1 px-3 py-2 bg-gray-800/50",children:(0,s.jsx)("div",{className:"space-y-0.5",children:["active","processed","cleaned","archived"].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-400 capitalize",children:e}),(0,s.jsx)("span",{className:"font-mono font-bold text-white",children:l[e]||0})]},e))})})]}),(0,s.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Chad's Sessions (",e.length,")"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`w-2.5 h-2.5 rounded-full ${"healthy"===T?"bg-green-500":"bg-red-500 animate-pulse"}`,title:"healthy"===T?"Chad: Capturing every 15 min":"Chad: MISSED 15-min capture!"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Chad"})]})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("div",{className:"text-3xl mb-2",children:"ğŸ“­"}),(0,s.jsx)("p",{children:"No sessions in database"})]}):e.map(e=>(0,s.jsx)(h,{session:e},e.id))})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,s.jsx)("h2",{className:"text-sm font-medium text-gray-300",children:"Jen's Extractions"})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3",children:(0,s.jsx)("div",{className:"space-y-1",children:x.map(e=>(0,s.jsx)(p,{name:e,count:i[e]||0},e))})})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,s.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Susan's Projects (",c.length,")"]})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3",children:(0,s.jsx)("div",{className:"space-y-2",children:0===c.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("div",{className:"text-3xl mb-2",children:"ğŸ“"}),(0,s.jsx)("p",{children:"No projects"})]}):c.map(e=>(0,s.jsx)(b,{project:e},e.id))})})]})]})]})}function g(){return(0,s.jsx)("span",{className:"text-gray-600 text-xs",children:"â†’"})}function u({label:e,value:t,color:a}){return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:`text-xl font-bold ${{cyan:"text-cyan-400",blue:"text-blue-400",indigo:"text-indigo-400",purple:"text-purple-400",yellow:"text-yellow-400",teal:"text-teal-400",green:"text-green-400"}[a]||"text-gray-400"}`,children:t}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:e})]})}function h({session:e}){let t=e.started_at?function(e){let s=new Date(e),t=new Date,a=new Date(t);a.setDate(a.getDate()-1);let r=s.toDateString()===t.toDateString(),l=s.toDateString()===a.toDateString(),n=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(r)return`Today ${n}`;{if(l)return`Yesterday ${n}`;let e=s.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${e} ${n}`}}(e.started_at):"??:??",a=(()=>{if("internal_claude"===e.source_type){let s=e.terminal_port;return 5400===s?"Internal Claude (Main)":5410===s?"Internal Claude (Dev Team 1)":5420===s?"Internal Claude (Dev Team 2)":5430===s?"Internal Claude (Dev Team 3)":"Internal Claude"}return"external"===e.source_type?"External Claude":"chat_systems"===e.source_type?"Chat Systems":e.source_name&&e.source_name.trim()?e.source_name:e.user_name&&e.user_name.trim()?e.user_name:e.user_id&&!e.user_id.includes("-")?e.user_id:"Unknown"})(),r={active:"bg-cyan-900/50 text-cyan-400",processed:"bg-blue-900/50 text-blue-400",published:"bg-indigo-900/50 text-indigo-400",flagged:"bg-purple-900/50 text-purple-400",pending:"bg-yellow-900/50 text-yellow-400",cleaned:"bg-teal-900/50 text-teal-400",archived:"bg-gray-900/50 text-gray-400"};return(0,s.jsxs)("div",{className:"p-2 rounded border border-gray-700 bg-gray-800/50 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-medium text-white truncate",children:a}),(0,s.jsx)("span",{className:"text-[10px] text-gray-500 font-mono shrink-0 ml-2",children:t})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 truncate",children:e.project_path||e.source_name||"Unknown"}),(0,s.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${r[e.status||"captured"]||r.captured}`,children:e.status||"captured"})]})]})}function p({name:e,count:t}){return(0,s.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded ${{active:"bg-cyan-900/20",processed:"bg-blue-900/20",published:"bg-indigo-900/20",flagged:"bg-purple-900/20",pending:"bg-yellow-900/20",cleaned:"bg-teal-900/20",archived:"bg-gray-800/30"}[e]||"bg-gray-800/30"}`,children:[(0,s.jsx)("span",{className:`text-sm truncate ${t>0?"text-white":"text-gray-500"}`,children:e}),(0,s.jsx)("span",{className:`font-mono font-bold min-w-[24px] text-right ${t>0?"text-white":"text-gray-600"}`,children:t})]})}function b({project:e}){let[a,r]=(0,t.useState)(!1),l=e.children&&e.children.length>0,n=e.todos+e.knowledge+e.bugs;return(0,s.jsxs)("div",{className:"rounded border border-gray-700 bg-gray-800/50 overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-2 flex items-center gap-2 hover:bg-gray-700/50 cursor-pointer",onClick:()=>l&&r(!a),children:[l?a?(0,s.jsx)(i.ChevronDown,{className:"w-4 h-4 text-gray-500 shrink-0"}):(0,s.jsx)(d.ChevronRight,{className:"w-4 h-4 text-gray-500 shrink-0"}):(0,s.jsx)("div",{className:"w-4 shrink-0"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(c.default,{href:`/project-management?project=${e.slug}&allClients=true`,className:"font-medium text-white text-sm truncate hover:text-blue-400",onClick:e=>e.stopPropagation(),children:e.name}),n>0&&(0,s.jsx)("span",{className:"text-xs text-gray-400 ml-2 shrink-0",children:n})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-xs",children:[(0,s.jsxs)("span",{className:e.todos>0?"text-blue-400":"text-gray-600",children:["To-do: ",e.todos]}),(0,s.jsxs)("span",{className:e.knowledge>0?"text-green-400":"text-gray-600",children:["Knowledge: ",e.knowledge]}),(0,s.jsxs)("span",{className:e.bugs>0?"text-red-400":"text-gray-600",children:["Bugs: ",e.bugs]}),l&&(0,s.jsxs)("span",{className:"text-gray-500",children:["(",e.children.length," projects)"]})]})]})]}),a&&l&&(0,s.jsx)("div",{className:"border-t border-gray-700 bg-gray-900/50",children:e.children.map(e=>{let t=e.todos+e.knowledge+e.bugs;return(0,s.jsxs)(c.default,{href:`/project-management?project=${e.slug}&allClients=true`,className:"block p-2 pl-8 hover:bg-gray-700/30 border-b border-gray-700/50 last:border-b-0",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-gray-300 truncate",children:e.name}),t>0&&(0,s.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:t})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 mt-0.5 text-[11px]",children:[(0,s.jsx)("span",{className:e.todos>0?"text-blue-400/80":"text-gray-600",children:e.todos}),(0,s.jsx)("span",{className:e.knowledge>0?"text-green-400/80":"text-gray-600",children:e.knowledge}),(0,s.jsx)("span",{className:e.bugs>0?"text-red-400/80":"text-gray-600",children:e.bugs})]})]},e.id)})})]})}function j({health:e}){let t={healthy:{bg:"bg-green-600/20",text:"text-green-400",icon:l.CheckCircle,label:"Connected"},degraded:{bg:"bg-yellow-600/20",text:"text-yellow-400",icon:r.AlertTriangle,label:"Degraded"},down:{bg:"bg-red-600/20",text:"text-red-400",icon:n.XCircle,label:"Disconnected"}}[e],a=t.icon;return(0,s.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded ${t.bg}`,children:[(0,s.jsx)(a,{className:`w-3.5 h-3.5 ${t.text}`}),(0,s.jsx)("span",{className:`text-xs font-medium ${t.text}`,children:t.label})]})}e.s(["default",()=>m])}]);