(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90172,e=>{"use strict";let s=(0,e.i(42945).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>s],90172)},47904,e=>{"use strict";let s=(0,e.i(42945).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);e.s(["AlertTriangle",()=>s],47904)},38862,e=>{"use strict";let s=(0,e.i(42945).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>s],38862)},86403,e=>{"use strict";let s=(0,e.i(42945).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>s],86403)},86150,e=>{"use strict";var s=e.i(4828),t=e.i(65508),a=e.i(38862),r=e.i(47904),l=e.i(90172),n=e.i(86403);e.i(44142),e.i(76352),e.i(79443);let i=[{id:"global",name:"Global Team",workspace:"global"},{id:"dev1",name:"Dev Team 1",workspace:"dev1"},{id:"dev2",name:"Dev Team 2",workspace:"dev2"},{id:"dev3",name:"Dev Team 3",workspace:"dev3"}],c=["Bugs Open","Bugs Fixed","Todos","Journal","Work Log","Ideas","Decisions","Lessons","System Breakdown","How-To Guide","Schematic","Reference","Naming Conventions","File Structure","Database Patterns","API Patterns","Component Patterns","Quirks & Gotchas","Snippets","Other"];function d(){let[e,r]=(0,t.useState)([]),[l,n]=(0,t.useState)({}),[d,b]=(0,t.useState)({}),[f,j]=(0,t.useState)([]),[y,v]=(0,t.useState)([]),[N,w]=(0,t.useState)({unassigned:0,open:0,pending:0,active:0,total:0}),[k,S]=(0,t.useState)([]),[D,_]=(0,t.useState)({open:0,published:0,assigned:0,total:0}),[C,T]=(0,t.useState)([]),[$,E]=(0,t.useState)(null),[O,I]=(0,t.useState)(null),[P,L]=(0,t.useState)({}),[A,M]=(0,t.useState)(!1),[F,R]=(0,t.useState)(null),[U,z]=(0,t.useState)(null),[B,J]=(0,t.useState)("healthy"),q=(0,t.useCallback)(async()=>{M(!0),z(null);try{let[e,s,t,a,l,c,d]=await Promise.all([fetch("/api/ai-sessions?limit=100",{cache:"no-store"}),fetch("/api/ai-sessions/buckets",{cache:"no-store"}),fetch("/api/ai-extractions",{cache:"no-store"}),fetch("/api/ai-extractions/by-project",{cache:"no-store"}),fetch("/api/ai-extractions/clair",{cache:"no-store"}),fetch("/project-management/api/projects",{cache:"no-store"}),fetch("/project-management/api/projects/summary",{cache:"no-store"})]);if(!e.ok||!s.ok)throw Error("Failed to fetch from database");let o=await e.json(),x=await s.json(),g=t.ok?await t.json():{success:!1},u=a.ok?await a.json():{success:!1},m=l.ok?await l.json():{success:!1},p=c.ok?await c.json():{success:!1},h=d.ok?await d.json():{success:!1};if(o.success){r(o.sessions||[]);let e=(o.sessions||[]).filter(e=>"transcript"===e.source_type);if(e.length>0){let s=e[0],t=new Date(s.started_at||0),a=(new Date().getTime()-t.getTime())/6e4;J(a<=18?"healthy":"missed")}else J("missed")}if(x.success&&(n(x.buckets||{}),I(x.stats||null)),g.success&&b(g.buckets||{}),u.success&&(v(u.projects||[]),w(u.totals||{unassigned:0,open:0,pending:0,active:0,total:0})),m.success&&(S(m.projects||[]),_(m.totals||{open:0,published:0,assigned:0,total:0})),p.success&&p.projects){let e=p.projects,s=h.success&&h.summaries||{},t={};for(let a of e){let e=s[a.id]||{};t[a.id]={id:a.id,name:a.name,slug:a.slug,server_path:a.server_path,parent_id:a.parent_id||null,todos:e.pending_todos||e.todos||0,knowledge:e.pending_knowledge||e.knowledge||0,bugs:e.pending_bugs||e.bugs||0,children:[]}}let a=[];for(let s of e){let r=t[s.id];if(!r.parent_id){let l=[],n=r.todos,i=r.knowledge,c=r.bugs;for(let a of e)if(a.parent_id===s.id){let e=t[a.id];l.push(e),n+=e.todos,i+=e.knowledge,c+=e.bugs}a.push({...r,todos:n,knowledge:i,bugs:c,children:l.sort((e,s)=>e.name.localeCompare(s.name))})}}a.sort((e,s)=>e.name.localeCompare(s.name)),j(a)}let f=i.map(async e=>{try{let s=await fetch(`/api/ai-sessions/buckets?workspace=${e.workspace}`,{cache:"no-store"});if(s.ok){let t=(await s.json()).stats||{};return{id:e.id,status:{captured:Number(t.active||0)+Number(t.captured||0),flagged:Number(t.flagged||0),filed:Number(t.pending||0)+Number(t.cleaned||0)+Number(t.archived||0)}}}}catch{}return{id:e.id,status:{captured:0,flagged:0,filed:0}}}),y=await Promise.all(f),N={};y.forEach(e=>{N[e.id]=e.status}),L(N),R(new Date)}catch(e){z(e instanceof Error?e.message:"Database connection failed")}finally{M(!1)}},[]);(0,t.useEffect)(()=>{let e=localStorage.getItem("session-logs-project-order");if(e)try{T(JSON.parse(e))}catch{}},[]),(0,t.useEffect)(()=>{C.length>0&&localStorage.setItem("session-logs-project-order",JSON.stringify(C))},[C]);let G=e=>{E(e)},H=(e,s)=>{if(e.preventDefault(),!$||$===s)return;let t=[...new Set([...y.map(e=>e.id),...k.map(e=>e.id)])],a=C.length>0?C:t,r=a.indexOf($),l=a.indexOf(s);if(-1===r||-1===l)return;let n=[...a];n.splice(r,1),n.splice(l,0,$),T(n)},K=()=>{E(null)},X=e=>0===C.length?e:[...e].sort((e,s)=>{let t=C.indexOf(e.id),a=C.indexOf(s.id);return -1===t&&-1===a?0:-1===t?1:-1===a?-1:t-a});(0,t.useEffect)(()=>{q()},[]),(0,t.useEffect)(()=>{let e=setInterval(q,5e3);return()=>clearInterval(e)},[q]);let Q={active:Number(O?.active||l.active||0),processed:Number(O?.scrubbed||l.processed||l.pending_review||0),flagged:Number(O?.flagged||l.flagged||0),pending:Number(O?.pending||l.pending||0),published:Number(l.published||l.cataloged||0),cleaned:Number(O?.cleaned||l.cleaned||0),archived:Number(O?.archived||l.archived||0),total:Number(O?.total_sessions||Object.values(l).reduce((e,s)=>e+Number(s),0)),last24h:Number(O?.last_24h||0)},V=U?"down":"healthy";return(0,s.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white overflow-hidden",children:[(0,s.jsxs)("div",{className:"px-6 py-4 bg-gray-800 border-b border-gray-700 flex items-center justify-between shrink-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("h1",{className:"text-xl font-bold",children:"Session Logs"}),(0,s.jsx)("span",{className:"text-sm text-gray-400",children:"Database View"}),(0,s.jsx)(h,{health:V})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[F&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Last updated: ",F.toLocaleTimeString()]}),(0,s.jsxs)("button",{onClick:q,disabled:A,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded-lg transition-colors",children:[(0,s.jsx)(a.RefreshCw,{className:`w-4 h-4 ${A?"animate-spin":""}`}),"Refresh"]})]})]}),U&&(0,s.jsxs)("div",{className:"px-6 py-2 bg-red-900/50 border-b border-red-700 text-red-300 text-sm",children:["Database Error: ",U]}),(0,s.jsx)("div",{className:"p-4 bg-gray-850 border-b border-gray-700 shrink-0",children:(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4",children:i.map(e=>{let t=P[e.id]||{captured:0,flagged:0,filed:0};return(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-700 bg-gray-800/50",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,s.jsx)("span",{className:"font-medium text-white",children:e.name})}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-blue-400",children:t.captured}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Captured"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-purple-400",children:t.flagged}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Flagged"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-lg font-bold text-green-400",children:t.filed}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:"Filed"})]})]})]},e.id)})})}),(0,s.jsxs)("div",{className:"flex border-b border-gray-700 shrink-0",children:[(0,s.jsxs)("div",{className:"flex-[3] px-4 py-3 bg-gray-800/50 border-r border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center justify-around",children:[(0,s.jsx)(x,{label:"Active",value:Q.active,color:"cyan"}),(0,s.jsx)(o,{}),(0,s.jsx)(x,{label:"Processed",value:Q.processed,color:"blue"}),(0,s.jsx)(o,{}),(0,s.jsx)(x,{label:"Extracted",value:Q.flagged,color:"purple"}),(0,s.jsx)(o,{}),(0,s.jsx)(x,{label:"Pending",value:Q.pending,color:"yellow"}),(0,s.jsx)(o,{}),(0,s.jsx)(x,{label:"Cleaned",value:Q.cleaned,color:"teal"}),(0,s.jsx)(o,{}),(0,s.jsx)(x,{label:"Archived",value:Q.archived,color:"green"})]}),(0,s.jsxs)("div",{className:"text-center mt-2 text-xs text-gray-500",children:[Q.total," total sessions | ",Q.last24h," in last 24h"]})]}),(0,s.jsx)("div",{className:"flex-1 px-3 py-2 bg-gray-800/50",children:(0,s.jsx)("div",{className:"space-y-0.5",children:["active","processed","cleaned","archived"].map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-400 capitalize",children:e}),(0,s.jsx)("span",{className:"font-mono font-bold text-white",children:l[e]||0})]},e))})})]}),(0,s.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Chad's Sessions (",e.length,")"]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`w-2.5 h-2.5 rounded-full ${"healthy"===B?"bg-green-500":"bg-red-500 animate-pulse"}`,title:"healthy"===B?"Chad: Capturing every 15 min":"Chad: MISSED 15-min capture!"}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:"Chad"})]})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:0===e.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)("div",{className:"text-3xl mb-2",children:"ğŸ“­"}),(0,s.jsx)("p",{children:"No sessions in database"})]}):e.map(e=>(0,s.jsx)(g,{session:e},e.id))})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,s.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,s.jsx)("h2",{className:"text-sm font-medium text-gray-300",children:"Jen's Extractions"})}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-3",children:(0,s.jsx)("div",{className:"space-y-1",children:c.map(e=>(0,s.jsx)(p,{name:e,count:d[e]||0},e))})})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,s.jsxs)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:[(0,s.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Susan's Filing (",N.total,")"]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-1 text-[10px]",children:[(0,s.jsxs)("span",{className:"text-blue-400",children:[N.unassigned," unasgn"]}),(0,s.jsxs)("span",{className:"text-green-400",children:[N.open," open"]}),(0,s.jsxs)("span",{className:"text-yellow-400",children:[N.pending," pend"]}),(0,s.jsxs)("span",{className:"text-purple-400",children:[N.active," actv"]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-2",children:(0,s.jsx)("div",{className:"space-y-1",children:0===y.length?(0,s.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs",children:"No items filed"}):X(y).map(e=>(0,s.jsx)(u,{project:e,isDragging:$===e.id,onDragStart:()=>G(e.id),onDragOver:s=>H(s,e.id),onDragEnd:K},e.id))})})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,s.jsxs)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:[(0,s.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Clair's Published (",D.total,")"]}),(0,s.jsxs)("div",{className:"flex gap-2 mt-1 text-[10px]",children:[(0,s.jsxs)("span",{className:"text-green-400",children:[D.open," open"]}),(0,s.jsxs)("span",{className:"text-indigo-400",children:[D.published," published"]}),(0,s.jsxs)("span",{className:"text-cyan-400",children:[D.assigned," assigned"]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto p-2",children:(0,s.jsx)("div",{className:"space-y-1",children:0===k.length?(0,s.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs",children:"No items published"}):X(k).map(e=>(0,s.jsx)(m,{project:e,isDragging:$===e.id,onDragStart:()=>G(e.id),onDragOver:s=>H(s,e.id),onDragEnd:K},e.id))})})]})]})]})}function o(){return(0,s.jsx)("span",{className:"text-gray-600 text-xs",children:"â†’"})}function x({label:e,value:t,color:a}){return(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:`text-xl font-bold ${{cyan:"text-cyan-400",blue:"text-blue-400",indigo:"text-indigo-400",purple:"text-purple-400",yellow:"text-yellow-400",teal:"text-teal-400",green:"text-green-400"}[a]||"text-gray-400"}`,children:t}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500",children:e})]})}function g({session:e}){let t=e.started_at?function(e){let s=new Date(e),t=new Date,a=new Date(t);a.setDate(a.getDate()-1);let r=s.toDateString()===t.toDateString(),l=s.toDateString()===a.toDateString(),n=s.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(r)return`Today ${n}`;{if(l)return`Yesterday ${n}`;let e=s.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${e} ${n}`}}(e.started_at):"??:??",a=(()=>{if("internal_claude"===e.source_type){let s=e.terminal_port;return 5400===s?"Internal Claude (Main)":5410===s?"Internal Claude (Dev Team 1)":5420===s?"Internal Claude (Dev Team 2)":5430===s?"Internal Claude (Dev Team 3)":"Internal Claude"}return"external"===e.source_type?"External Claude":"chat_systems"===e.source_type?"Chat Systems":e.source_name&&e.source_name.trim()?e.source_name:e.user_name&&e.user_name.trim()?e.user_name:e.user_id&&!e.user_id.includes("-")?e.user_id:"Unknown"})(),r={active:"bg-cyan-900/50 text-cyan-400",processed:"bg-blue-900/50 text-blue-400",published:"bg-indigo-900/50 text-indigo-400",flagged:"bg-purple-900/50 text-purple-400",pending:"bg-yellow-900/50 text-yellow-400",cleaned:"bg-teal-900/50 text-teal-400",archived:"bg-gray-900/50 text-gray-400"};return(0,s.jsxs)("div",{className:"p-2 rounded border border-gray-700 bg-gray-800/50 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"font-medium text-white truncate",children:a}),(0,s.jsx)("span",{className:"text-[10px] text-gray-500 font-mono shrink-0 ml-2",children:t})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 truncate",children:e.project_path||e.source_name||"Unknown"}),(0,s.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${r[e.status||"captured"]||r.captured}`,children:e.status||"captured"})]})]})}function u({project:e,isDragging:t,onDragStart:a,onDragOver:r,onDragEnd:l}){return(0,s.jsxs)("div",{draggable:!0,onDragStart:a,onDragOver:r,onDragEnd:l,className:`flex items-center justify-between py-1 px-2 rounded bg-gray-800/30 text-xs cursor-grab active:cursor-grabbing ${t?"opacity-50 border border-blue-500":""}`,children:[(0,s.jsx)("span",{className:`truncate ${e.total>0?"text-white":"text-gray-500"}`,children:e.name}),(0,s.jsxs)("div",{className:"flex gap-1 shrink-0",children:[e.unassigned>0&&(0,s.jsx)("span",{className:"text-blue-400",children:e.unassigned}),e.open>0&&(0,s.jsx)("span",{className:"text-green-400",children:e.open}),e.pending>0&&(0,s.jsx)("span",{className:"text-yellow-400",children:e.pending}),e.active>0&&(0,s.jsx)("span",{className:"text-purple-400",children:e.active}),(0,s.jsx)("span",{className:"text-gray-400 font-mono min-w-[16px] text-right",children:e.total})]})]})}function m({project:e,isDragging:t,onDragStart:a,onDragOver:r,onDragEnd:l}){return(0,s.jsxs)("div",{draggable:!0,onDragStart:a,onDragOver:r,onDragEnd:l,className:`flex items-center justify-between py-1 px-2 rounded bg-gray-800/30 text-xs cursor-grab active:cursor-grabbing ${t?"opacity-50 border border-blue-500":""}`,children:[(0,s.jsx)("span",{className:`truncate ${e.total>0?"text-white":"text-gray-500"}`,children:e.name}),(0,s.jsxs)("div",{className:"flex gap-1 shrink-0",children:[e.open>0&&(0,s.jsx)("span",{className:"text-green-400",children:e.open}),e.published>0&&(0,s.jsx)("span",{className:"text-indigo-400",children:e.published}),e.assigned>0&&(0,s.jsx)("span",{className:"text-cyan-400",children:e.assigned}),(0,s.jsx)("span",{className:"text-gray-400 font-mono min-w-[16px] text-right",children:e.total})]})]})}function p({name:e,count:t}){return(0,s.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded ${{active:"bg-cyan-900/20",processed:"bg-blue-900/20",published:"bg-indigo-900/20",flagged:"bg-purple-900/20",pending:"bg-yellow-900/20",cleaned:"bg-teal-900/20",archived:"bg-gray-800/30"}[e]||"bg-gray-800/30"}`,children:[(0,s.jsx)("span",{className:`text-sm truncate ${t>0?"text-white":"text-gray-500"}`,children:e}),(0,s.jsx)("span",{className:`font-mono font-bold min-w-[24px] text-right ${t>0?"text-white":"text-gray-600"}`,children:t})]})}function h({health:e}){let t={healthy:{bg:"bg-green-600/20",text:"text-green-400",icon:l.CheckCircle,label:"Connected"},degraded:{bg:"bg-yellow-600/20",text:"text-yellow-400",icon:r.AlertTriangle,label:"Degraded"},down:{bg:"bg-red-600/20",text:"text-red-400",icon:n.XCircle,label:"Disconnected"}}[e],a=t.icon;return(0,s.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded ${t.bg}`,children:[(0,s.jsx)(a,{className:`w-3.5 h-3.5 ${t.text}`}),(0,s.jsx)("span",{className:`text-xs font-medium ${t.text}`,children:t.label})]})}e.s(["default",()=>d])}]);