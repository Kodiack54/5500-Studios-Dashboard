(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73941,e=>{"use strict";var s=e.i(4828),t=e.i(65508),a=e.i(72043),r=e.i(79443);let l=[{key:"credentials",label:"Credentials",icon:"ðŸ”‘"},{key:"naics",label:"NAICS Codes",icon:"ðŸ“‹"},{key:"psc",label:"PSC Codes",icon:"ðŸ›ï¸"},{key:"unspsc",label:"UNSPSC Codes",icon:"ðŸ·ï¸"},{key:"keywords",label:"Keywords",icon:"ðŸ”"},{key:"categories",label:"Categories",icon:"ðŸ“‚"}];function o({sourceId:e,category:o,backPath:n,showPscCodes:i=!1,showCategories:c=!1}){(0,a.useRouter)();let[d,x]=(0,t.useState)(!0),[u,m]=(0,t.useState)(!1),[g,p]=(0,t.useState)(!1),[h,y]=(0,t.useState)("credentials"),[b,f]=(0,t.useState)(null),[v,j]=(0,t.useState)(null),[N,w]=(0,t.useState)(null),[C,S]=(0,t.useState)(null),[k,E]=(0,t.useState)(""),[P,$]=(0,t.useState)(""),[T,B]=(0,t.useState)(""),[A,L]=(0,t.useState)(""),[D,U]=(0,t.useState)(""),[F,O]=(0,t.useState)(!1),[K,I]=(0,t.useState)(""),[R,_]=(0,t.useState)(""),[H,z]=(0,t.useState)(""),[J,M]=(0,t.useState)(""),[q,V]=(0,t.useState)(""),[G,Q]=(0,t.useState)(new Set),[W,X]=(0,t.useState)([]),Y=l.filter(e=>("psc"!==e.key||!!i)&&("categories"!==e.key||!!c));(0,t.useEffect)(()=>{Z()},[e,o]);let Z=async()=>{x(!0);try{let s=await fetch(`/api/patcher/sources/${o}/${e}`);if(s.ok){let e=await s.json();if(S(e.source),E(e.source.displayName||e.source.name||""),$(e.source.username||""),L(e.source.apiKey||""),U(e.source.expiresAt?.split("T")[0]||""),e.source.naicsCodes&&I(e.source.naicsCodes.map(e=>`${e.code} - ${e.name}`).join("\n")),e.source.pscCodes&&_(e.source.pscCodes.map(e=>`${e.code} - ${e.name}`).join("\n")),e.source.unspscCodes&&z(e.source.unspscCodes.map(e=>`${e.code} - ${e.name}`).join("\n")),e.source.keywords&&M(e.source.keywords.join("\n")),e.source.categories){let s=new Set(e.source.categories.filter(e=>e.selected).map(e=>e.id));Q(s)}e.source.availableCategories&&X(e.source.availableCategories)}else S({id:e,name:e,platform:o,type:"login",status:"not_configured"}),E(e)}catch(e){console.error("Failed to fetch source:",e),f("Failed to load source configuration")}finally{x(!1)}},ee=async()=>{m(!0),f(null),j(null);try{let s=e=>e.split("\n").map(e=>e.trim()).filter(Boolean).map(e=>{let[s,...t]=e.split(" - ");return{code:s.trim(),name:t.join(" - ").trim()||s.trim()}}),t={displayName:k,username:P||void 0,password:T||void 0,apiKey:A||void 0,expiresAt:D||void 0,naicsCodes:s(K),pscCodes:i?s(R):void 0,unspscCodes:s(H),keywords:J.split("\n").map(e=>e.trim()).filter(Boolean),selectedCategories:c?Array.from(G):void 0};if(!(await fetch(`/api/patcher/sources/${o}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw Error("Failed to save configuration");j("Configuration saved successfully!"),B(""),await Z()}catch(e){f(e.message)}finally{m(!1)}},es=async()=>{p(!0),w(null);try{let s=await fetch(`/api/patcher/sources/${o}/${e}/test`,{method:"POST"}),t=await s.json();w({success:t.success,message:t.message||(t.success?"Connection successful!":"Connection failed")})}catch(e){w({success:!1,message:e.message})}finally{p(!1)}},et=e=>{Q(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},ea=W.filter(e=>e.name.toLowerCase().includes(q.toLowerCase())||e.id.toLowerCase().includes(q.toLowerCase()));return d?(0,s.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-gray-400",children:"Loading source configuration..."})}):(0,s.jsxs)("div",{className:"h-full flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 p-6 border-b border-gray-700 bg-gray-800/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,s.jsx)(r.default,{href:n,className:"px-3 py-1.5 text-sm bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors",children:"â† Back"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("input",{type:"text",value:k,onChange:e=>E(e.target.value),className:"text-2xl font-bold bg-transparent text-white border-b border-transparent hover:border-gray-600 focus:border-blue-500 focus:outline-none w-full max-w-lg",placeholder:"Source name..."}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[C?.platform," â€¢ ",C?.id]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("span",{className:`px-3 py-1 rounded-lg text-sm ${C?.status==="active"?"bg-green-500/20 text-green-400":C?.status==="failed"||C?.status==="expired"?"bg-red-500/20 text-red-400":"bg-gray-700 text-gray-400"}`,children:C?.status||"not_configured"})})]}),(0,s.jsx)("div",{className:"flex gap-1",children:Y.map(e=>(0,s.jsxs)("button",{onClick:()=>y(e.key),className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors flex items-center gap-2 ${h===e.key?"bg-gray-900 text-white border-t border-l border-r border-gray-700":"text-gray-400 hover:text-white hover:bg-gray-800/50"}`,children:[(0,s.jsx)("span",{children:e.icon}),e.label]},e.key))})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[b&&(0,s.jsx)("div",{className:"mb-4 bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg text-sm",children:b}),v&&(0,s.jsx)("div",{className:"mb-4 bg-green-500/15 border border-green-500/30 text-green-400 px-4 py-3 rounded-lg text-sm",children:v}),N&&(0,s.jsx)("div",{className:`mb-4 px-4 py-3 rounded-lg text-sm ${N.success?"bg-green-500/15 border border-green-500/30 text-green-400":"bg-red-500/15 border border-red-500/30 text-red-400"}`,children:N.message}),"credentials"===h&&(0,s.jsxs)("div",{className:"max-w-2xl space-y-6",children:[C?.type==="login"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Username"}),(0,s.jsx)("input",{type:"text",value:P,onChange:e=>$(e.target.value),placeholder:"Enter username",autoComplete:"username",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Password"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:F?"text":"password",value:T,onChange:e=>B(e.target.value),placeholder:C.hasPassword?"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢":"Enter password",autoComplete:"current-password",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none pr-20"}),(0,s.jsx)("button",{type:"button",onClick:()=>O(!F),className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 hover:text-gray-400",children:F?"Hide":"Show"})]}),C.hasPassword&&!T&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave blank to keep existing password"})]})]}),C?.type==="api_key"&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"API Key"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:F?"text":"password",value:A,onChange:e=>L(e.target.value),placeholder:"Enter API key",className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none font-mono text-sm pr-20"}),(0,s.jsx)("button",{type:"button",onClick:()=>O(!F),className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-gray-500 hover:text-gray-400",children:F?"Hide":"Show"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Expiration Date (optional)"}),(0,s.jsx)("input",{type:"date",value:D,onChange:e=>U(e.target.value),className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white focus:border-blue-500 focus:outline-none"})]}),(0,s.jsx)("div",{className:"flex gap-3 pt-4",children:(0,s.jsx)("button",{onClick:es,disabled:g||C?.status==="not_configured",className:"px-4 py-2 text-sm font-medium bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 transition-colors disabled:opacity-50",children:g?"Testing...":"Test Connection"})}),C?.lastChecked&&(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Last checked: ",new Date(C.lastChecked).toLocaleString()]})]}),"naics"===h&&(0,s.jsxs)("div",{className:"max-w-3xl",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:["Enter NAICS codes, one per line. Format: ",(0,s.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"CODE - Description"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Example: 541330 - Engineering Services"})]}),(0,s.jsx)("textarea",{value:K,onChange:e=>I(e.target.value),rows:20,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white font-mono text-sm focus:border-blue-500 focus:outline-none",placeholder:"541330 - Engineering Services 238210 - Electrical Contractors 561621 - Security Systems Services"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[K.split("\n").filter(Boolean).length," codes"]})]}),"psc"===h&&i&&(0,s.jsxs)("div",{className:"max-w-3xl",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:["Enter PSC (Product Service Codes), one per line. Format: ",(0,s.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"CODE - Description"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Example: R425 - Engineering and Technical Services"})]}),(0,s.jsx)("textarea",{value:R,onChange:e=>_(e.target.value),rows:20,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white font-mono text-sm focus:border-blue-500 focus:outline-none",placeholder:"R425 - Engineering and Technical Services J099 - Maintenance of Misc Equipment S206 - Housekeeping Services"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[R.split("\n").filter(Boolean).length," codes"]})]}),"unspsc"===h&&(0,s.jsxs)("div",{className:"max-w-3xl",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:["Enter UNSPSC codes, one per line. Format: ",(0,s.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:"CODE - Description"})]}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Example: 72101500 - Building construction services"})]}),(0,s.jsx)("textarea",{value:H,onChange:e=>z(e.target.value),rows:20,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white font-mono text-sm focus:border-blue-500 focus:outline-none",placeholder:"72101500 - Building construction services 81101500 - Engineering services 92121500 - Security guard services"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[H.split("\n").filter(Boolean).length," codes"]})]}),"keywords"===h&&(0,s.jsxs)("div",{className:"max-w-3xl",children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-2",children:"Enter keywords, one per line. These will be used to search for relevant opportunities."})}),(0,s.jsx)("textarea",{value:J,onChange:e=>M(e.target.value),rows:20,className:"w-full bg-gray-800 border border-gray-700 rounded-lg px-4 py-3 text-white font-mono text-sm focus:border-blue-500 focus:outline-none",placeholder:"fire alarm security system CCTV access control intrusion detection"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:[J.split("\n").filter(Boolean).length," keywords"]})]}),"categories"===h&&c&&(0,s.jsxs)("div",{className:"max-w-4xl",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-2",children:["Select categories to monitor for this portal. Use search to filter through ",W.length," available categories."]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("input",{type:"text",value:q,onChange:e=>V(e.target.value),placeholder:"Search categories...",className:"flex-1 max-w-md bg-gray-800 border border-gray-700 rounded-lg px-4 py-2 text-sm text-white placeholder-gray-500 focus:border-blue-500 focus:outline-none"}),(0,s.jsxs)("span",{className:"text-sm text-gray-400",children:[G.size," selected"]})]})]}),G.size>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Selected Categories"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Array.from(G).map(e=>{let t=W.find(s=>s.id===e);return(0,s.jsxs)("button",{onClick:()=>et(e),className:"px-2 py-1 text-xs bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded-lg hover:bg-red-500/20 hover:text-red-400 hover:border-red-500/30 transition-colors",children:[t?.name||e," Ã—"]},e)})})]}),(0,s.jsx)("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:(0,s.jsx)("div",{className:"max-h-96 overflow-y-auto",children:ea.length>0?(0,s.jsxs)("div",{className:"divide-y divide-gray-700",children:[ea.slice(0,200).map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-gray-800/50 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:G.has(e.id),onChange:()=>et(e.id),className:"w-4 h-4 rounded bg-gray-700 border-gray-600 text-blue-500 focus:ring-blue-500"}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"text-sm text-white truncate",children:e.name}),e.parent&&(0,s.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.parent})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:e.id})]},e.id)),ea.length>200&&(0,s.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-500 text-center",children:["Showing 200 of ",ea.length," results. Use search to narrow down."]})]}):(0,s.jsx)("div",{className:"px-4 py-8 text-center text-gray-500",children:q?"No categories match your search":"No categories available"})})})]})]}),(0,s.jsxs)("div",{className:"flex-shrink-0 px-6 py-4 border-t border-gray-700 bg-gray-900/50 flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-sm text-gray-500",children:C?.lastChecked&&`Last checked: ${new Date(C.lastChecked).toLocaleString()}`}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(r.default,{href:n,className:"px-4 py-2 text-sm font-medium text-gray-400 hover:text-white transition-colors",children:"Cancel"}),(0,s.jsx)("button",{onClick:ee,disabled:u,className:"px-6 py-2 text-sm font-semibold bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:opacity-50",children:u?"Saving...":"Save & Push"})]})]})]})}e.s(["default",()=>o])},87951,e=>{"use strict";var s=e.i(4828),t=e.i(65508),a=e.i(73941);function r({params:e}){let{sourceId:r}=(0,t.use)(e);return(0,s.jsx)(a.default,{sourceId:r,category:"municipal",backPath:"/credentials/municipal",showPscCodes:!1,showCategories:!1})}e.s(["default",()=>r])}]);