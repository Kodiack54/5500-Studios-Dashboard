(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77536,e=>{"use strict";var s=e.i(4828),t=e.i(65508),a=e.i(3437);let l=[{name:"SOW",offset:100},{name:"Docs",offset:200},{name:"Proposal",offset:300}];function r({name:e,displayName:t,port:a,status:r,online:n,total:i,processes:c,storageBytes:d=0,isSelected:o,onClick:x}){let m,h=c.find(e=>e.name.includes("-main")),g=h?.status==="online",p=l.map((e,s)=>{let t=c.find(t=>t.name.includes(`-w${s+2}`)||t.name.includes(e.name.toLowerCase()));return{...e,port:a+e.offset,online:t?.status==="online",cpu:t?.cpu||0,memory:t?.memory||0}}),u=c.reduce((e,s)=>e+(s.cpu||0),0),f=c.reduce((e,s)=>e+(s.memory||0),0),y=c.length>0?u/c.length:0,j=f/1048576,b={healthy:"border-green-500 bg-green-500/10",partial:"border-yellow-500 bg-yellow-500/10",stopped:"border-red-500 bg-red-500/10",degraded:"border-orange-500 bg-orange-500/10"};return(0,s.jsxs)("div",{onClick:x,className:`flex items-center gap-4 px-4 py-3 cursor-pointer border-l-4 transition-all ${b[r]||b.stopped} ${o?"ring-2 ring-blue-500 bg-blue-500/20":"hover:bg-gray-700/50"}`,children:[(0,s.jsxs)("div",{className:"w-32 flex-shrink-0",children:[(0,s.jsx)("div",{className:"font-mono text-sm text-white font-bold",children:a}),(0,s.jsx)("div",{className:"text-xs text-gray-400 truncate",children:t})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(0,s.jsx)("div",{className:`w-3 h-3 rounded-full ${g?"bg-green-500":"bg-red-500"}`,title:`Main: ${g?"Online":"Offline"}`}),p.map(e=>(0,s.jsx)("div",{className:`w-3 h-3 rounded-full ${e.online?"bg-green-500":"bg-red-500"}`,title:`${e.name}: ${e.online?"Online":"Offline"}`},e.name))]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"CPU"}),(0,s.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,s.jsx)("div",{className:`h-full transition-all ${y>80?"bg-red-500":y>50?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(y,100)}%`}})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"MEM"}),(0,s.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,s.jsx)("div",{className:`h-full transition-all ${j>400?"bg-red-500":j>200?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(j/512*100,100)}%`}})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"NET"}),(0,s.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-cyan-500",style:{width:"25%"}})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"DISK"}),(0,s.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(m=d/0x200000000*100,(0,s.jsx)("div",{className:`h-full ${m>90?"bg-red-500":m>75?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(m,100)}%`}}))})]})]}),(0,s.jsx)("div",{className:"flex-shrink-0 w-10 text-center",children:"healthy"===r?(0,s.jsx)("span",{className:"text-green-400 text-lg",children:"✓"}):"partial"===r?(0,s.jsxs)("span",{className:"text-yellow-400 text-sm",children:[n,"/",i]}):(0,s.jsx)("span",{className:"text-red-400 text-lg",children:"✗"})}),(0,s.jsx)("a",{href:`/api/engine-redirect?port=${a}`,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:`flex-shrink-0 px-4 py-1.5 text-sm font-medium rounded transition-colors ${g?"bg-green-600 hover:bg-green-500 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:"Online"})]})}function n({tradeline:e,displayName:a,port:l}){var r;let[n,c]=(0,t.useState)(null),[d,o]=(0,t.useState)(!0),[x,m]=(0,t.useState)(null);(0,t.useEffect)(()=>{h(!0)},[e]),(0,t.useEffect)(()=>{let e=setInterval(h,1e4);return()=>clearInterval(e)},[e]);let h=async(s=!1)=>{s&&o(!0),m(null);try{let s=await fetch(`/api/tradelines/status/${e}`),t=await s.json();if(!1!==t.success){let e=t.processes||[],s=e.filter(e=>"online"===e.status).length,a=e.reduce((e,s)=>e+(s.memory||0),0),l=e.length>0?e.reduce((e,s)=>e+(s.cpu||0),0)/e.length:0,r=e.find(e=>e.name?.includes("-main")),n=r?.uptime?Math.floor((Date.now()-r.uptime)/1e3):void 0,i="stopped";s===e.length&&e.length>0?i="online":s>0&&(i="partial"),c({status:i,uptime:n,memory:a,cpu:l,processes:e.map(e=>({name:e.name,status:e.status,cpu:e.cpu||0,memory:e.memory||0}))})}else m(t.error||"Failed to fetch status")}catch(e){m(e.message)}finally{o(!1)}};return d?(0,s.jsxs)("div",{className:"p-4 h-full flex flex-col",children:[(0,s.jsx)("div",{className:"flex items-start justify-between h-14 flex-shrink-0",children:(0,s.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:a}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",l," | ",e]})]})}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:"Loading stats..."})]}):x?(0,s.jsxs)("div",{className:"p-4 h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between h-14 flex-shrink-0 mb-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:a}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",l," | ",e]})]}),(0,s.jsx)("button",{onClick:()=>h(!0),className:"px-3 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors flex-shrink-0",children:"Retry"})]}),(0,s.jsx)("div",{className:"text-xs text-red-400 bg-red-500/10 px-3 py-2 rounded",children:x})]}):(0,s.jsxs)("div",{className:"p-4 space-y-4 h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between h-14 flex-shrink-0",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:a}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",l," | ",e]})]}),(0,s.jsx)("button",{onClick:()=>h(),className:"px-3 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors flex-shrink-0",children:"Refresh"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(i,{label:"Status",value:n?.status||"-",color:n?.status==="online"?"green":n?.status==="stopped"?"red":"gray"}),(0,s.jsx)(i,{label:"Uptime",value:(e=>{if(!e)return"-";let s=Math.floor(e/3600),t=Math.floor(e%3600/60);return`${s}h ${t}m`})(n?.uptime),color:"cyan"}),(0,s.jsx)(i,{label:"Memory",value:(r=n?.memory)?`${Math.round(r/1048576)} MB`:"-",color:"blue"}),(0,s.jsx)(i,{label:"CPU",value:n?.cpu!==void 0?`${n.cpu.toFixed(1)}%`:"-",color:n?.cpu&&n.cpu>80?"red":n?.cpu&&n.cpu>50?"yellow":"green"})]}),n?.processes&&n.processes.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[(0,s.jsx)("h4",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Processes"}),(0,s.jsx)("div",{className:"space-y-1.5",children:n.processes.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-300 font-mono text-xs",children:e.name}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[e.cpu.toFixed(1),"% CPU"]}),(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(e.memory/1048576),"MB"]}),(0,s.jsx)("div",{className:`w-2 h-2 rounded-full ${"online"===e.status?"bg-green-500":"bg-red-500"}`})]})]},e.name))})]}),(n?.opportunities_found!==void 0||n?.documents_scraped!==void 0)&&(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3 space-y-2",children:[void 0!==n.opportunities_found&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Opportunities"}),(0,s.jsx)("span",{className:"text-white",children:n.opportunities_found.toLocaleString()})]}),void 0!==n.documents_scraped&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Documents"}),(0,s.jsx)("span",{className:"text-white",children:n.documents_scraped.toLocaleString()})]}),n.last_run&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Last Run"}),(0,s.jsx)("span",{className:"text-white",children:new Date(n.last_run).toLocaleTimeString()})]}),n.version&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-500",children:"Version"}),(0,s.jsx)("span",{className:"text-white font-mono",children:n.version})]})]})]})}function i({label:e,value:t,color:a}){return(0,s.jsxs)("div",{className:`border rounded-lg p-3 ${{blue:"border-blue-500/30 bg-blue-500/10",green:"border-green-500/30 bg-green-500/10",red:"border-red-500/30 bg-red-500/10",yellow:"border-yellow-500/30 bg-yellow-500/10",cyan:"border-cyan-500/30 bg-cyan-500/10",gray:"border-gray-500/30 bg-gray-500/10"}[a]}`,children:[(0,s.jsx)("div",{className:`text-xl font-bold ${{blue:"text-blue-400",green:"text-green-400",red:"text-red-400",yellow:"text-yellow-400",cyan:"text-cyan-400",gray:"text-gray-400"}[a]}`,children:t}),(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:e})]})}let c={"SAM.gov":"Federal","Cal-e-Procure":"State",PlanetBids:"Local",PublicPurchase:"Municipal",BidNet:"Regional"},d={discovery:"Stage 1",scraping:"Stage 2",analysis:"Stage 3",storage:"Stage 4"};function o({tradeline:e}){let[a,l]=(0,t.useState)(null),[r,n]=(0,t.useState)(!0),[i,o]=(0,t.useState)(null),x=async(s=!1)=>{s&&n(!0);try{let s=await fetch(`/api/tradelines/stats/${e}`),t=await s.json();t.success?(l(t),o(null)):o(t.error||"Failed to fetch stats")}catch(e){o(e.message)}finally{n(!1)}};return((0,t.useEffect)(()=>{x(!0)},[e]),(0,t.useEffect)(()=>{let e=setInterval(()=>x(),3e4);return()=>clearInterval(e)},[e]),r)?(0,s.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm",children:"Loading stats..."}):i||!a?(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Today's Stats"}),(0,s.jsx)("div",{className:"text-gray-600 text-sm",children:"No data available"})]}):(0,s.jsxs)("div",{className:"h-full overflow-y-auto",children:[(0,s.jsx)("div",{className:"bg-black/30 px-4 py-2 border-b border-gray-700 sticky top-0",children:(0,s.jsx)("h3",{className:"text-xs uppercase text-gray-500 font-medium tracking-wide",children:"Today's Stats"})}),(0,s.jsxs)("div",{className:"p-3 space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,s.jsxs)("div",{className:"bg-gray-700/30 rounded p-2",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-cyan-400",children:a.today.opportunities}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase",children:"Ops Today"})]}),(0,s.jsxs)("div",{className:"bg-gray-700/30 rounded p-2",children:[(0,s.jsx)("div",{className:"text-lg font-bold text-blue-400",children:a.today.documents}),(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase",children:"Docs Today"})]})]}),(0,s.jsx)("div",{className:"bg-gray-700/30 rounded p-2",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 uppercase",children:"AI Cost Today"}),(0,s.jsxs)("span",{className:"text-sm font-mono text-green-400",children:["$",a.today.aiCost.toFixed(2)]})]})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"By Source"}),(0,s.jsx)("div",{className:"space-y-1",children:Object.entries(a.today.bySource).map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-400",children:c[e]||e}),(0,s.jsx)("span",{className:"text-white font-mono",children:t})]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"By Stage"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-1",children:Object.entries(a.today.byStage).map(([e,t])=>(0,s.jsxs)("div",{className:"bg-gray-700/50 rounded p-1.5 text-center",children:[(0,s.jsx)("div",{className:"text-sm font-bold text-white",children:t}),(0,s.jsx)("div",{className:"text-[9px] text-gray-500",children:d[e]||e})]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,s.jsx)("span",{className:"text-[10px] text-gray-500 uppercase",children:"Storage"}),(0,s.jsxs)("span",{className:"text-[10px] text-gray-400",children:[a.storage.usedFormatted," / ",a.storage.limitFormatted]})]}),(0,s.jsx)("div",{className:"h-2 bg-gray-700 rounded overflow-hidden",children:(0,s.jsx)("div",{className:`h-full transition-all ${a.storage.percent>90?"bg-red-500":a.storage.percent>75?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(a.storage.percent,100)}%`}})}),(0,s.jsxs)("div",{className:"text-[10px] text-gray-500 mt-0.5 text-right",children:[a.storage.percent,"% used"]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-700 pt-3",children:[(0,s.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"All Time"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Total Ops"}),(0,s.jsx)("span",{className:"text-white font-mono",children:a.totals.opportunities.toLocaleString()})]}),(0,s.jsxs)("div",{className:"flex justify-between text-xs mt-1",children:[(0,s.jsx)("span",{className:"text-gray-400",children:"Total Docs"}),(0,s.jsx)("span",{className:"text-white font-mono",children:a.totals.documents.toLocaleString()})]})]})]})]})}function x({tradeline:e,activeWorker:a}){let[l,r]=(0,t.useState)({main:[],w1:[],w2:[],w3:[],w4:[]}),[n,i]=(0,t.useState)(!0),[c,d]=(0,t.useState)(null),[o,x]=(0,t.useState)(!1),m=(0,t.useRef)(null),h=async()=>{try{let s=await fetch(`/api/tradelines/logs/${e}?lines=50&workers=all`),t=await s.json();if(t.success&&t.workers){let e={main:g(t.workers.main?.logs||""),w1:g(t.workers.w1?.logs||""),w2:g(t.workers.w2?.logs||""),w3:g(t.workers.w3?.logs||""),w4:g(t.workers.w4?.logs||"")};r(e),d(null)}else d(t.error||"Failed to fetch logs")}catch(e){d(e.message)}finally{i(!1)}},g=e=>e?e.replace(/\u001b\[[0-9;]*m/g,"").split("\n").filter(Boolean).map((e,s)=>{let t=e.match(/\[([^\]]+)\]\s*\[(\w+)\]\s*(.+)/);if(t){let e,[,a,l,r]=t,[n,i]=r.split(" | ");if(i)try{let s=JSON.parse(i);e=s.module||s.source}catch{}return{id:`${s}-${a}`,timestamp:a,level:l.toLowerCase(),message:n.trim(),source:e}}return{id:`${s}-${Date.now()}`,timestamp:new Date().toISOString(),level:"info",message:e}}):[];(0,t.useEffect)(()=>{i(!0),r({main:[],w1:[],w2:[],w3:[],w4:[]}),h()},[e]),(0,t.useEffect)(()=>{if(o)return;let e=setInterval(h,5e3);return()=>clearInterval(e)},[e,o]),(0,t.useEffect)(()=>{!o&&m.current&&(m.current.scrollTop=m.current.scrollHeight)},[l,a,o]);let p={info:"bg-blue-500/20 text-blue-400",warn:"bg-yellow-500/20 text-yellow-400",error:"bg-red-500/20 text-red-400",debug:"bg-gray-500/20 text-gray-400"},u=l[a];return(0,s.jsxs)("div",{className:"h-full flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-700 bg-gray-800/50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:`w-2 h-2 rounded-full ${!c?"bg-green-500 animate-pulse":"bg-red-500"}`}),(0,s.jsx)("span",{className:"text-xs text-gray-400",children:c?"Error":"Live (5s)"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>x(!o),className:`px-2 py-1 text-xs rounded transition-colors ${o?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30"}`,children:o?"Resume":"Pause"}),(0,s.jsx)("button",{onClick:h,className:"px-2 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors",children:"Refresh"})]})]}),(0,s.jsx)("div",{ref:m,className:"flex-1 overflow-y-auto p-2 font-mono text-xs space-y-1 bg-gray-900/50",children:n?(0,s.jsx)("div",{className:"text-gray-500 text-center py-8",children:"Loading logs..."}):c?(0,s.jsxs)("div",{className:"text-red-400 text-center py-8",children:["Error: ",c]}):0===u.length?(0,s.jsx)("div",{className:"text-gray-500 text-center py-8",children:"No logs available"}):u.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-2 py-0.5 hover:bg-gray-800/50 px-1 rounded",children:[(0,s.jsx)("span",{className:"text-gray-600 flex-shrink-0",children:(e=>{try{return new Date(e).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return e}})(e.timestamp)}),(0,s.jsx)("span",{className:`px-1.5 py-0.5 rounded text-[10px] uppercase flex-shrink-0 ${p[e.level]||p.info}`,children:e.level}),e.source&&(0,s.jsxs)("span",{className:"text-purple-400 flex-shrink-0",children:["[",e.source,"]"]}),(0,s.jsx)("span",{className:"text-gray-300",children:e.message})]},e.id))})]})}function m({tradeline:e,port:a}){let[l,r]=(0,t.useState)(""),[n,i]=(0,t.useState)([]),[c,d]=(0,t.useState)(-1),[o,x]=(0,t.useState)([]),[m,h]=(0,t.useState)(!1),g=(0,t.useRef)(null),p=(0,t.useRef)(null);(0,t.useEffect)(()=>{i([{command:"",output:`Connected to ${e} (port ${a})
Type 'help' for available commands.
─────────────────────────────────────`,timestamp:new Date}])},[e,a]),(0,t.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[n]);let u=(e,s,t=!1)=>{i(a=>[...a,{command:e,output:s,timestamp:new Date,isError:t}])},f=async s=>{let t=s.trim().toLowerCase(),l=s.trim();if(t){if(x(e=>[...e.filter(e=>e!==t),t].slice(-50)),d(-1),"help"===t)return void u(l,`Available commands:
  status     - Get server status from API
  logs       - Fetch recent logs
  restart    - Restart server (requires --confirm)
  stop       - Stop server (requires --confirm)
  start      - Start server
  clear      - Clear terminal
  health     - Check server health

Raw SSH commands (executed on engine server):
  pm2 list              - List all PM2 processes
  pm2 show <name>       - Show process details
  pm2 restart <name>    - Restart specific process
  pm2 logs <name>       - Stream process logs
  tail -n 50 <file>     - Read last 50 lines of file
  ls, pwd, uptime       - System commands`);if("clear"===t)return void i([]);h(!0);try{if("status"===t){let s=await fetch(`/api/tradelines/status/${e}`),t=await s.json();if(!1!==t.success){let s=t.processes?.map(e=>`  ${e.name}: ${e.status} (CPU: ${e.cpu?.toFixed(1)}%, Mem: ${Math.round((e.memory||0)/1024/1024)}MB)`).join("\n")||"";u(l,`Server Status: ${e}
────────────────────────
Status: ${t.status||"unknown"}
Port: ${a}
${s?`Processes:
${s}`:""}`)}else u(l,t.error||"Failed to get status",!0)}else if("logs"===t){let s=await fetch(`/api/tradelines/logs/${e}?lines=20`),t=await s.json();t.success&&t.logs?u(l,`Recent Logs:
────────────────────────
${t.logs}`):u(l,t.error||"Failed to fetch logs",!0)}else if("health"===t){let s=await fetch(`/api/servers/health?projectId=tradelines&slotId=${e}`),t=await s.json();u(l,`Health Check:
────────────────────────
${JSON.stringify(t,null,2)}`)}else if("restart --confirm"===t){let s=await fetch(`/api/tradelines/restart/${e}`,{method:"POST"}),t=await s.json();t.success?u(l,`✓ Restart command sent to ${e}`):u(l,t.error||"Restart failed",!0)}else if("restart"===t)u(l,`⚠️  This will restart ${e}.
Type 'restart --confirm' to proceed.`);else if("stop --confirm"===t){let s=await fetch(`/api/tradelines/stop/${e}`,{method:"POST"}),t=await s.json();t.success?u(l,`✓ Stop command sent to ${e}`):u(l,t.error||"Stop failed",!0)}else if("stop"===t)u(l,`⚠️  This will stop ${e}.
Type 'stop --confirm' to proceed.`);else if("start"===t){let s=await fetch(`/api/tradelines/start/${e}`,{method:"POST"}),t=await s.json();t.success?u(l,`✓ Start command sent to ${e}`):u(l,t.error||"Start failed",!0)}else{let s=await fetch(`/api/tradelines/exec/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:l})}),t=await s.json();if(t.success){let e=t.stdout||t.stderr||"Command executed (no output)";u(l,e,!!t.stderr&&!t.stdout)}else u(l,t.error||"Command failed",!0)}}catch(e){u(l,`Error: ${e.message}`,!0)}finally{h(!1)}}};return(0,s.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 font-mono text-sm cursor-text",onClick:()=>{g.current?.focus()},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-800 border-b border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,s.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:[e,"@nextbid:~"]})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-600",children:["port ",a]})]}),(0,s.jsxs)("div",{ref:p,className:"flex-1 overflow-y-auto p-3 space-y-2",children:[n.map((e,t)=>(0,s.jsxs)("div",{children:[e.command&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-green-400",children:"$"}),(0,s.jsx)("span",{className:"text-white",children:e.command})]}),(0,s.jsx)("pre",{className:`whitespace-pre-wrap text-xs leading-relaxed ${e.isError?"text-red-400":"text-gray-400"}`,children:e.output})]},t)),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-green-400",children:"$"}),(0,s.jsx)("input",{ref:g,type:"text",value:l,onChange:e=>r(e.target.value),onKeyDown:e=>{if("Enter"!==e.key||m){if("ArrowUp"===e.key){if(e.preventDefault(),o.length>0){let e=c<o.length-1?c+1:c;d(e),r(o[o.length-1-e]||"")}}else if("ArrowDown"===e.key)if(e.preventDefault(),c>0){let e=c-1;d(e),r(o[o.length-1-e]||"")}else d(-1),r("");else if("Tab"===e.key){e.preventDefault();let s=["status","logs","health","restart","stop","start","clear","help","pm2 list","pm2 status","pm2 show","pm2 restart","pm2 logs","pm2 stop","tail","ls","pwd","uptime","df -h","free -h"].filter(e=>e.startsWith(l.toLowerCase()));1===s.length?r(s[0]):s.length>1&&s.length<=5&&u(l,`Completions: ${s.join(", ")}`)}}else f(l),r("")},className:"flex-1 bg-transparent text-white outline-none",placeholder:"",autoFocus:!0,disabled:m}),m?(0,s.jsx)("span",{className:"text-yellow-400 animate-pulse",children:"..."}):(0,s.jsx)("span",{className:"text-gray-600 animate-pulse",children:"|"})]})]})]})}let h=[{id:"main",label:"Engine",offset:0},{id:"w1",label:"Discovery",offset:1},{id:"w2",label:"Scope",offset:2},{id:"w3",label:"Research",offset:3},{id:"w4",label:"Assistant",offset:4}];function g({tradelines:e,healthAll:l,analytics:i,initialError:c}){let d,[g,p]=(0,t.useState)(c),[u,f]=(0,t.useState)(e.length>0?e[0]:null),[y,j]=(0,t.useState)("feed"),[b,v]=(0,t.useState)("main"),N=(0,t.useContext)(a.PageTitleContext),w=(0,t.useContext)(a.PageActionsContext);(0,t.useEffect)(()=>(N({title:"Tradeline Servers",description:"7101 - NextBid Engine Patcher - Manage all 20 tradeline servers"}),w(null),()=>w(null)),[N,w]);let S=e=>l.tradelines?.[e]||{status:"stopped",online:0,total:4,processes:[]},$=u?S(u.name):null,k=u?.ports?.main||0;return(0,s.jsxs)("div",{className:"h-full flex flex-col -mt-4 overflow-hidden",children:[g&&(0,s.jsxs)("div",{className:"flex-shrink-0 bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg mx-4 mb-4",children:[(0,s.jsx)("strong",{children:"Error:"})," ",g]}),(0,s.jsxs)("div",{className:"flex-shrink-0 flex gap-4 mx-4",children:[(0,s.jsxs)("div",{className:"w-3/4 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden h-[280px] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 bg-black/30 px-4 py-2 border-b border-gray-700 flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"text-xs uppercase text-gray-500 font-medium tracking-wide",children:["Tradeline Servers (",e.length,")"]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),e.filter(e=>"healthy"===S(e.name).status).length," Healthy"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),e.filter(e=>"partial"===S(e.name).status).length," Partial"]}),(0,s.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500"}),e.filter(e=>"stopped"===S(e.name).status||!S(e.name).status).length," Stopped"]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-700/50",children:e.map(e=>{let t,a=S(e.name),l=(t=e.name,i?.tradelines?.find(e=>e.name===t)||null);return(0,s.jsx)(r,{name:e.name,displayName:e.displayName,port:e.ports?.main||0,status:a.status||"stopped",online:a.online||0,total:a.total||4,processes:a.processes||[],storageBytes:l?.storageBytes||0,isSelected:u?.name===e.name,onClick:()=>f(e)},e.name)})})]}),(0,s.jsx)("div",{className:"w-1/4 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden h-[280px]",children:u?(0,s.jsx)(n,{tradeline:u.name,displayName:u.displayName,port:k}):(0,s.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm p-4",children:"Select a server"})})]}),u&&(0,s.jsxs)("div",{className:"flex-1 min-h-0 mt-4 mx-4 flex gap-4 overflow-hidden",children:[(0,s.jsx)("div",{className:"w-80 flex-shrink-0 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden",children:(0,s.jsx)(o,{tradeline:u.name})}),(0,s.jsxs)("div",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden flex flex-col",children:[(0,s.jsxs)("div",{className:"flex-shrink-0 flex items-center border-b border-gray-700 bg-black/30",children:[(0,s.jsx)("button",{onClick:()=>j("feed"),className:`px-4 py-2 text-sm font-medium transition-colors ${"feed"===y?"text-white border-b-2 border-blue-500 bg-gray-800/50":"text-gray-400 hover:text-white"}`,children:"Live Feed"}),(0,s.jsx)("div",{className:"w-px h-6 bg-gray-700 mx-1"}),"feed"===y&&(d=$?.slotId||"00",h.map(e=>({id:e.id,label:e.label,suffix:0===e.offset?d:`${e.offset}${d}`}))).map(e=>(0,s.jsxs)("button",{onClick:()=>v(e.id),className:`px-3 py-2 text-xs font-medium transition-colors ${b===e.id?"text-blue-400 bg-blue-500/10":"text-gray-500 hover:text-gray-300"}`,children:[e.label,(0,s.jsx)("span",{className:"ml-1 text-gray-600 text-[10px]",children:e.suffix})]},e.id)),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsx)("button",{onClick:()=>j("terminal"),className:`px-4 py-2 text-sm font-medium transition-colors ${"terminal"===y?"text-white border-b-2 border-blue-500 bg-gray-800/50":"text-gray-400 hover:text-white"}`,children:"Terminal"})]}),(0,s.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:"feed"===y?(0,s.jsx)(x,{tradeline:u.name,activeWorker:b}):(0,s.jsx)(m,{tradeline:u.name,port:k})})]})]}),!u&&(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a server from the list above to view details"})]})}e.s(["default",()=>g],77536)}]);