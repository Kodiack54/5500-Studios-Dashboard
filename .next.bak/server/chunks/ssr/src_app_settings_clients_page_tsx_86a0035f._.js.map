{"version":3,"sources":["../../../../src/app/settings/clients/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState, useContext } from 'react';\r\nimport Link from 'next/link';\r\nimport { PageTitleContext, PageActionsContext } from '@/app/layout';\r\nimport { Building2, User } from 'lucide-react';\r\n\r\ninterface TeamMember {\r\n  id: string;\r\n  name: string | null;\r\n  first_name: string | null;\r\n  last_name: string | null;\r\n  email: string;\r\n  avatar_url: string | null;\r\n  role: string;\r\n}\r\n\r\ninterface Project {\r\n  id: string;\r\n  name: string;\r\n  slug: string;\r\n  logo_url: string | null;\r\n}\r\n\r\ninterface Client {\r\n  id: string;\r\n  name: string;\r\n  slug: string;\r\n  description: string | null;\r\n  client_type: string;\r\n  logo_url: string | null;\r\n  active: boolean;\r\n  created_at: string;\r\n  team: TeamMember[];\r\n  projects: Project[];\r\n}\r\n\r\n// Get initials from name\r\nfunction getInitials(member: TeamMember): string {\r\n  if (member.first_name && member.last_name) {\r\n    return `${member.first_name[0]}${member.last_name[0]}`.toUpperCase();\r\n  }\r\n  if (member.name) {\r\n    const parts = member.name.split(' ');\r\n    if (parts.length >= 2) {\r\n      return `${parts[0][0]}${parts[1][0]}`.toUpperCase();\r\n    }\r\n    return member.name.substring(0, 2).toUpperCase();\r\n  }\r\n  return member.email.substring(0, 2).toUpperCase();\r\n}\r\n\r\n// Get project abbreviation\r\nfunction getProjectAbbr(project: Project): string {\r\n  // Common abbreviations\r\n  const abbrs: Record<string, string> = {\r\n    'nextbid': 'NB',\r\n    'nextbidder': 'NB',\r\n    'nextsource': 'NS',\r\n    'nexttech': 'NT',\r\n    'nexttask': 'NT',\r\n  };\r\n\r\n  const slug = project.slug.toLowerCase();\r\n  if (abbrs[slug]) return abbrs[slug];\r\n\r\n  // Generate from name - take first letters of words\r\n  const words = project.name.split(/[\\s-]+/);\r\n  if (words.length >= 2) {\r\n    return words.slice(0, 2).map(w => w[0]).join('').toUpperCase();\r\n  }\r\n  return project.name.substring(0, 2).toUpperCase();\r\n}\r\n\r\nexport default function ClientsPage() {\r\n  const setPageTitle = useContext(PageTitleContext);\r\n  const setPageActions = useContext(PageActionsContext);\r\n  const [clients, setClients] = useState<Client[]>([]);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Set page title and actions\r\n  useEffect(() => {\r\n    setPageTitle({\r\n      title: 'Clients',\r\n      description: 'Manage clients and their projects'\r\n    });\r\n    setPageActions(\r\n      <Link\r\n        href=\"/settings/clients/new\"\r\n        className=\"px-4 py-2 bg-white/20 text-white rounded-lg text-sm font-semibold hover:bg-white/30 transition-colors border border-white/30\"\r\n      >\r\n        + Add Client\r\n      </Link>\r\n    );\r\n\r\n    return () => {\r\n      setPageTitle({ title: '', description: '' });\r\n      setPageActions(null);\r\n    };\r\n  }, [setPageTitle, setPageActions]);\r\n\r\n  // Load clients\r\n  useEffect(() => {\r\n    async function loadClients() {\r\n      try {\r\n        const res = await fetch('/api/clients');\r\n        if (!res.ok) throw new Error('Failed to load clients');\r\n        const data = await res.json();\r\n        setClients(data);\r\n      } catch (e) {\r\n        setError((e as Error).message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    loadClients();\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center py-12\">\r\n        <div className=\"text-gray-400\">Loading clients...</div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {/* Error Alert */}\r\n      {error && (\r\n        <div className=\"bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg mb-6\">\r\n          <strong>Error:</strong> {error}\r\n        </div>\r\n      )}\r\n\r\n      {/* Clients Grid */}\r\n      {clients.length === 0 ? (\r\n        <div className=\"bg-gray-800 border border-gray-700 rounded-xl p-12 text-center\">\r\n          <Building2 className=\"w-12 h-12 text-gray-500 mx-auto mb-4\" />\r\n          <p className=\"text-gray-400 mb-4\">No clients yet</p>\r\n          <Link\r\n            href=\"/settings/clients/new\"\r\n            className=\"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\r\n          >\r\n            Add Your First Client\r\n          </Link>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid gap-4\">\r\n          {clients.map((client) => (\r\n            <Link\r\n              key={client.id}\r\n              href={`/settings/clients/${client.id}`}\r\n              className=\"block bg-gray-800 border border-gray-700 rounded-xl p-6 hover:border-blue-500 transition-colors\"\r\n            >\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex items-start gap-4\">\r\n                  {/* Client Logo or Icon */}\r\n                  {client.logo_url ? (\r\n                    <img\r\n                      src={client.logo_url}\r\n                      alt={client.name}\r\n                      className=\"w-12 h-12 rounded-xl object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className={`w-12 h-12 rounded-xl flex items-center justify-center ${\r\n                      client.client_type === 'individual'\r\n                        ? 'bg-purple-600/20'\r\n                        : 'bg-blue-600/20'\r\n                    }`}>\r\n                      {client.client_type === 'individual' ? (\r\n                        <User className=\"w-6 h-6 text-purple-400\" />\r\n                      ) : (\r\n                        <Building2 className=\"w-6 h-6 text-blue-400\" />\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                  <div>\r\n                    <h3 className=\"text-lg font-semibold text-white hover:text-blue-400 transition-colors\">\r\n                      {client.name}\r\n                    </h3>\r\n                    {client.description && (\r\n                      <p className=\"text-gray-500 text-sm mt-0.5\">{client.description}</p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n                <span className={`px-2 py-1 rounded text-xs font-medium ${\r\n                  client.active\r\n                    ? 'bg-green-500/20 text-green-400'\r\n                    : 'bg-gray-500/20 text-gray-400'\r\n                }`}>\r\n                  {client.active ? 'Active' : 'Inactive'}\r\n                </span>\r\n              </div>\r\n\r\n              {/* Team & Projects Row */}\r\n              <div className=\"mt-4 pt-4 border-t border-gray-700 flex items-center justify-between\">\r\n                {/* Team Members */}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-gray-500 text-xs uppercase font-medium mr-1\">Team:</span>\r\n                  {client.team.length === 0 ? (\r\n                    <span className=\"text-gray-600 text-sm\">No team assigned</span>\r\n                  ) : (\r\n                    <div className=\"flex -space-x-2\">\r\n                      {client.team.slice(0, 5).map((member) => (\r\n                        <div\r\n                          key={member.id}\r\n                          className=\"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white text-xs font-bold border-2 border-gray-800\"\r\n                          title={member.first_name ? `${member.first_name} ${member.last_name || ''}` : member.email}\r\n                        >\r\n                          {member.avatar_url ? (\r\n                            <img src={member.avatar_url} alt=\"\" className=\"w-full h-full rounded-lg object-cover\" />\r\n                          ) : (\r\n                            getInitials(member)\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                      {client.team.length > 5 && (\r\n                        <div className=\"w-8 h-8 rounded-lg bg-gray-700 flex items-center justify-center text-gray-400 text-xs font-bold border-2 border-gray-800\">\r\n                          +{client.team.length - 5}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n\r\n                {/* Projects */}\r\n                <div className=\"flex items-center gap-2\">\r\n                  <span className=\"text-gray-500 text-xs uppercase font-medium mr-1\">Projects:</span>\r\n                  {client.projects.length === 0 ? (\r\n                    <span className=\"text-gray-600 text-sm\">No projects</span>\r\n                  ) : (\r\n                    <div className=\"flex gap-1\">\r\n                      {client.projects.slice(0, 6).map((project) => (\r\n                        <div\r\n                          key={project.id}\r\n                          className=\"w-8 h-8 rounded-lg bg-gray-700 flex items-center justify-center text-gray-300 text-xs font-bold\"\r\n                          title={project.name}\r\n                        >\r\n                          {project.logo_url ? (\r\n                            <img src={project.logo_url} alt=\"\" className=\"w-full h-full rounded-lg object-cover\" />\r\n                          ) : (\r\n                            getProjectAbbr(project)\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                      {client.projects.length > 6 && (\r\n                        <div className=\"w-8 h-8 rounded-lg bg-gray-600 flex items-center justify-center text-gray-400 text-xs font-bold\">\r\n                          +{client.projects.length - 6}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}