{"version":3,"sources":["../../../../../../Studio/kodiack-dashboard-5500/node_modules/lucide-react/src/icons/refresh-cw.ts","../../../../../../Studio/kodiack-dashboard-5500/src/app/dev-controls/api.ts","../../../../../../Studio/kodiack-dashboard-5500/src/app/dev-controls/git/page.tsx"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8', key: 'v9h5vc' }],\n  ['path', { d: 'M21 3v5h-5', key: '1q7to0' }],\n  ['path', { d: 'M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16', key: '3uifl3' }],\n  ['path', { d: 'M8 16H3v5', key: '1cv678' }],\n];\n\n/**\n * @component @name RefreshCw\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAxMmE5IDkgMCAwIDEgOS05IDkuNzUgOS43NSAwIDAgMSA2Ljc0IDIuNzRMMjEgOCIgLz4KICA8cGF0aCBkPSJNMjEgM3Y1aC01IiAvPgogIDxwYXRoIGQ9Ik0yMSAxMmE5IDkgMCAwIDEtOSA5IDkuNzUgOS43NSAwIDAgMS02Ljc0LTIuNzRMMyAxNiIgLz4KICA8cGF0aCBkPSJNOCAxNkgzdjUiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/refresh-cw\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst RefreshCw = createLucideIcon('refresh-cw', __iconNode);\n\nexport default RefreshCw;\n","// Dev Controls API - Connects to real Patcher services\r\n// Port 7100: Deployment Orchestrator (routes to sub-patchers)\r\n// Port 7101: Tradeline Patcher (engine-specific operations)\r\n\r\n// Base URLs for patcher services\r\n// In production, dashboard and patcher are on the same droplet (134.199.209.140)\r\n// Dashboard calls patcher via localhost\r\nconst ORCHESTRATOR_URL = process.env.NEXT_PUBLIC_ORCHESTRATOR_URL || 'http://localhost:7100';\r\nconst TRADELINE_PATCHER_URL = process.env.NEXT_PUBLIC_TRADELINE_PATCHER_URL || 'http://localhost:7101';\r\n\r\n// Generic API request helper\r\nasync function apiRequest<T>(baseUrl: string, endpoint: string, options: RequestInit = {}): Promise<T> {\r\n  const url = `${baseUrl}${endpoint}`;\r\n  const res = await fetch(url, {\r\n    ...options,\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      ...options.headers,\r\n    },\r\n    cache: 'no-store',\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const error = await res.json().catch(() => ({ error: res.statusText }));\r\n    throw new Error(error.error || error.message || `API Error: ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\n// ============================================\r\n// 7100 - Deployment Orchestrator\r\n// ============================================\r\n\r\nexport async function getOrchestratorHealth() {\r\n  return apiRequest(ORCHESTRATOR_URL, '/health');\r\n}\r\n\r\nexport async function getServices() {\r\n  return apiRequest<{\r\n    orchestrator: { status: string; port: number };\r\n    services: Record<string, { url: string; status: string; details?: any; error?: string }>;\r\n  }>(ORCHESTRATOR_URL, '/services');\r\n}\r\n\r\nexport async function getDeployJobs(limit = 20) {\r\n  return apiRequest<{\r\n    count: number;\r\n    total: number;\r\n    jobs: Array<{\r\n      id: string;\r\n      type: string;\r\n      target: string;\r\n      status: string;\r\n      createdAt: string;\r\n      completedAt?: string;\r\n      result?: any;\r\n      error?: string;\r\n    }>;\r\n  }>(ORCHESTRATOR_URL, `/deploy/jobs?limit=${limit}`);\r\n}\r\n\r\nexport async function getDeployStatus(jobId: string) {\r\n  return apiRequest(ORCHESTRATOR_URL, `/deploy/status/${jobId}`);\r\n}\r\n\r\nexport async function deployTradeline(name: string, branch = 'main') {\r\n  return apiRequest(ORCHESTRATOR_URL, `/deploy/tradeline/${name}`, {\r\n    method: 'POST',\r\n    body: JSON.stringify({ branch }),\r\n  });\r\n}\r\n\r\nexport async function deployAllTradelines(branch = 'main') {\r\n  return apiRequest(ORCHESTRATOR_URL, '/deploy/tradeline/all', {\r\n    method: 'POST',\r\n    body: JSON.stringify({ branch }),\r\n  });\r\n}\r\n\r\nexport async function deployPortal(branch = 'main') {\r\n  return apiRequest(ORCHESTRATOR_URL, '/deploy/portal', {\r\n    method: 'POST',\r\n    body: JSON.stringify({ branch }),\r\n  });\r\n}\r\n\r\nexport async function deploySources(branch = 'main') {\r\n  return apiRequest(ORCHESTRATOR_URL, '/deploy/sources', {\r\n    method: 'POST',\r\n    body: JSON.stringify({ branch }),\r\n  });\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Registry & Identity\r\n// ============================================\r\n\r\nexport async function getTradelinePatcherHealth() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/health');\r\n}\r\n\r\nexport async function getTradelines() {\r\n  return apiRequest<Array<{\r\n    name: string;\r\n    displayName: string;\r\n    naics: string[];\r\n    keywords: string[];\r\n  }>>(TRADELINE_PATCHER_URL, '/tradelines');\r\n}\r\n\r\nexport async function getRegistryStats() {\r\n  return apiRequest<{\r\n    totalServers: number;\r\n    droplets: number;\r\n    tradelines: number;\r\n  }>(TRADELINE_PATCHER_URL, '/registry/stats');\r\n}\r\n\r\nexport async function getRegistryDroplets() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/registry/droplets');\r\n}\r\n\r\nexport async function getDropletServers(ip: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/registry/droplet/${ip}`);\r\n}\r\n\r\nexport async function getTradelineServers(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/registry/tradeline/${tradeline}`);\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Credentials\r\n// ============================================\r\n\r\nexport async function getCredentialsSummary() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/credentials/summary');\r\n}\r\n\r\nexport async function getCredentialsAlerts() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/credentials/alerts');\r\n}\r\n\r\nexport async function getTradelineCredentials(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/credentials/${tradeline}`);\r\n}\r\n\r\nexport async function updateTradelineCredentials(tradeline: string, credentials: Record<string, any>) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/credentials/${tradeline}`, {\r\n    method: 'PUT',\r\n    body: JSON.stringify(credentials),\r\n  });\r\n}\r\n\r\nexport async function updateSourceLoginStatus(tradeline: string, source: string, status: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/credentials/${tradeline}/source/${source}/status`, {\r\n    method: 'POST',\r\n    body: JSON.stringify({ status }),\r\n  });\r\n}\r\n\r\nexport async function updateApiBalance(tradeline: string, api: string, balance: number) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/credentials/${tradeline}/api/${api}/balance`, {\r\n    method: 'POST',\r\n    body: JSON.stringify({ balance }),\r\n  });\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Configuration\r\n// ============================================\r\n\r\nexport async function getTradelineConfig(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/config/${tradeline}`);\r\n}\r\n\r\nexport async function updateTradelineConfig(tradeline: string, config: Record<string, any>) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/config/${tradeline}`, {\r\n    method: 'POST',\r\n    body: JSON.stringify(config),\r\n  });\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Deploy & Status\r\n// ============================================\r\n\r\nexport async function patchTradeline(tradeline: string, options?: { branch?: string }) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/patch/${tradeline}`, {\r\n    method: 'POST',\r\n    body: JSON.stringify(options || {}),\r\n  });\r\n}\r\n\r\nexport async function patchAllTradelines(options?: { branch?: string }) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/patch/all', {\r\n    method: 'POST',\r\n    body: JSON.stringify(options || {}),\r\n  });\r\n}\r\n\r\nexport async function getAllStatus() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/status');\r\n}\r\n\r\nexport async function getTradelineStatus(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/status/${tradeline}`);\r\n}\r\n\r\nexport async function getDeployHistory() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/history');\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Server Control (PM2)\r\n// ============================================\r\n\r\nexport async function startTradeline(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/server/start/${tradeline}`, {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function stopTradeline(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/server/stop/${tradeline}`, {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function restartTradeline(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/server/restart/${tradeline}`, {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function getTradelinePM2Status(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/server/status/${tradeline}`);\r\n}\r\n\r\nexport async function getTradelineLogs(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/server/logs/${tradeline}`);\r\n}\r\n\r\nexport async function launchAllTradelines() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/server/launch-all', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function getHealthAll() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/server/health-all');\r\n}\r\n\r\nexport async function stopAllTradelines() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/server/stop-all', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function restartAllTradelines() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/server/restart-all', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\n// ============================================\r\n// 7101 - Tradeline Patcher: Dev Sync\r\n// ============================================\r\n\r\nexport async function getDevStatus() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/status');\r\n}\r\n\r\nexport async function gitPullDev() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/pull', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function compareDevProd() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/compare', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function getDevDiff() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/diff');\r\n}\r\n\r\nexport async function pushDevToProd() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/push', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function pushDevToTradeline(tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/dev/push/${tradeline}`, {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function pushDevToAllTradelines() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/push-all', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function fullSyncDeploy() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/dev/sync-deploy', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\n// ============================================\r\n// Legacy functions for backwards compatibility\r\n// (Mapped to new endpoints)\r\n// ============================================\r\n\r\nexport async function getDeployments(params?: {\r\n  project?: string;\r\n  status?: string;\r\n  limit?: number;\r\n}) {\r\n  // Maps to /deploy/jobs on orchestrator\r\n  return getDeployJobs(params?.limit || 20);\r\n}\r\n\r\nexport async function getDeployment(deploymentId: string) {\r\n  return getDeployStatus(deploymentId);\r\n}\r\n\r\nexport async function deploy(config: {\r\n  project: string;\r\n  environment: 'development' | 'staging' | 'production';\r\n  branch?: string;\r\n  commit?: string;\r\n  notes?: string;\r\n}) {\r\n  // Route to appropriate patcher based on project\r\n  if (config.project === 'tradelines' || config.project.startsWith('tradeline-')) {\r\n    const tradeline = config.project.replace('tradeline-', '');\r\n    return tradeline === 'all'\r\n      ? deployAllTradelines(config.branch)\r\n      : deployTradeline(tradeline, config.branch);\r\n  }\r\n  if (config.project === 'portal') {\r\n    return deployPortal(config.branch);\r\n  }\r\n  if (config.project === 'sources') {\r\n    return deploySources(config.branch);\r\n  }\r\n  throw new Error(`Unknown project: ${config.project}`);\r\n}\r\n\r\nexport async function getServers() {\r\n  return getHealthAll();\r\n}\r\n\r\nexport async function getServerStatus(serverId: string) {\r\n  return getTradelinePM2Status(serverId);\r\n}\r\n\r\nexport async function restartServer(serverId: string) {\r\n  return restartTradeline(serverId);\r\n}\r\n\r\nexport async function stopServer(serverId: string) {\r\n  return stopTradeline(serverId);\r\n}\r\n\r\nexport async function startServer(serverId: string) {\r\n  return startTradeline(serverId);\r\n}\r\n\r\nexport async function getServerLogs(serverId: string, _params?: {\r\n  lines?: number;\r\n  since?: string;\r\n}) {\r\n  return getTradelineLogs(serverId);\r\n}\r\n\r\n// Git operations - mapped to dev sync\r\nexport async function getRepositories() {\r\n  // Return mock data since Git is handled via dev-sync\r\n  return {\r\n    repositories: [\r\n      { id: 'tradelines', name: 'NextBid Engine Patcher', branch: 'main' },\r\n      { id: 'portal', name: 'NextBid Portal Patcher', branch: 'main' },\r\n      { id: 'sources', name: 'Sources Patcher', branch: 'main' },\r\n      { id: 'dashboard', name: 'NextBid Dashboard', branch: 'main' },\r\n    ]\r\n  };\r\n}\r\n\r\nexport async function gitPull(_repoId: string, _branch?: string) {\r\n  return gitPullDev();\r\n}\r\n\r\nexport async function gitPush(_repoId: string, _branch?: string) {\r\n  return pushDevToProd();\r\n}\r\n\r\n// ============================================\r\n// Release Train - Slot Management\r\n// ============================================\r\n\r\nexport async function getSlots() {\r\n  return apiRequest<Array<{\r\n    slotId: string;\r\n    mainPort: number;\r\n    workerPorts: { fetch: number; parse: number; ai: number; store: number };\r\n    tradeline: string | null;\r\n    isActive: boolean;\r\n    status: 'online' | 'offline' | 'starting' | 'stopping' | 'errored';\r\n    lastHealthCheck?: string;\r\n  }>>(TRADELINE_PATCHER_URL, '/slots');\r\n}\r\n\r\nexport async function getSlot(slotId: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/slots/${slotId}`);\r\n}\r\n\r\nexport async function getActiveSlots() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/slots/filter/active');\r\n}\r\n\r\nexport async function getAvailableSlots() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/slots/filter/available');\r\n}\r\n\r\nexport async function activateSlot(slotId: string, tradeline: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/slots/${slotId}/activate`, {\r\n    method: 'POST',\r\n    body: JSON.stringify({ tradeline }),\r\n  });\r\n}\r\n\r\nexport async function deactivateSlot(slotId: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/slots/${slotId}/deactivate`, {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\nexport async function getSlotHealth(slotId: string) {\r\n  return apiRequest(TRADELINE_PATCHER_URL, `/slots/${slotId}/health`);\r\n}\r\n\r\nexport async function refreshSlots() {\r\n  return apiRequest(TRADELINE_PATCHER_URL, '/slots/refresh', {\r\n    method: 'POST',\r\n  });\r\n}\r\n\r\n// ============================================\r\n// Release Train - Canary Deployment\r\n// ============================================\r\n\r\nexport interface CanaryConfig {\r\n  tradeline: string;\r\n  targetSlots: string[];  // Slot IDs to deploy to\r\n  branch?: string;\r\n}\r\n\r\nexport async function deployCanary(config: CanaryConfig) {\r\n  // Deploy to specific slots only (canary)\r\n  const results = [];\r\n  for (const slotId of config.targetSlots) {\r\n    try {\r\n      const result = await apiRequest(TRADELINE_PATCHER_URL, `/dev/push/${config.tradeline}`, {\r\n        method: 'POST',\r\n        body: JSON.stringify({ slotId, branch: config.branch }),\r\n      });\r\n      results.push({ slotId, success: true, result });\r\n    } catch (error) {\r\n      results.push({ slotId, success: false, error: (error as Error).message });\r\n    }\r\n  }\r\n  return { results, successCount: results.filter(r => r.success).length };\r\n}\r\n\r\nexport async function expandCanary(tradeline: string, additionalSlots: string[]) {\r\n  // Expand canary to more slots\r\n  return deployCanary({ tradeline, targetSlots: additionalSlots });\r\n}\r\n\r\nexport async function completeCanary(tradeline: string) {\r\n  // Deploy to all remaining slots\r\n  return pushDevToAllTradelines();\r\n}\r\n\r\n// ============================================\r\n// Release Train - Version Info\r\n// ============================================\r\n\r\nexport interface VersionInfo {\r\n  commit: string;\r\n  branch: string;\r\n  message: string;\r\n  author: string;\r\n  date: string;\r\n}\r\n\r\nexport async function getDevVersionInfo(): Promise<{ dev: VersionInfo; prod: VersionInfo; ahead: number; behind: number }> {\r\n  const status = await getDevStatus() as any;\r\n  return {\r\n    dev: {\r\n      commit: status.devCommit || 'unknown',\r\n      branch: status.devBranch || 'main',\r\n      message: status.devMessage || '',\r\n      author: status.devAuthor || '',\r\n      date: status.devDate || '',\r\n    },\r\n    prod: {\r\n      commit: status.prodCommit || 'unknown',\r\n      branch: status.prodBranch || 'main',\r\n      message: status.prodMessage || '',\r\n      author: status.prodAuthor || '',\r\n      date: status.prodDate || '',\r\n    },\r\n    ahead: status.ahead || 0,\r\n    behind: status.behind || 0,\r\n  };\r\n}\r\n\r\nexport async function getChangelog(): Promise<{ commits: Array<{ hash: string; message: string; author: string; date: string }> }> {\r\n  const diff = await getDevDiff() as any;\r\n  return {\r\n    commits: diff.commits || [],\r\n  };\r\n}\r\n\r\n// ============================================\r\n// Analytics - Supabase Queries\r\n// ============================================\r\n\r\nexport interface EngineAnalyticsData {\r\n  opportunities: {\r\n    week: number;\r\n    month: number;\r\n    year: number;\r\n    allTime: number;\r\n  };\r\n  documents: {\r\n    week: number;\r\n    month: number;\r\n    year: number;\r\n    allTime: number;\r\n  };\r\n  bySource: {\r\n    week: Record<string, number>;\r\n    month: Record<string, number>;\r\n    year: Record<string, number>;\r\n    allTime: Record<string, number>;\r\n  };\r\n  aiCosts: {\r\n    week: number;\r\n    month: number;\r\n    year: number;\r\n    allTime: number;\r\n  };\r\n  storage: {\r\n    used: {\r\n      bytes: number;\r\n      formatted: string;\r\n    };\r\n    limit: {\r\n      bytes: number;\r\n      formatted: string;\r\n    };\r\n    percentage: number;\r\n  };\r\n  tradelines: Array<{\r\n    name: string;\r\n    table: string;\r\n    documents: number;\r\n    storage: string;\r\n    storageBytes: number;\r\n    opportunities: number;\r\n    status: 'online' | 'offline';\r\n  }>;\r\n  tradelineCount: {\r\n    active: number;\r\n    total: number;\r\n  };\r\n  lastUpdated: string;\r\n}\r\n\r\nexport async function getEngineAnalytics(): Promise<{ success: boolean; data?: EngineAnalyticsData; error?: string }> {\r\n  try {\r\n    const res = await fetch('/api/dev-controls/analytics/engine', {\r\n      cache: 'no-store',\r\n    });\r\n    return res.json();\r\n  } catch (error) {\r\n    return { success: false, error: (error as Error).message };\r\n  }\r\n}\r\n\r\n// ============================================\r\n// Dev Environment (7501) - Deployment\r\n// ============================================\r\n\r\nexport async function getDevEnvironmentStatus() {\r\n  try {\r\n    const res = await fetch('/api/deploy/dev-environment', {\r\n      cache: 'no-store',\r\n    });\r\n    return res.json();\r\n  } catch (error) {\r\n    return { success: false, error: (error as Error).message };\r\n  }\r\n}\r\n\r\nexport async function deployDevEnvironment() {\r\n  try {\r\n    const res = await fetch('/api/deploy/dev-environment', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ action: 'deploy' }),\r\n    });\r\n    return res.json();\r\n  } catch (error) {\r\n    return { success: false, error: (error as Error).message };\r\n  }\r\n}\r\n\r\nexport async function restartDevEnvironment() {\r\n  try {\r\n    const res = await fetch('/api/deploy/dev-environment', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ action: 'restart' }),\r\n    });\r\n    return res.json();\r\n  } catch (error) {\r\n    return { success: false, error: (error as Error).message };\r\n  }\r\n}\r\n\r\nexport async function getDevEnvironmentLogs() {\r\n  try {\r\n    const res = await fetch('/api/deploy/dev-environment', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify({ action: 'logs' }),\r\n    });\r\n    return res.json();\r\n  } catch (error) {\r\n    return { success: false, error: (error as Error).message };\r\n  }\r\n}\r\n","'use client';\r\n\r\nimport { useState, useEffect, useContext } from 'react';\r\nimport Link from 'next/link';\r\nimport { RefreshCw } from 'lucide-react';\r\nimport { RoleGate, PermissionButton } from '@/app/settings/RoleGate';\r\nimport { gitPullDev, pushDevToProd } from '../api';\r\nimport { PageTitleContext, PageActionsContext } from '@/app/layout';\r\n\r\nexport default function GitPage() {\r\n  const [loading, setLoading] = useState<string | null>(null);\r\n  const setPageTitle = useContext(PageTitleContext);\r\n  const setPageActions = useContext(PageActionsContext);\r\n\r\n  useEffect(() => {\r\n    setPageTitle({\r\n      title: 'Git Repositories',\r\n      description: 'Manage code repositories and branches'\r\n    });\r\n\r\n    setPageActions(\r\n      <button className=\"flex items-center gap-1.5 px-3 py-1 bg-white/10 hover:bg-white/20 border border-black/30 rounded-lg text-white text-sm transition-colors\">\r\n        <RefreshCw className=\"w-3.5 h-3.5\" />\r\n        Fetch All\r\n      </button>\r\n    );\r\n\r\n    return () => {\r\n      setPageActions(null);\r\n    };\r\n  }, [setPageTitle, setPageActions]);\r\n\r\n  const repositories = [\r\n    { id: 'tradelines', name: 'NextBid Engine Patcher', branch: 'main', lastCommit: '2 hours ago' },\r\n    { id: 'sources', name: 'NextSource Patcher', branch: 'main', lastCommit: '1 day ago' },\r\n    { id: 'nextbidder', name: 'NextBidder Patcher', branch: 'develop', lastCommit: '3 hours ago' },\r\n    { id: 'portals', name: 'NextBid Portal Patcher', branch: 'main', lastCommit: '5 hours ago' },\r\n    { id: 'nexttech', name: 'NextTech Patcher', branch: 'main', lastCommit: '1 week ago' },\r\n    { id: 'nexttask', name: 'NextTask Patcher', branch: 'main', lastCommit: '2 days ago' },\r\n    { id: 'dashboard', name: 'NextBid Dashboard', branch: 'main', lastCommit: 'just now' },\r\n  ];\r\n\r\n  const handlePull = async (repoId: string) => {\r\n    setLoading(`pull-${repoId}`);\r\n    try {\r\n      const result = await gitPullDev();\r\n      alert('Pull successful');\r\n    } catch (e) {\r\n      alert((e as Error).message);\r\n    } finally {\r\n      setLoading(null);\r\n    }\r\n  };\r\n\r\n  const handlePush = async (repoId: string) => {\r\n    if (!confirm('Push changes to production repository?')) return;\r\n    setLoading(`push-${repoId}`);\r\n    try {\r\n      const result = await pushDevToProd();\r\n      alert('Push successful');\r\n    } catch (e) {\r\n      alert((e as Error).message);\r\n    } finally {\r\n      setLoading(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n\r\n      {/* Repositories */}\r\n      <div className=\"space-y-3\">\r\n        {repositories.map((repo) => (\r\n          <div\r\n            key={repo.id}\r\n            className=\"bg-gray-800 border border-gray-700 rounded-xl p-4 hover:bg-purple-500/5 hover:border-purple-500/30 transition-colors\"\r\n          >\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <div className=\"font-medium text-white mb-1\">{repo.name}</div>\r\n                <div className=\"flex items-center gap-3 text-xs text-gray-500\">\r\n                  <span className=\"flex items-center gap-1\">\r\n                    <span className=\"text-purple-400\">âŽ‡</span>\r\n                    {repo.branch}\r\n                  </span>\r\n                  <span>Last commit: {repo.lastCommit}</span>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex gap-2\">\r\n                <RoleGate permission=\"canPushToTest\">\r\n                  <button\r\n                    onClick={() => handlePull(repo.id)}\r\n                    disabled={loading === `pull-${repo.id}`}\r\n                    className=\"px-3 py-1.5 text-xs font-semibold rounded bg-blue-500/15 text-blue-400 border border-blue-500/30 hover:bg-blue-500 hover:text-white transition-colors disabled:opacity-50\"\r\n                  >\r\n                    {loading === `pull-${repo.id}` ? 'Pulling...' : 'Pull'}\r\n                  </button>\r\n                </RoleGate>\r\n                <RoleGate permission=\"canPushToProd\">\r\n                  <button\r\n                    onClick={() => handlePush(repo.id)}\r\n                    disabled={loading === `push-${repo.id}`}\r\n                    className=\"px-3 py-1.5 text-xs font-semibold rounded bg-green-500/15 text-green-400 border border-green-500/30 hover:bg-green-500 hover:text-white transition-colors disabled:opacity-50\"\r\n                  >\r\n                    {loading === `push-${repo.id}` ? 'Pushing...' : 'Push'}\r\n                  </button>\r\n                </RoleGate>\r\n                <button className=\"px-3 py-1.5 text-xs font-semibold rounded bg-gray-700 text-gray-300 hover:bg-gray-600 transition-colors\">\r\n                  View\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","ignoreList":[0]}