module.exports=[66973,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(45408),e=a.i(30836),f=a.i(94580),g=a.i(81338);let h=(0,g.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var i=a.i(77236),j=a.i(20912),k=a.i(60175),l=a.i(89608),m=a.i(64143),n=a.i(96089),o=a.i(13802),p=a.i(49313),q=a.i(16707),r=a.i(38270),s=a.i(59786),t=a.i(62301);let u=(0,g.default)("shield-off",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]),v=(0,g.default)("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var w=a.i(30587),x=a.i(21605),y=a.i(51679);let z={"no-permission":{title:"This Area Is for Authorized Users Only",message:"You don't have the required permissions to access this page. Contact your administrator if you believe this is an error.",icon:"shield"},"no-project":{title:"Looks Like You Don't Have Access Yet",message:"This project hasn't been assigned to you. Ask your team lead to add you to this project.",icon:"lock"},"not-assigned":{title:"Oops! Access Is Limited Here",message:"You're not assigned to any projects yet. Your administrator needs to assign you to projects before you can access this area.",icon:"user"},pending:{title:"You're Almost There â€” Access Required",message:"Your account is pending approval. Once approved, you'll be able to access this area.",icon:"clock"},custom:{title:"This Page Isn't Available Right Now",message:"Something went wrong or you may not have access to this content.",icon:"alert"}},A={lock:t.Lock,shield:u,user:v,clock:w.Clock,alert:x.AlertCircle};function B({variant:a="no-permission",title:c,message:d,showBackButton:e=!0,showContactAdmin:f=!0,icon:g}){let h=z[a],i=c||h.title,j=d||h.message,k=A[g||h.icon];return(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsxs)("div",{className:"text-center max-w-md mx-auto px-6",children:[(0,b.jsx)("div",{className:"mb-6 flex justify-center",children:(0,b.jsx)("div",{className:"w-20 h-20 rounded-full bg-gray-800 border border-gray-700 flex items-center justify-center",children:(0,b.jsx)(k,{className:"w-10 h-10 text-gray-500"})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-white mb-3",children:i}),(0,b.jsx)("p",{className:"text-gray-400 mb-8 leading-relaxed",children:j}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-3",children:[e&&(0,b.jsx)("button",{onClick:()=>window.history.back(),className:"px-6 py-2.5 bg-gray-800 hover:bg-gray-700 border border-gray-700 rounded-lg text-white font-medium transition-colors",children:"Go Back"}),f&&(0,b.jsx)(y.default,{href:"/helpdesk/system-tickets/new",className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-500 rounded-lg text-white font-medium transition-colors",children:"Request Access"})]}),(0,b.jsx)("p",{className:"mt-8 text-xs text-gray-600",children:"Error code: ACCESS_DENIED"})]})})}var C=a.i(34734),D=a.i(3159);let E=[{id:"tradelines",name:"NextBid Engine"},{id:"sources",name:"NextSource"},{id:"nextbidder",name:"NextBidder"},{id:"portals",name:"NextBid Portal"},{id:"nexttech",name:"NextTech"},{id:"nexttask",name:"NextTask"},{id:"dashboard",name:"Dashboard"}];function F({locks:a,onLock:d,onUnlock:e,onRefresh:f}){let{user:g}=(0,s.useUser)(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l=a.filter(a=>a.isActive),m=async a=>{if(confirm("Are you sure you want to release this lock?")){k(a);try{await e(a),f()}finally{k(null)}}};return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Dev Locks"}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:"Lock repos to prevent pulls during active development"})]}),(0,b.jsx)(D.RoleGate,{permission:"canPushToTest",children:(0,b.jsx)("button",{onClick:()=>i(!0),className:"px-3 py-1.5 bg-yellow-500/15 text-yellow-400 border border-yellow-500/30 rounded-lg text-sm font-semibold hover:bg-yellow-500 hover:text-white transition-colors",children:"+ Create Lock"})})]}),(0,b.jsx)("div",{className:"p-4",children:0===l.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ”“"}),(0,b.jsx)("div",{children:"No active locks"}),(0,b.jsx)("div",{className:"text-sm mt-1",children:"All projects are open for deployment"})]}):(0,b.jsx)("div",{className:"space-y-3",children:l.map(a=>{let c,d,e;return(0,b.jsx)("div",{className:"bg-gray-900 border border-yellow-500/30 rounded-lg p-4",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-yellow-400",children:"ðŸ”’"}),(0,b.jsx)("span",{className:"font-medium text-white",children:a.projectName}),(0,b.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:a.branch})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-400 mt-1",children:["Locked by ",(0,b.jsx)("span",{className:"text-white",children:a.lockedBy})," ",(c=new Date(a.lockedAt),e=Math.floor((d=Math.floor((new Date().getTime()-c.getTime())/6e4))/60),d<60?`${d}m ago`:e<24?`${e}h ago`:c.toLocaleDateString())]}),(0,b.jsxs)("div",{className:"text-sm text-yellow-400/80 mt-2",children:['"',a.reason,'"']}),a.expiresAt&&(0,b.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["Auto-expires: ",new Date(a.expiresAt).toLocaleString()]})]}),(g?.id===a.lockedById||g?.role==="admin"||g?.role==="lead")&&(0,b.jsx)("button",{onClick:()=>m(a.id),disabled:j===a.id,className:"px-3 py-1.5 bg-gray-700 text-gray-300 rounded-lg text-xs font-semibold hover:bg-gray-600 transition-colors disabled:opacity-50",children:j===a.id?"Releasing...":"Release"})]})},a.id)})})}),h&&(0,b.jsx)(G,{onClose:()=>i(!1),onSubmit:async a=>{await d(a),i(!1),f()}})]})}function G({onClose:a,onSubmit:d}){let{user:e}=(0,s.useUser)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)({project:"",branch:"main",reason:"",duration:"4h"}),j=async()=>{if(!h.project)return void alert("Please select a project");if(!h.reason.trim())return void alert("Please provide a reason for the lock");g(!0);try{let a=(a=>{switch(a){case"1h":return 36e5;case"4h":default:return 144e5;case"8h":return 288e5;case"24h":return 864e5;case"indefinite":return null}})(h.duration),b=E.find(a=>a.id===h.project);await d({project:h.project,projectName:b?.name||h.project,branch:h.branch,lockedBy:e?.name||"Unknown",lockedById:e?.id||"",reason:h.reason,expiresAt:a?new Date(Date.now()+a).toISOString():null})}finally{g(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 w-full max-w-md",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Create Dev Lock"}),(0,b.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white text-xl",children:"Ã—"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Project"}),(0,b.jsxs)("select",{value:h.project,onChange:a=>i(b=>({...b,project:a.target.value})),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select project..."}),E.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Branch"}),(0,b.jsx)("input",{type:"text",value:h.branch,onChange:a=>i(b=>({...b,branch:a.target.value})),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-yellow-500 focus:outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Reason ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("textarea",{value:h.reason,onChange:a=>i(b=>({...b,reason:a.target.value})),placeholder:"e.g., Implementing new authentication flow...",rows:2,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-yellow-500 focus:outline-none resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Duration"}),(0,b.jsx)("div",{className:"grid grid-cols-5 gap-2",children:["1h","4h","8h","24h","indefinite"].map(a=>(0,b.jsx)("button",{onClick:()=>i(b=>({...b,duration:a})),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${h.duration===a?"bg-yellow-500/15 text-yellow-400 border border-yellow-500/30":"bg-gray-900 text-gray-400 border border-gray-700 hover:border-gray-600"}`,children:"indefinite"===a?"âˆž":a},a))})]}),(0,b.jsx)("div",{className:"bg-yellow-500/10 border border-yellow-500/30 text-yellow-400 px-3 py-2 rounded-lg text-sm",children:"This will block git pulls on this project until the lock is released."}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg text-sm font-semibold hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{onClick:j,disabled:f||!h.project||!h.reason.trim(),className:"flex-1 px-4 py-2 bg-yellow-500 text-black rounded-lg text-sm font-semibold hover:bg-yellow-400 transition-colors disabled:opacity-50",children:f?"Creating...":"Create Lock"})]})]})]})})}let H=[{id:"tradelines",name:"NextBid Engine",currentVersion:"v2.4.0"},{id:"sources",name:"NextSource",currentVersion:"v1.1.5"},{id:"nextbidder",name:"NextBidder",currentVersion:"v2.9.1"},{id:"portals",name:"NextBid Portal",currentVersion:"v4.0.3"},{id:"nexttech",name:"NextTech",currentVersion:"v1.0.4"},{id:"nexttask",name:"NextTask",currentVersion:"v0.8.5"},{id:"dashboard",name:"Dashboard",currentVersion:"v0.9.0"}],I={blocker:{label:"Blocker",color:"bg-red-500/15 text-red-400 border-red-500/30",icon:"!!!",description:"Completely blocks deployment"},critical:{label:"Critical",color:"bg-orange-500/15 text-orange-400 border-orange-500/30",icon:"!!",description:"Major functionality broken"},major:{label:"Major",color:"bg-yellow-500/15 text-yellow-400 border-yellow-500/30",icon:"!",description:"Significant issue needs fix"}};function J({flags:a,onFlag:d,onResolve:e,onRefresh:f}){let{user:g}=(0,s.useUser)(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l=a.filter(a=>!a.resolvedAt),m=l.filter(a=>"blocker"===a.severity).length,n=async a=>{if(confirm("Are you sure this bug has been fixed and verified?")){k(a);try{await e(a),f()}finally{k(null)}}};return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Bug Flags"}),m>0&&(0,b.jsxs)("span",{className:"px-2 py-0.5 bg-red-500/15 text-red-400 border border-red-500/30 rounded text-xs font-semibold",children:[m," blocker",m>1?"s":""]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-400",children:"Flag bugs to block promotion to production"})]}),(0,b.jsx)(D.RoleGate,{permission:"canPushToTest",children:(0,b.jsx)("button",{onClick:()=>i(!0),className:"px-3 py-1.5 bg-red-500/15 text-red-400 border border-red-500/30 rounded-lg text-sm font-semibold hover:bg-red-500 hover:text-white transition-colors",children:"+ Flag Bug"})})]}),(0,b.jsx)("div",{className:"p-4",children:0===l.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"âœ”"}),(0,b.jsx)("div",{children:"No active bug flags"}),(0,b.jsx)("div",{className:"text-sm mt-1",children:"All projects clear for production"})]}):(0,b.jsx)("div",{className:"space-y-3",children:l.map(a=>{let c,d,e,f,g=I[a.severity];return(0,b.jsx)("div",{className:`bg-gray-900 border rounded-lg p-4 ${g.color.split(" ")[2]}`,children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsxs)("span",{className:`px-2 py-0.5 rounded text-xs font-bold ${g.color}`,children:[g.icon," ",g.label]}),(0,b.jsx)("span",{className:"font-medium text-white",children:a.projectName}),(0,b.jsx)("span",{className:"text-xs text-gray-500 font-mono",children:a.version})]}),(0,b.jsx)("div",{className:"text-white mt-2 font-medium",children:a.title}),a.description&&(0,b.jsx)("div",{className:"text-sm text-gray-400 mt-1",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[(0,b.jsxs)("span",{children:["Flagged by ",a.flaggedBy]}),(0,b.jsx)("span",{children:(c=new Date(a.createdAt),f=Math.floor((e=Math.floor((d=Math.floor((new Date().getTime()-c.getTime())/6e4))/60))/24),d<60?`${d}m ago`:e<24?`${e}h ago`:f<7?`${f}d ago`:c.toLocaleDateString())}),a.linkedTicketId&&(0,b.jsxs)("span",{className:"text-cyan-400",children:["Ticket #",a.linkedTicketId.slice(0,8)]})]})]}),(0,b.jsx)(D.RoleGate,{permission:"canPushToTest",children:(0,b.jsx)("button",{onClick:()=>n(a.id),disabled:j===a.id,className:"px-3 py-1.5 bg-green-500/15 text-green-400 border border-green-500/30 rounded-lg text-xs font-semibold hover:bg-green-500 hover:text-white transition-colors disabled:opacity-50",children:j===a.id?"Resolving...":"Mark Resolved"})})]})},a.id)})})}),m>0&&(0,b.jsxs)("div",{className:"mx-4 mb-4 bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg",children:[(0,b.jsx)("div",{className:"font-medium",children:"Production Deploys Blocked"}),(0,b.jsxs)("div",{className:"text-sm mt-1",children:[m," blocker bug",m>1?"s":""," must be resolved before deploying to production."]})]}),h&&(0,b.jsx)(K,{onClose:()=>i(!1),onSubmit:async a=>{await d(a),i(!1),f()}})]})}function K({onClose:a,onSubmit:d}){let{user:e}=(0,s.useUser)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)({project:"",version:"",severity:"major",title:"",description:"",linkedTicketId:""}),j=H.find(a=>a.id===h.project),k=async()=>{if(!h.project)return void alert("Please select a project");if(!h.title.trim())return void alert("Please provide a bug title");g(!0);try{await d({project:h.project,projectName:j?.name||h.project,version:h.version,severity:h.severity,title:h.title,description:h.description,flaggedBy:e?.name||"Unknown",flaggedById:e?.id||"",linkedTicketId:h.linkedTicketId||void 0})}finally{g(!1)}};return(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6 w-full max-w-lg",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Flag Bug"}),(0,b.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white text-xl",children:"Ã—"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Project"}),(0,b.jsxs)("select",{value:h.project,onChange:a=>{var b;let c;return b=a.target.value,c=H.find(a=>a.id===b),void i(a=>({...a,project:b,version:c?.currentVersion||""}))},className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white focus:border-red-500 focus:outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select project..."}),H.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Version"}),(0,b.jsx)("input",{type:"text",value:h.version,onChange:a=>i(b=>({...b,version:a.target.value})),placeholder:"e.g., v2.4.0 or commit hash",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Severity"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Object.entries(I).map(([a,c])=>(0,b.jsxs)("button",{onClick:()=>i(b=>({...b,severity:a})),className:`px-3 py-2 rounded-lg text-sm font-medium border transition-colors ${h.severity===a?c.color:"bg-gray-900 text-gray-400 border-gray-700 hover:border-gray-600"}`,children:[(0,b.jsxs)("div",{className:"font-bold",children:[c.icon," ",c.label]}),(0,b.jsx)("div",{className:"text-xs opacity-70 mt-0.5",children:c.description})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:["Bug Title ",(0,b.jsx)("span",{className:"text-red-400",children:"*"})]}),(0,b.jsx)("input",{type:"text",value:h.title,onChange:a=>i(b=>({...b,title:a.target.value})),placeholder:"e.g., SAM authentication fails after timeout",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Description"}),(0,b.jsx)("textarea",{value:h.description,onChange:a=>i(b=>({...b,description:a.target.value})),placeholder:"Describe the bug and how to reproduce it...",rows:3,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none resize-none"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Link to Ticket (optional)"}),(0,b.jsx)("input",{type:"text",value:h.linkedTicketId,onChange:a=>i(b=>({...b,linkedTicketId:a.target.value})),placeholder:"Ticket ID or URL",className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-2 text-white placeholder-gray-500 focus:border-red-500 focus:outline-none"})]}),"blocker"===h.severity&&(0,b.jsx)("div",{className:"bg-red-500/15 border border-red-500/30 text-red-400 px-3 py-2 rounded-lg text-sm",children:"Blocker flags completely block production deployments for this project."}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)("button",{onClick:a,className:"flex-1 px-4 py-2 bg-gray-700 text-white rounded-lg text-sm font-semibold hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{onClick:k,disabled:f||!h.project||!h.title.trim(),className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-semibold hover:bg-red-600 transition-colors disabled:opacity-50",children:f?"Flagging...":"Flag Bug"})]})]})]})})}let L=[{scope:1,label:"Canary",slots:1,description:"Single tradeline test"},{scope:5,label:"Limited",slots:5,description:"25% of tradelines"},{scope:20,label:"Wide",slots:20,description:"All tradelines"},{scope:-1,label:"Full",slots:-1,description:"Complete rollout"}],M=[{id:"01",name:"security",port:31001},{id:"02",name:"administrative",port:31002},{id:"03",name:"facilities",port:31003},{id:"04",name:"logistics",port:31004},{id:"05",name:"electrical",port:31005},{id:"06",name:"lowvoltage",port:31006},{id:"07",name:"landscaping",port:31007},{id:"08",name:"hvac",port:31008},{id:"09",name:"plumbing",port:31009},{id:"10",name:"janitorial",port:31010},{id:"11",name:"support",port:31011},{id:"12",name:"waste",port:31012},{id:"13",name:"construction",port:31013},{id:"14",name:"roofing",port:31014},{id:"15",name:"painting",port:31015},{id:"16",name:"flooring",port:31016},{id:"17",name:"demolition",port:31017},{id:"18",name:"environmental",port:31018},{id:"19",name:"concrete",port:31019},{id:"20",name:"fencing",port:31020}];function N({deployment:a,onExpand:d,onRollback:e,onComplete:f}){var g;let{hasPermission:h}=(0,s.useUser)();h("canPushToProd");let[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(!1);if(!a)return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white mb-2",children:"Canary Deployment"}),(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"ðŸŽ®"}),(0,b.jsx)("div",{children:"No active canary deployment"}),(0,b.jsx)("div",{className:"text-sm mt-1",children:"Start a deployment to enable canary controls"})]})]});L.find(b=>b.scope===a.currentScope)||L[0];let m=L.findIndex(b=>b.scope===a.currentScope),n=L[m+1],o="complete"===a.status,p="failed"===a.status||"rolled_back"===a.status,q="monitoring"===a.status&&n&&a.healthScore>=95,r=async()=>{if(n&&q){j(!0);try{await d(a.id,n.scope)}finally{j(!1)}}},t=async()=>{if(confirm("Are you sure you want to rollback this deployment? This will revert all deployed slots.")){l(!0);try{await e(a.id)}finally{l(!1)}}},u=async()=>{confirm("Mark this canary deployment as complete?")&&await f(a.id)};return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl",children:[(0,b.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Canary Deployment"}),(0,b.jsxs)("p",{className:"text-sm text-gray-400",children:[a.projectName," ",a.version]})]}),(0,b.jsx)("div",{className:`px-3 py-1 rounded-lg text-sm font-semibold capitalize ${(a=>{switch(a){case"pending":default:return"text-gray-400";case"deploying":case"expanding":return"text-blue-400";case"monitoring":return"text-cyan-400";case"complete":return"text-green-400";case"failed":return"text-red-400";case"rolled_back":return"text-orange-400"}})(a.status)}`,children:a.status.replace("_"," ")})]})}),(0,b.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:L.map((a,c)=>{let d=c<m,e=c===m;return(0,b.jsxs)("div",{className:"flex-1 flex items-center",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold border-2 ${d?"bg-green-500/20 border-green-500 text-green-400":e?"bg-cyan-500/20 border-cyan-500 text-cyan-400":"bg-gray-900 border-gray-700 text-gray-500"}`,children:d?"&#10003;":-1===a.slots?"âˆž":a.slots}),(0,b.jsx)("div",{className:`text-xs mt-2 font-medium ${e?"text-cyan-400":d?"text-green-400":"text-gray-500"}`,children:a.label}),(0,b.jsx)("div",{className:"text-xs text-gray-600",children:a.description})]}),c<L.length-1&&(0,b.jsx)("div",{className:`h-0.5 flex-1 mx-2 ${d?"bg-green-500":"bg-gray-700"}`})]},a.scope)})})}),(0,b.jsx)("div",{className:"p-4 border-b border-gray-700",children:(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:`rounded-lg p-4 ${(g=a.healthScore)>=95?"text-green-400 bg-green-500/15":g>=80?"text-yellow-400 bg-yellow-500/15":"text-red-400 bg-red-500/15"}`,children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wider opacity-60",children:"Health Score"}),(0,b.jsxs)("div",{className:"text-3xl font-bold mt-1",children:[a.healthScore,"%"]}),(0,b.jsx)("div",{className:"text-xs mt-1",children:a.healthScore>=95?"Healthy":a.healthScore>=80?"Degraded":"Critical"})]}),(0,b.jsxs)("div",{className:`rounded-lg p-4 ${a.errorRate<=1?"text-green-400 bg-green-500/15":a.errorRate<=5?"text-yellow-400 bg-yellow-500/15":"text-red-400 bg-red-500/15"}`,children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wider opacity-60",children:"Error Rate"}),(0,b.jsxs)("div",{className:"text-3xl font-bold mt-1",children:[a.errorRate.toFixed(1),"%"]}),(0,b.jsx)("div",{className:"text-xs mt-1",children:a.errorRate<=1?"Normal":a.errorRate<=5?"Elevated":"High"})]})]})}),(0,b.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,b.jsxs)("div",{className:"text-sm font-medium text-gray-400 mb-3",children:["Deployed Slots (",a.deployedSlots.length,"/",-1===a.currentScope?20:a.currentScope,")"]}),(0,b.jsx)("div",{className:"grid grid-cols-10 gap-2",children:M.map(c=>{let d=a.deployedSlots.includes(c.id),e=a.targetSlots.includes(c.id);return(0,b.jsx)("div",{className:`aspect-square rounded flex items-center justify-center text-xs font-mono ${d?"bg-green-500/20 text-green-400 border border-green-500/30":e?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-gray-900 text-gray-600 border border-gray-700"}`,title:`${c.name} (${c.port})`,children:c.id},c.id)})}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded bg-green-500/20 border border-green-500/30"}),(0,b.jsx)("span",{className:"text-gray-500",children:"Deployed"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded bg-blue-500/20 border border-blue-500/30"}),(0,b.jsx)("span",{className:"text-gray-500",children:"Target"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded bg-gray-900 border border-gray-700"}),(0,b.jsx)("span",{className:"text-gray-500",children:"Pending"})]})]})]}),!o&&!p&&(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)("button",{onClick:t,disabled:k,className:"flex-1 px-4 py-2 bg-red-500/15 text-red-400 border border-red-500/30 rounded-lg text-sm font-semibold hover:bg-red-500 hover:text-white transition-colors disabled:opacity-50",children:k?"Rolling back...":"Rollback"}),n?(0,b.jsx)(D.RoleGate,{permission:"production"===a.targetEnvironment?"canPushToProd":"canPushToTest",children:(0,b.jsx)("button",{onClick:r,disabled:!q||i,className:"flex-1 px-4 py-2 bg-cyan-500 text-white rounded-lg text-sm font-semibold hover:bg-cyan-600 transition-colors disabled:opacity-50",children:i?"Expanding...":`Expand to ${n.label} (${-1===n.slots?"All":n.slots})`})}):(0,b.jsx)(D.RoleGate,{permission:"canPushToProd",children:(0,b.jsx)("button",{onClick:u,className:"flex-1 px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-semibold hover:bg-green-600 transition-colors",children:"Complete Deployment"})})]}),!q&&"monitoring"===a.status&&n&&(0,b.jsxs)("div",{className:"mt-3 text-sm text-yellow-400 text-center",children:["Health score must be 95%+ to expand. Current: ",a.healthScore,"%"]})]}),(0,b.jsxs)("div",{className:"p-4 bg-gray-900 rounded-b-xl",children:[(0,b.jsx)("div",{className:"text-xs font-medium text-gray-400 mb-2",children:"Timeline"}),(0,b.jsxs)("div",{className:"space-y-2 text-xs",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Started"}),(0,b.jsx)("span",{className:"text-gray-400",children:new Date(a.startedAt).toLocaleString()})]}),a.expandedAt.map((a,c)=>(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsxs)("span",{className:"text-gray-500",children:["Expanded to ",L[c+1]?.label]}),(0,b.jsx)("span",{className:"text-gray-400",children:new Date(a).toLocaleString()})]},c))]})]})]})}let O=[{id:"tradelines",name:"NextBid Engine",icon:(0,b.jsx)(l.Server,{className:"w-4 h-4"}),color:"cyan",patcherPort:7101,devPort:5101,testPort:5001,prodPort:"31001-31020",devDroplet:"161.35.229.220",prodDroplet:"64.23.151.201"},{id:"dev-environment",name:"Dev Studio",icon:(0,b.jsx)(p.Zap,{className:"w-4 h-4"}),color:"cyan",patcherPort:7100,devPort:5e3,testPort:5100,prodPort:"5000",devDroplet:"161.35.229.220",prodDroplet:"161.35.229.220"},{id:"sources",name:"NextSource",icon:(0,b.jsx)(m.Database,{className:"w-4 h-4"}),color:"orange",patcherPort:7102,devPort:5102,testPort:5002,prodPort:"8002",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nextbidder",name:"NextBidder",icon:(0,b.jsx)(n.Users,{className:"w-4 h-4"}),color:"purple",patcherPort:7103,devPort:5103,testPort:5003,prodPort:"8003",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"portals",name:"NextBid Portal",icon:(0,b.jsx)(n.Users,{className:"w-4 h-4"}),color:"green",patcherPort:7104,devPort:5104,testPort:5004,prodPort:"8004",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nexttech",name:"NextTech",icon:(0,b.jsx)(o.Wrench,{className:"w-4 h-4"}),color:"pink",patcherPort:7105,devPort:5105,testPort:5005,prodPort:"8005",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"},{id:"nexttask",name:"NextTask",icon:(0,b.jsx)(q.ListTodo,{className:"w-4 h-4"}),color:"yellow",patcherPort:7106,devPort:5106,testPort:5006,prodPort:"8006",devDroplet:"161.35.229.220",prodDroplet:"146.190.169.112"}];function P(){let{user:a,hasProjectAccess:g,hasPermission:l,isLoading:m}=(0,s.useUser)(),[n,o]=(0,c.useState)("train"),[p,q]=(0,c.useState)("tradelines"),[t,u]=(0,c.useState)(!0),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)({devStatus:null,prodStatus:null,ahead:0,behind:0,needsSync:!1,slots:[],health:"unknown"}),[z,A]=(0,c.useState)(""),[D,E]=(0,c.useState)(!1),[G,H]=(0,c.useState)(null),[I,K]=(0,c.useState)(null),[L,M]=(0,c.useState)([]),[P,Q]=(0,c.useState)(null),[R,S]=(0,c.useState)(null),T=(0,c.useContext)(r.PageTitleContext),U=(0,c.useContext)(r.PageActionsContext),[V,W]=(0,c.useState)([]),[X,Y]=(0,c.useState)([]),[Z,$]=(0,c.useState)(null),_=O.filter(a=>g(a.id)),aa=O.find(a=>a.id===p)||_[0]||O[0],ab=l("canPushToTest");async function ac(){w(!0);try{if("tradelines"===p){let[a,b]=await Promise.all([(0,C.getDevStatus)().catch(()=>null),(0,C.getHealthAll)().catch(()=>({servers:[]}))]),c=(b?.servers||b||[]).map(a=>({slotId:a.slotId||a.slot||"??",tradeline:a.tradeline||a.name||"unknown",port:a.port||a.mainPort||0,status:a.pm2Status||a.status||"unknown",health:a.health||("online"===a.pm2Status?"healthy":"offline")})),d=c.filter(a=>"healthy"===a.health||"online"===a.status).length,e=0===c.length?"unknown":d===c.length?"healthy":d>0?"degraded":"offline";y({devStatus:a?.dev?{commit:a.dev.commit?.slice(0,7)||"unknown",branch:a.dev.branch||"main",message:a.dev.message||"",author:a.dev.author||"",date:a.dev.date||""}:null,prodStatus:a?.prod?{commit:a.prod.commit?.slice(0,7)||"unknown",branch:a.prod.branch||"main",message:a.prod.message||"",author:a.prod.author||"",date:a.prod.date||""}:null,ahead:a?.ahead||0,behind:a?.behind||0,needsSync:(a?.ahead||0)>0,slots:c,health:e})}else if("dev-environment"===p){let a=await (0,C.getDevEnvironmentStatus)().catch(()=>null);y({devStatus:{commit:"local",branch:"main",message:"Windows dev"},prodStatus:{commit:a?.status==="online"?"running":"stopped",branch:"main",message:a?.status||"unknown"},ahead:0,behind:0,needsSync:!0,slots:[{slotId:"dev-env-7501",tradeline:"dev-environment",port:7501,status:a?.status||"unknown",health:a?.status==="online"?"healthy":"offline"}],health:a?.status==="online"?"healthy":"offline"})}else y({devStatus:{commit:"dev-xxx",branch:"main",message:"Latest changes"},prodStatus:{commit:"prod-xxx",branch:"main",message:"Running version"},ahead:0,behind:0,needsSync:!1,slots:[],health:"unknown"})}catch(a){console.error("Failed to fetch status:",a)}finally{u(!1),w(!1)}}async function ad(){H("pull"),K(null);try{await (0,C.gitPullDev)(),K({success:!0,message:"Git pull completed on dev server"}),await ac()}catch(a){K({success:!1,message:a.message})}finally{H(null)}}async function ae(){H("compare"),K(null);try{let a=await (0,C.compareDevProd)();K({success:!0,message:`Dev is ${a.ahead||0} commits ahead, ${a.behind||0} behind`}),await ac()}catch(a){K({success:!1,message:a.message})}finally{H(null)}}async function af(){H("diff");try{let a=await (0,C.getDevDiff)();A(a.diff||a.output||JSON.stringify(a,null,2)),E(!0)}catch(a){A(`Error fetching diff: ${a.message}`),E(!0)}finally{H(null)}}async function ag(){if(confirm("Push dev code to all production servers? This will restart all tradelines.")){H("push"),K(null);try{await (0,C.pushDevToAllTradelines)(),K({success:!0,message:"Code pushed to all production servers"}),await ac()}catch(a){K({success:!1,message:a.message})}finally{H(null)}}}async function ah(){if(confirm("Full sync deploy: git pull â†’ push to prod â†’ npm install â†’ pm2 restart all. Continue?")){H("sync"),K(null);try{await (0,C.fullSyncDeploy)(),K({success:!0,message:"Full sync deploy completed successfully"}),await ac()}catch(a){K({success:!1,message:a.message})}finally{H(null)}}}async function ai(a){if(confirm(`Deploy latest code to ${a}? This will restart the tradeline.`)){H(a),K(null);try{await (0,C.pushDevToTradeline)(a),K({success:!0,message:`Deployed to ${a}`}),await ac()}catch(a){K({success:!1,message:a.message})}finally{H(null)}}}function aj(){S(null)}function ak(){Q(null),S(null)}(0,c.useEffect)(()=>(T({title:"Push / Pull",description:`Deploy ${aa.name} from Dev â†’ Prod`}),U((0,b.jsxs)("div",{className:"flex gap-1",children:[ab&&(0,b.jsxs)("button",{onClick:()=>ah(),className:"flex items-center gap-1.5 px-3 py-1 bg-cyan-500/80 hover:bg-cyan-500 border border-black/30 rounded-lg text-white text-sm transition-colors",children:[(0,b.jsx)(d.Rocket,{className:"w-3.5 h-3.5"}),"Full Sync Deploy"]}),(0,b.jsxs)("button",{onClick:()=>ac(),className:"flex items-center gap-1.5 px-3 py-1 bg-white/10 hover:bg-white/20 border border-black/30 rounded-lg text-white text-sm transition-colors",children:[(0,b.jsx)(e.RefreshCw,{className:"w-3.5 h-3.5"}),"Refresh"]})]})),()=>U(null)),[T,U,aa.name]),(0,c.useEffect)(()=>{ac()},[p]),(0,c.useEffect)(()=>{let a=localStorage.getItem("slotOrder");if(a)try{M(JSON.parse(a))}catch(a){console.error("Failed to parse saved slot order")}},[]);let al=async a=>{let b={...a,id:`lock-${Date.now()}`,lockedAt:new Date().toISOString(),isActive:!0};W(a=>[...a,b])},am=async a=>{W(b=>b.map(b=>b.id===a?{...b,isActive:!1}:b))},an=async a=>{let b={...a,id:`flag-${Date.now()}`,createdAt:new Date().toISOString()};Y(a=>[...a,b])},ao=async a=>{Y(b=>b.map(b=>b.id===a?{...b,resolvedAt:new Date().toISOString(),resolvedBy:"Current User"}:b))},ap=async()=>{},aq=async()=>$(a=>a?{...a,status:"rolled_back"}:null),ar=async()=>$(a=>a?{...a,status:"complete"}:null),as=[{id:"train",label:"Pipeline"},{id:"locks",label:"Dev Locks",badge:V.filter(a=>a.isActive).length},{id:"bugs",label:"Bug Flags",badge:X.filter(a=>!a.resolvedAt).length},{id:"canary",label:"Canary",badge:+!!Z}],at=x.slots.filter(a=>"healthy"===a.health||"online"===a.status).length,au=x.slots.length,av={cyan:{bg:"bg-cyan-500/15",border:"border-cyan-500/30",text:"text-cyan-400"},orange:{bg:"bg-orange-500/15",border:"border-orange-500/30",text:"text-orange-400"},purple:{bg:"bg-purple-500/15",border:"border-purple-500/30",text:"text-purple-400"},green:{bg:"bg-green-500/15",border:"border-green-500/30",text:"text-green-400"},pink:{bg:"bg-pink-500/15",border:"border-pink-500/30",text:"text-pink-400"},yellow:{bg:"bg-yellow-500/15",border:"border-yellow-500/30",text:"text-yellow-400"}};return m||0!==_.length?(0,b.jsxs)("div",{className:"-mt-4",children:[(0,b.jsx)("div",{className:"sticky -top-4 z-20 bg-gray-900 -mx-8 px-8 pt-4 pb-3 border-b border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:"text-sm text-gray-500",children:"Product:"}),(0,b.jsx)("div",{className:"flex gap-2",children:_.map(a=>{let c=av[a.color]||av.cyan,d=p===a.id;return(0,b.jsxs)("button",{onClick:()=>q(a.id),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all border ${d?`${c.bg} ${c.border} ${c.text}`:"bg-gray-800 border-gray-700 text-gray-400 hover:border-gray-600 hover:text-gray-300"}`,children:[a.icon,a.name,"tradelines"===a.id&&x.slots.length>0&&(0,b.jsxs)("span",{className:`text-xs px-1.5 py-0.5 rounded ${"healthy"===x.health?"bg-green-500/20 text-green-400":"degraded"===x.health?"bg-yellow-500/20 text-yellow-400":"bg-gray-700 text-gray-400"}`,children:[x.slots.filter(a=>"healthy"===a.health||"online"===a.status).length,"/",x.slots.length]})]},a.id)})}),(0,b.jsxs)("div",{className:"ml-auto flex items-center gap-2",children:[(0,b.jsxs)("span",{className:`text-xs px-2 py-1 rounded ${ab?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:[a?.role?a.role.charAt(0).toUpperCase()+a.role.slice(1):"Guest",ab?" (Can Deploy)":" (View Only)"]}),_.length<O.length&&(0,b.jsxs)("span",{className:"text-xs text-gray-600",children:[O.length-_.length," unassigned"]})]})]})}),(0,b.jsxs)("div",{className:"sticky top-10 z-10 bg-gray-900 flex items-center justify-between mb-6 border-b border-gray-700 pb-4 pt-4 -mx-8 px-8",children:[(0,b.jsx)("div",{className:"flex gap-2",children:as.map(a=>(0,b.jsxs)("button",{onClick:()=>o(a.id),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${n===a.id?"bg-cyan-500/15 text-cyan-400 border border-cyan-500/30":"bg-gray-800 text-gray-400 border border-gray-700 hover:border-gray-600"}`,children:[a.label,void 0!==a.badge&&a.badge>0&&(0,b.jsx)("span",{className:`px-1.5 py-0.5 rounded text-xs font-bold ${"bugs"===a.id?"bg-red-500/20 text-red-400":"locks"===a.id?"bg-yellow-500/20 text-yellow-400":"bg-cyan-500/20 text-cyan-400"}`,children:a.badge})]},a.id))}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-green-500"}),(0,b.jsx)("span",{className:"text-gray-400",children:"Online/Healthy"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-500 animate-pulse"}),(0,b.jsx)("span",{className:"text-gray-400",children:"Deploying"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500"}),(0,b.jsx)("span",{className:"text-gray-400",children:"Needs Sync"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-red-500"}),(0,b.jsx)("span",{className:"text-gray-400",children:"Offline/Error"})]})]})]}),"train"===n&&(0,b.jsxs)("div",{className:"space-y-6",children:[I&&(0,b.jsx)("div",{className:`p-4 rounded-xl border ${I.success?"bg-green-500/10 border-green-500/30":"bg-red-500/10 border-red-500/30"}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[I.success?(0,b.jsx)(i.CheckCircle,{className:"w-5 h-5 text-green-400"}):(0,b.jsx)(j.XCircle,{className:"w-5 h-5 text-red-400"}),(0,b.jsx)("span",{className:I.success?"text-green-400":"text-red-400",children:I.message}),(0,b.jsx)("button",{onClick:()=>K(null),className:"ml-auto text-gray-500 hover:text-white",children:"Ã—"})]})}),(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-white",children:[aa.name," Pipeline"]}),(0,b.jsxs)("p",{className:"text-gray-400 text-sm",children:["Dev (",aa.devDroplet,") â†’ Prod (",aa.prodDroplet,")"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[v&&(0,b.jsx)(k.Loader2,{className:"w-4 h-4 text-gray-400 animate-spin"}),(0,b.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${x.needsSync?"bg-yellow-500/20 text-yellow-400":"bg-green-500/20 text-green-400"}`,children:x.needsSync?`${x.ahead} commits ahead`:"In Sync"})]})]}),t?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(k.Loader2,{className:"w-8 h-8 text-gray-400 animate-spin"})}):(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-6",children:[(0,b.jsxs)("div",{className:"bg-gray-900 border border-blue-500/30 rounded-xl p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),(0,b.jsx)("h3",{className:"font-semibold text-white",children:"Development"})]}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[":",aa.devPort]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.GitBranch,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-sm text-gray-300",children:x.devStatus?.branch||"main"})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Latest Commit"}),(0,b.jsx)("div",{className:"font-mono text-sm text-cyan-400",children:x.devStatus?.commit||"..."}),x.devStatus?.message&&(0,b.jsx)("div",{className:"text-xs text-gray-400 mt-1 truncate",children:x.devStatus.message})]}),(0,b.jsxs)("button",{onClick:ad,disabled:null!==G||!ab,title:ab?void 0:"Engineer+ required to deploy",className:"w-full py-2 px-3 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-lg text-blue-400 text-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:["pull"===G?(0,b.jsx)(k.Loader2,{className:"w-4 h-4 animate-spin"}):(0,b.jsx)(e.RefreshCw,{className:"w-4 h-4"}),"Git Pull"]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4",children:[(0,b.jsx)("button",{onClick:ae,disabled:null!==G,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 text-sm transition-colors disabled:opacity-50",children:"compare"===G?"Comparing...":"Compare Versions"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-px w-12 bg-gray-600"}),(0,b.jsx)(h,{className:"w-6 h-6 text-gray-500"}),(0,b.jsx)("div",{className:"h-px w-12 bg-gray-600"})]}),(0,b.jsx)("button",{onClick:af,disabled:null!==G,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-gray-300 text-sm transition-colors disabled:opacity-50",children:"diff"===G?"Loading...":"View Diff"}),ab?(0,b.jsx)("button",{onClick:ag,disabled:null!==G||!x.needsSync,className:"px-6 py-3 bg-green-500/80 hover:bg-green-500 disabled:bg-gray-700 rounded-lg text-white font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:"push"===G?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(k.Loader2,{className:"w-4 h-4 animate-spin"}),"Deploying..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Rocket,{className:"w-4 h-4"}),"Deploy to Prod"]})}):(0,b.jsxs)("div",{className:"px-4 py-2 bg-gray-800 rounded-lg text-gray-500 text-sm text-center",children:[(0,b.jsx)("div",{className:"text-xs text-yellow-500/70 mb-1",children:"Engineer+ required"}),"Deploy to Prod"]})]}),(0,b.jsxs)("div",{className:"bg-gray-900 border border-green-500/30 rounded-xl p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-3 h-3 rounded-full ${"tradelines"===p?at===au?"bg-green-500":at>0?"bg-yellow-500":"bg-red-500":"bg-gray-500"}`}),(0,b.jsx)("h3",{className:"font-semibold text-white",children:"Production"})]}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:aa.prodPort})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.GitBranch,{className:"w-4 h-4 text-gray-400"}),(0,b.jsx)("span",{className:"text-sm text-gray-300",children:x.prodStatus?.branch||"main"})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:"Running Commit"}),(0,b.jsx)("div",{className:"font-mono text-sm text-green-400",children:x.prodStatus?.commit||"..."}),x.prodStatus?.message&&(0,b.jsx)("div",{className:"text-xs text-gray-400 mt-1 truncate",children:x.prodStatus.message})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Slot Health"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex-1 bg-gray-700 rounded-full h-2",children:(0,b.jsx)("div",{className:`h-2 rounded-full ${at===au?"bg-green-500":"bg-yellow-500"}`,style:{width:au>0?`${at/au*100}%`:"0%"}})}),(0,b.jsxs)("span",{className:"text-xs text-gray-400",children:[at,"/",au]})]})]})]})]})]})]}),"tradelines"===p?(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Production Slots (20)"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Drag to reorder - your order is saved"})]}),0===x.slots.length?(0,b.jsx)("div",{className:"text-center py-8 text-gray-500",children:t?"Loading slots...":"No slot data available. Check patcher connection."}):(0,b.jsx)("div",{className:"grid grid-cols-5 gap-3",children:(function(){if(0===L.length)return x.slots;let a=new Map(x.slots.map(a=>[a.slotId,a])),b=[];for(let c of L){let d=a.get(c);d&&(b.push(d),a.delete(c))}for(let c of a.values())b.push(c);return b})().map(a=>(0,b.jsxs)("div",{draggable:!0,onDragStart:b=>{Q(a.slotId),b.dataTransfer.effectAllowed="move"},onDragOver:b=>{var c;return c=a.slotId,void(b.preventDefault(),c!==P&&S(c))},onDragLeave:aj,onDrop:b=>(function(a,b){if(a.preventDefault(),!P||P===b){Q(null),S(null);return}let c=L.length>0?[...L]:x.slots.map(a=>a.slotId),d=c.indexOf(P),e=c.indexOf(b);-1!==d&&-1!==e&&(c.splice(d,1),c.splice(e,0,P),M(c),localStorage.setItem("slotOrder",JSON.stringify(c))),Q(null),S(null)})(b,a.slotId),onDragEnd:ak,className:`bg-gray-900 border rounded-lg p-3 cursor-grab active:cursor-grabbing transition-all ${P===a.slotId?"opacity-50 scale-95":R===a.slotId?"border-cyan-500 ring-2 ring-cyan-500/30 scale-105":"healthy"===a.health||"online"===a.status?"border-green-500/30 hover:border-green-500/50":"stopped"===a.status||"offline"===a.health?"border-gray-600 hover:border-gray-500":"border-red-500/30 hover:border-red-500/50"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("span",{className:"font-mono text-xs text-gray-400",children:[":",a.port]}),(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${"healthy"===a.health||"online"===a.status?"bg-green-500":"stopped"===a.status||"offline"===a.health?"bg-gray-500":"bg-red-500"}`})]}),(0,b.jsx)("div",{className:"text-sm font-medium text-white capitalize truncate",children:a.tradeline}),ab?(0,b.jsx)("button",{onClick:()=>ai(a.tradeline),disabled:null!==G,className:"mt-2 w-full py-1 px-2 text-xs bg-gray-800 hover:bg-gray-700 rounded text-gray-400 hover:text-white transition-colors disabled:opacity-50",children:G===a.tradeline?(0,b.jsx)(k.Loader2,{className:"w-3 h-3 animate-spin mx-auto"}):"Deploy"}):(0,b.jsx)("div",{className:"mt-2 w-full py-1 px-2 text-xs bg-gray-800/50 rounded text-gray-600 text-center",children:"View Only"})]},a.slotId))})]}):(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsxs)("h3",{className:"text-lg font-semibold text-white",children:[aa.name," Status"]})}),(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"text-gray-400 mb-2",children:aa.icon}),(0,b.jsxs)("p",{className:"text-gray-500",children:["Patcher for ",aa.name," (port ",aa.patcherPort,") coming soon."]}),(0,b.jsxs)("p",{className:"text-gray-600 text-sm mt-2",children:["Single instance running on ",aa.prodDroplet,":",aa.prodPort]})]})]}),(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Port Reference"}),(0,b.jsxs)("div",{className:"grid grid-cols-4 gap-6 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Dev Droplet"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"161.35.229.220"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":5101 - Engine Dev"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Patcher Droplet"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"134.199.209.140"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":7100 - Orchestrator"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:":7101 - Tradeline Patcher"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Engine Droplet"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"64.23.151.201"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":31001-31020 - Main"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:":31101-31120 - Fetch"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-gray-400 mb-2 font-medium",children:"Portal Droplet"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:"146.190.169.112"}),(0,b.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:":8002 - NextSource"}),(0,b.jsx)("div",{className:"text-xs text-gray-500",children:":8004 - Portal"})]})]})]})]}),"locks"===n&&(0,b.jsx)(F,{locks:V,onLock:al,onUnlock:am,onRefresh:()=>{}}),"bugs"===n&&(0,b.jsx)(J,{flags:X,onFlag:an,onResolve:ao,onRefresh:()=>{}}),"canary"===n&&(0,b.jsx)(N,{deployment:Z,onExpand:ap,onRollback:aq,onComplete:ar}),D&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/70 z-50",onClick:()=>E(!1)}),(0,b.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] max-h-[80vh] bg-gray-900 border border-gray-700 rounded-xl shadow-2xl z-50 overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Code Diff (Dev vs Prod)"}),(0,b.jsx)("button",{onClick:()=>E(!1),className:"text-gray-400 hover:text-white",children:"Ã—"})]}),(0,b.jsx)("div",{className:"p-4 overflow-auto max-h-[60vh]",children:(0,b.jsx)("pre",{className:"text-xs text-gray-300 font-mono whitespace-pre-wrap",children:z})})]})]})]}):(0,b.jsx)(B,{variant:"not-assigned"})}a.s(["default",()=>P],66973)}];

//# sourceMappingURL=Studio_kodiack-dashboard-5500_src_app_dev-controls_releases_page_tsx_162f6fa4._.js.map