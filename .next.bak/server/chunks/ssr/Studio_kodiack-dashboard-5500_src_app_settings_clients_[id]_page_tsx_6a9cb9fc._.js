module.exports=[2477,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(55259),e=a.i(38270),f=a.i(73826),g=a.i(23099);let h=(0,a.i(81338).default)("folder-git-2",[["path",{d:"M18 19a5 5 0 0 1-5-5v8",key:"sz5oeg"}],["path",{d:"M9 20H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v5",key:"1w6njk"}],["circle",{cx:"13",cy:"12",r:"2",key:"1j92g6"}],["circle",{cx:"20",cy:"19",r:"2",key:"1obnsp"}]]);var i=a.i(96089),j=a.i(59089),k=a.i(17800),l=a.i(23834),m=a.i(9901),n=a.i(71948),o=a.i(51679);function p(){(0,d.useRouter)();let a=(0,d.useParams)().id,p=(0,c.useContext)(e.PageTitleContext),q=(0,c.useContext)(e.PageActionsContext),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(!0),[x,y]=(0,c.useState)(null),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(!1),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)({name:"",slug:"",description:"",server_path:"",local_path:"",git_repo:"",droplet_name:"",droplet_ip:"",port_dev:"",port_test:"",port_prod:"",table_prefix:""}),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)("developer"),[L,M]=(0,c.useState)(!1);(0,c.useEffect)(()=>(r&&p({title:r.name,description:`Manage projects and team for ${r.slug}`}),q(null),()=>{p({title:"",description:""})}),[r,p,q]),(0,c.useEffect)(()=>{!async function(){try{let[b,c]=await Promise.all([fetch(`/api/clients/${a}`),fetch("/api/users")]);if(!b.ok)throw Error("Failed to load client");let d=await b.json();if(s(d),c.ok){let a=await c.json();u(a)}}catch(a){y(a.message)}finally{w(!1)}}()},[a]);let N=async()=>{r&&(await navigator.clipboard.writeText(r.id),A(!0),setTimeout(()=>A(!1),2e3))},O=async b=>{b.preventDefault(),M(!0);try{let b=await fetch(`/api/clients/${a}/projects`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...F,port_dev:F.port_dev?parseInt(F.port_dev):null,port_test:F.port_test?parseInt(F.port_test):null,port_prod:F.port_prod?parseInt(F.port_prod):null})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to create project")}let c=await fetch(`/api/clients/${a}`),d=await c.json();s(d),C(!1),G({name:"",slug:"",description:"",server_path:"",local_path:"",git_repo:"",droplet_name:"",droplet_ip:"",port_dev:"",port_test:"",port_prod:"",table_prefix:""})}catch(a){alert(a.message)}finally{M(!1)}},P=async b=>{b.preventDefault(),M(!0);try{let b=await fetch(`/api/clients/${a}/devs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:H,role:J})});if(!b.ok){let a=await b.json();throw Error(a.error||"Failed to assign dev")}let c=await fetch(`/api/clients/${a}`),d=await c.json();s(d),E(!1),I(""),K("developer")}catch(a){alert(a.message)}finally{M(!1)}},Q=async b=>{if(confirm("Remove this developer from the client?"))try{if(!(await fetch(`/api/clients/${a}/devs?assignmentId=${b}`,{method:"DELETE"})).ok)throw Error("Failed to remove dev");let c=await fetch(`/api/clients/${a}`),d=await c.json();s(d)}catch(a){alert(a.message)}},R=t.filter(a=>!r?.assignedDevs.some(b=>b.user_id===a.id));return v?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)("div",{className:"text-gray-400",children:"Loading client..."})}):x||!r?(0,b.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,b.jsx)("div",{className:"bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg",children:x||"Client not found"})}):(0,b.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,b.jsxs)(o.default,{href:"/settings/clients",className:"inline-flex items-center gap-2 text-gray-400 hover:text-white transition-colors",children:[(0,b.jsx)(g.ArrowLeft,{className:"w-4 h-4"}),"Back to Clients"]}),(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:"w-14 h-14 bg-blue-600/20 rounded-xl flex items-center justify-center",children:(0,b.jsx)(f.Building2,{className:"w-7 h-7 text-blue-400"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-white",children:r.name}),(0,b.jsxs)("p",{className:"text-gray-400",children:["slug: ",r.slug]}),r.description&&(0,b.jsx)("p",{className:"text-gray-500 mt-1",children:r.description})]})]}),(0,b.jsx)("span",{className:`px-3 py-1 rounded text-sm font-medium ${r.active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:r.active?"Active":"Inactive"})]}),(0,b.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-gray-500 text-xs uppercase font-medium",children:"Client UUID:"}),(0,b.jsx)("code",{className:"text-sm text-gray-300 bg-gray-900 px-2 py-1 rounded font-mono",children:r.id}),(0,b.jsx)("button",{onClick:N,className:"p-1.5 text-gray-400 hover:text-white hover:bg-gray-700 rounded transition-colors",title:"Copy UUID",children:z?(0,b.jsx)(m.Check,{className:"w-4 h-4 text-green-400"}):(0,b.jsx)(l.Copy,{className:"w-4 h-4"})})]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(h,{className:"w-5 h-5 text-purple-400"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Projects"}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["(",r.projects.length,")"]})]}),(0,b.jsxs)("button",{onClick:()=>C(!0),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700 transition-colors",children:[(0,b.jsx)(j.Plus,{className:"w-4 h-4"}),"Add Project"]})]}),0===r.projects.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(h,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No projects yet"})]}):(0,b.jsx)("div",{className:"space-y-3",children:r.projects.map(a=>(0,b.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-white",children:a.name}),(0,b.jsx)("p",{className:"text-gray-500 text-sm font-mono",children:a.slug})]}),(0,b.jsx)("span",{className:`px-2 py-0.5 rounded text-xs ${a.is_active?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:a.is_active?"Active":"Inactive"})]}),a.description&&(0,b.jsx)("p",{className:"text-gray-400 text-sm mt-2",children:a.description}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2 text-xs",children:[a.droplet_ip&&(0,b.jsx)("span",{className:"bg-gray-800 px-2 py-1 rounded text-gray-400",children:a.droplet_name||a.droplet_ip}),a.port_dev&&(0,b.jsxs)("span",{className:"bg-blue-500/20 text-blue-400 px-2 py-1 rounded",children:["Dev: ",a.port_dev]}),a.port_prod&&(0,b.jsxs)("span",{className:"bg-green-500/20 text-green-400 px-2 py-1 rounded",children:["Prod: ",a.port_prod]}),a.git_repo&&(0,b.jsxs)("a",{href:a.git_repo,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 bg-gray-800 px-2 py-1 rounded text-gray-400 hover:text-white",children:[(0,b.jsx)(n.ExternalLink,{className:"w-3 h-3"}),"Git"]})]})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Users,{className:"w-5 h-5 text-green-400"}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Assigned Developers"}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:["(",r.assignedDevs.length,")"]})]}),(0,b.jsxs)("button",{onClick:()=>E(!0),disabled:0===R.length,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white rounded-lg text-sm hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,b.jsx)(j.Plus,{className:"w-4 h-4"}),"Assign Dev"]})]}),0===r.assignedDevs.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)(i.Users,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No developers assigned"})]}):(0,b.jsx)("div",{className:"space-y-3",children:r.assignedDevs.map(a=>(0,b.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4 border border-gray-700 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-medium text-white",children:a.first_name||a.last_name?`${a.first_name||""} ${a.last_name||""}`.trim():a.email}),(0,b.jsx)("p",{className:"text-gray-500 text-sm",children:a.email}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[(0,b.jsx)("span",{className:"text-xs bg-blue-500/20 text-blue-400 px-2 py-0.5 rounded",children:a.role}),(0,b.jsx)("span",{className:"text-xs bg-gray-700 text-gray-400 px-2 py-0.5 rounded",children:a.user_role})]})]}),(0,b.jsx)("button",{onClick:()=>Q(a.assignment_id),className:"p-2 text-gray-400 hover:text-red-400 hover:bg-gray-800 rounded transition-colors",title:"Remove from client",children:(0,b.jsx)(k.Trash2,{className:"w-4 h-4"})})]},a.assignment_id))})]})]}),B&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>C(!1)}),(0,b.jsxs)("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-xl shadow-xl z-50 p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-700",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Add Project"}),(0,b.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Project Name *"}),(0,b.jsx)("input",{type:"text",value:F.name,onChange:a=>{var b;return b=a.target.value,void G({...F,name:b,slug:b.toLowerCase().replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()})},className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Slug *"}),(0,b.jsx)("input",{type:"text",value:F.slug,onChange:a=>G({...F,slug:a.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Server Path *"}),(0,b.jsx)("input",{type:"text",value:F.server_path,onChange:a=>G({...F,server_path:a.target.value}),placeholder:"/var/www/project-name",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Local Path"}),(0,b.jsx)("input",{type:"text",value:F.local_path,onChange:a=>G({...F,local_path:a.target.value}),placeholder:"C:\\Projects\\project-name",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Description"}),(0,b.jsx)("textarea",{value:F.description,onChange:a=>G({...F,description:a.target.value}),rows:2,className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Droplet Name"}),(0,b.jsx)("input",{type:"text",value:F.droplet_name,onChange:a=>G({...F,droplet_name:a.target.value}),placeholder:"Development",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Droplet IP"}),(0,b.jsx)("input",{type:"text",value:F.droplet_ip,onChange:a=>G({...F,droplet_ip:a.target.value}),placeholder:"161.35.229.220",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Dev Port"}),(0,b.jsx)("input",{type:"number",value:F.port_dev,onChange:a=>G({...F,port_dev:a.target.value}),placeholder:"3000",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Test Port"}),(0,b.jsx)("input",{type:"number",value:F.port_test,onChange:a=>G({...F,port_test:a.target.value}),placeholder:"3001",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Prod Port"}),(0,b.jsx)("input",{type:"number",value:F.port_prod,onChange:a=>G({...F,port_prod:a.target.value}),placeholder:"8080",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Git Repository"}),(0,b.jsx)("input",{type:"text",value:F.git_repo,onChange:a=>G({...F,git_repo:a.target.value}),placeholder:"https://github.com/...",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Table Prefix"}),(0,b.jsx)("input",{type:"text",value:F.table_prefix,onChange:a=>G({...F,table_prefix:a.target.value}),placeholder:"client_",className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white font-mono focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[(0,b.jsx)("button",{type:"button",onClick:()=>C(!1),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:L,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:L?"Creating...":"Create Project"})]})]})]})]}),D&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50",onClick:()=>E(!1)}),(0,b.jsxs)("div",{className:"fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-xl shadow-xl z-50 p-6 w-full max-w-md border border-gray-700",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"Assign Developer"}),(0,b.jsxs)("form",{onSubmit:P,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Select Developer"}),(0,b.jsxs)("select",{value:H,onChange:a=>I(a.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select a developer..."}),R.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.first_name||a.last_name?`${a.first_name||""} ${a.last_name||""}`.trim():a.email," ","(",a.role,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Role on this Client"}),(0,b.jsxs)("select",{value:J,onChange:a=>K(a.target.value),className:"w-full px-3 py-2 bg-gray-900 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-green-500",children:[(0,b.jsx)("option",{value:"developer",children:"Developer"}),(0,b.jsx)("option",{value:"lead",children:"Lead Developer"}),(0,b.jsx)("option",{value:"manager",children:"Project Manager"}),(0,b.jsx)("option",{value:"support",children:"Support"})]})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[(0,b.jsx)("button",{type:"button",onClick:()=>E(!1),className:"px-4 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:L||!H,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:L?"Assigning...":"Assign Developer"})]})]})]})]})]})}a.s(["default",()=>p],2477)}];

//# sourceMappingURL=Studio_kodiack-dashboard-5500_src_app_settings_clients_%5Bid%5D_page_tsx_6a9cb9fc._.js.map