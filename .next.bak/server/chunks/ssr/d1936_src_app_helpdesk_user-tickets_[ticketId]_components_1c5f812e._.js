module.exports=[58240,a=>{"use strict";var b=a.i(18030);function c({ticket:a}){let c=a=>new Date(a).toLocaleString();return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-gray-700",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400 text-lg font-bold",children:a.user_name?.charAt(0)||a.user_email?.charAt(0)||"?"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium text-white",children:a.user_name||"Unknown User"}),(0,b.jsx)("div",{className:"text-sm text-gray-400",children:a.user_email})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded ${{open:"bg-blue-500/20 text-blue-400",awaiting_response:"bg-yellow-500/20 text-yellow-400",in_progress:"bg-purple-500/20 text-purple-400",resolved:"bg-green-500/20 text-green-400",closed:"bg-gray-500/20 text-gray-400"}[a.status]}`,children:a.status.replace(/_/g," ")}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded ${{low:"bg-gray-500/20 text-gray-400",normal:"bg-blue-500/20 text-blue-400",high:"bg-yellow-500/20 text-yellow-400",urgent:"bg-red-500/20 text-red-400"}[a.priority]}`,children:a.priority}),(0,b.jsx)("span",{className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded",children:a.category})]}),(0,b.jsxs)("div",{className:"bg-gray-900 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"Original Message"}),a.description?(0,b.jsx)("div",{className:"text-gray-300 whitespace-pre-wrap",children:a.description}):(0,b.jsx)("div",{className:"text-gray-500 italic",children:"No description provided"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-gray-700 text-xs text-gray-500",children:[(0,b.jsxs)("span",{children:["Created ",c(a.created_at)]}),(0,b.jsx)("span",{children:"·"}),(0,b.jsxs)("span",{children:["Updated ",c(a.updated_at)]})]})]})}a.s(["default",()=>c])},30972,a=>{"use strict";var b=a.i(18030),c=a.i(30072);function d({ticketId:a,history:d,cannedResponses:e}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(!1),n=async b=>{if(b.preventDefault(),f.trim()){k(!0);try{let b=await fetch(`/api/helpdesk/user-tickets/${a}/reply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:f,is_internal:h})}),c=await b.json();c.success?(g(""),window.location.reload()):alert(c.error||"Failed to send reply")}catch(a){alert(a.message)}finally{k(!1)}}},o=a=>new Date(a).toLocaleString();return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Conversation"}),(0,b.jsxs)("div",{className:"space-y-4 mb-6 max-h-[500px] overflow-y-auto",children:[d.map(a=>{if("status_change"===a.type)return(0,b.jsxs)("div",{className:"text-center text-xs text-gray-500 py-2",children:[a.content," · ",o(a.created_at)]},a.id);let c="agent"===a.author_type;return(0,b.jsx)("div",{className:`flex ${c?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-[80%] rounded-lg p-4 ${a.is_internal?"bg-yellow-500/10 border border-yellow-500/30":c?"bg-purple-500/20":"bg-gray-900"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${c?"bg-purple-500/30 text-purple-400":"bg-blue-500/30 text-blue-400"}`,children:a.author.charAt(0)}),(0,b.jsx)("span",{className:"text-sm text-gray-400",children:a.author}),a.is_internal&&(0,b.jsx)("span",{className:"text-xs bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded",children:"Internal Note"}),(0,b.jsx)("span",{className:"text-xs text-gray-600 ml-auto",children:o(a.created_at)})]}),(0,b.jsx)("div",{className:"text-sm text-gray-300 whitespace-pre-wrap",children:a.content})]})},a.id)}),0===d.length&&(0,b.jsx)("div",{className:"text-center py-8 text-gray-500 text-sm",children:"No conversation yet"})]}),(0,b.jsxs)("form",{onSubmit:n,children:[e.length>0&&(0,b.jsxs)("div",{className:"mb-3",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>m(!l),className:"text-xs text-purple-400 hover:text-purple-300",children:[l?"Hide":"Show"," Canned Responses"]}),l&&(0,b.jsx)("div",{className:"mt-2 p-3 bg-gray-900 rounded-lg max-h-[150px] overflow-y-auto",children:(0,b.jsx)("div",{className:"space-y-2",children:e.map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>{var b;return b=a.content,void(g(a=>a+b),m(!1))},className:"w-full text-left p-2 rounded bg-gray-800 hover:bg-gray-700 transition-colors",children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.title}),(0,b.jsx)("div",{className:"text-xs text-gray-500 truncate",children:a.content})]},a.id))})})]}),(0,b.jsx)("textarea",{value:f,onChange:a=>g(a.target.value),placeholder:h?"Add an internal note...":"Type your reply to the customer...",rows:4,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-4 py-3 text-white placeholder-gray-500 focus:border-purple-500 focus:outline-none resize-none mb-3"}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-400",children:[(0,b.jsx)("input",{type:"checkbox",checked:h,onChange:a=>i(a.target.checked),className:"rounded bg-gray-700 border-gray-600"}),"Internal note (not visible to customer)"]}),(0,b.jsx)("button",{type:"submit",disabled:j||!f.trim(),className:`px-4 py-2 rounded-lg text-sm font-semibold transition-colors disabled:opacity-50 ${h?"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500 hover:text-black":"bg-purple-500 text-white hover:bg-purple-600"}`,children:j?"Sending...":h?"Add Note":"Send Reply"})]})]})]})}a.s(["default",()=>d])},33599,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(55259);function e({ticket:a,assignableUsers:e}){let f=(0,d.useRouter)(),[g,h]=(0,c.useState)(null),i=async(b,c)=>{h(b);try{let d=await fetch(`/api/helpdesk/user-tickets/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({[b]:c||null})}),e=await d.json();e.success?window.location.reload():alert(e.error||`Failed to update ${b}`)}catch(a){alert(a.message)}finally{h(null)}},j=async()=>{let b=prompt("Enter resolution notes:");if(null!==b){h("resolve");try{let c=await fetch(`/api/helpdesk/user-tickets/${a.id}/close`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resolution:b})}),d=await c.json();d.success?f.push("/helpdesk/user-tickets"):alert(d.error||"Failed to resolve ticket")}catch(a){alert(a.message)}finally{h(null)}}};return(0,b.jsxs)("div",{className:"bg-gray-800 border border-gray-700 rounded-xl p-5 space-y-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Actions"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Status"}),(0,b.jsxs)("select",{value:a.status,onChange:a=>i("status",a.target.value),disabled:"status"===g,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,b.jsx)("option",{value:"open",children:"Open"}),(0,b.jsx)("option",{value:"awaiting_response",children:"Awaiting Response"}),(0,b.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,b.jsx)("option",{value:"resolved",children:"Resolved"}),(0,b.jsx)("option",{value:"closed",children:"Closed"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Priority"}),(0,b.jsxs)("select",{value:a.priority,onChange:a=>i("priority",a.target.value),disabled:"priority"===g,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,b.jsx)("option",{value:"low",children:"Low"}),(0,b.jsx)("option",{value:"normal",children:"Normal"}),(0,b.jsx)("option",{value:"high",children:"High"}),(0,b.jsx)("option",{value:"urgent",children:"Urgent"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Category"}),(0,b.jsxs)("select",{value:a.category,onChange:a=>i("category",a.target.value),disabled:"category"===g,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,b.jsx)("option",{value:"general",children:"General"}),(0,b.jsx)("option",{value:"billing",children:"Billing"}),(0,b.jsx)("option",{value:"technical",children:"Technical"}),(0,b.jsx)("option",{value:"account",children:"Account"}),(0,b.jsx)("option",{value:"feedback",children:"Feedback"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Assigned To"}),(0,b.jsxs)("select",{value:a.assigned_to||"",onChange:a=>i("assigned_to",a.target.value),disabled:"assigned_to"===g,className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-3 py-2 text-sm text-white focus:border-purple-500 focus:outline-none disabled:opacity-50",children:[(0,b.jsx)("option",{value:"",children:"Unassigned"}),e.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,b.jsx)("hr",{className:"border-gray-700"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Customer"}),(0,b.jsxs)("div",{className:"bg-gray-900 rounded-lg p-3",children:[(0,b.jsx)("div",{className:"text-sm text-white",children:a.user_email}),(0,b.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",a.user_id]})]})]}),(0,b.jsx)("hr",{className:"border-gray-700"}),(0,b.jsx)("div",{className:"space-y-2",children:"resolved"!==a.status&&"closed"!==a.status&&(0,b.jsx)("button",{onClick:j,disabled:null!==g,className:"w-full px-4 py-2 bg-green-500/15 text-green-400 border border-green-500/30 rounded-lg text-sm font-semibold hover:bg-green-500 hover:text-white transition-colors disabled:opacity-50",children:"resolve"===g?"Resolving...":"Mark as Resolved"})})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=d1936_src_app_helpdesk_user-tickets_%5BticketId%5D_components_1c5f812e._.js.map