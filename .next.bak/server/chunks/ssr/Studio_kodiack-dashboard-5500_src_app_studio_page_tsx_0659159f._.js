module.exports=[47408,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(38270),e=a.i(99170),f=a.i(59786),g=a.i(62301);function h({icon:a,label:c,active:d,onClick:e}){return(0,b.jsx)("button",{onClick:e,title:c,className:`w-10 h-10 rounded-lg flex items-center justify-center text-xl transition-colors ${d?"bg-blue-600 text-white":"hover:bg-gray-700 text-gray-400"}`,children:a})}function i({items:a,activePanel:d,onPanelChange:e,storageKey:f="studio-sidebar-order"}){let[g,i]=(0,c.useState)(a),[j,k]=(0,c.useState)(null),[l,m]=(0,c.useState)(null);(0,c.useEffect)(()=>{try{let b=localStorage.getItem(f);if(b){let c=JSON.parse(b),d=c.map(b=>a.find(a=>a.id===b)).filter(a=>void 0!==a),e=a.filter(a=>!c.includes(a.id));i([...d,...e])}else i(a)}catch{i(a)}},[a,f]);let n=(0,c.useCallback)(a=>{try{localStorage.setItem(f,JSON.stringify(a.map(a=>a.id)))}catch{}},[f]),o=a=>{a.currentTarget instanceof HTMLElement&&(a.currentTarget.style.opacity="1"),k(null),m(null)},p=()=>{m(null)};return(0,b.jsx)("div",{className:"flex flex-col gap-2",children:g.map((a,c)=>(0,b.jsxs)("div",{draggable:!0,onDragStart:a=>{k(c),a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("text/plain",c.toString()),a.currentTarget instanceof HTMLElement&&(a.currentTarget.style.opacity="0.5")},onDragEnd:o,onDragOver:a=>{a.preventDefault(),a.dataTransfer.dropEffect="move",m(c)},onDragLeave:p,onDrop:a=>((a,b)=>{if(a.preventDefault(),null===j||j===b)return void m(null);let c=[...g],[d]=c.splice(j,1);c.splice(b,0,d),i(c),n(c),m(null)})(a,c),className:`relative cursor-grab active:cursor-grabbing transition-transform ${l===c&&j!==c?"transform translate-y-1":""}`,children:[l===c&&null!==j&&j!==c&&(0,b.jsx)("div",{className:"absolute -top-1 left-0 right-0 h-0.5 bg-blue-500 rounded"}),(0,b.jsx)(h,{icon:a.icon,label:a.label,active:d===a.id,onClick:()=>e(d===a.id?null:a.id)})]},a.id))})}var j=a.i(27878),k=a.i(92395),l=a.i(30836);function m({url:a,setUrl:c,isLoading:d,serverStatus:e,isServerLoading:f,env:g,project:h,onNavigate:i,onRefresh:m,onStartServer:n,onStopServer:o,onRestartServer:p}){return(0,b.jsxs)("div",{className:"px-3 py-2 border-b border-gray-700 bg-gray-800 flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex items-center gap-1 pr-2 border-r border-gray-700",children:"running"===e?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:o,disabled:f,className:"p-1.5 bg-red-600 hover:bg-red-700 disabled:bg-gray-600 rounded text-white",title:"Stop Server",children:(0,b.jsx)(k.Square,{className:"w-4 h-4"})}),(0,b.jsx)("button",{onClick:p,disabled:f,className:"p-1.5 bg-yellow-600 hover:bg-yellow-700 disabled:bg-gray-600 rounded text-white",title:"Restart Server",children:(0,b.jsx)(l.RefreshCw,{className:`w-4 h-4 ${f?"animate-spin":""}`})})]}):(0,b.jsxs)("button",{onClick:n,disabled:f||!h||"prod"===g.id,className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded text-white text-sm flex items-center gap-1",title:"prod"===g.id?"Cannot start prod server from dev studio":"Start Dev Server",children:[(0,b.jsx)(j.Play,{className:"w-4 h-4"}),f?"Starting...":"Start"]})}),(0,b.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded border text-xs ${(()=>{switch(e){case"running":return"bg-green-600/20 text-green-400 border-green-500/50";case"starting":return"bg-yellow-600/20 text-yellow-400 border-yellow-500/50";case"error":return"bg-red-600/20 text-red-400 border-red-500/50";default:return"bg-gray-600/20 text-gray-400 border-gray-500/50"}})()}`,children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${(()=>{switch(e){case"running":return"bg-green-500";case"starting":return"bg-yellow-500 animate-pulse";case"error":return"bg-red-500";default:return"bg-gray-500"}})()}`}),(0,b.jsx)("span",{className:"capitalize",children:e})]}),(0,b.jsx)("button",{onClick:m,disabled:"running"!==e,className:"p-1.5 hover:bg-gray-700 disabled:opacity-50 rounded text-gray-400 hover:text-white",title:"Refresh",children:"â†»"}),(0,b.jsxs)("div",{className:"flex-1 flex items-center bg-gray-900 rounded-lg border border-gray-700 px-3 py-1.5",children:[(0,b.jsx)("span",{className:"text-green-400 mr-2",children:"ðŸŒ"}),(0,b.jsx)("input",{type:"text",value:a,onChange:a=>c(a.target.value),onKeyDown:a=>"Enter"===a.key&&i(),placeholder:"Enter URL...",className:"flex-1 bg-transparent text-white text-sm outline-none"}),d&&(0,b.jsx)("span",{className:"animate-spin text-blue-400",children:"â—Œ"})]}),(0,b.jsx)("button",{onClick:i,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg",children:"Go"}),(0,b.jsx)("div",{className:`px-2 py-1 rounded text-xs font-medium ${"dev"===g.id?"bg-blue-600/20 text-blue-400":"test"===g.id?"bg-yellow-600/20 text-yellow-400":"bg-green-600/20 text-green-400"}`,children:g.name})]})}function n({project:a,env:c,serverStatus:d,serverError:e,currentUrl:f,isServerLoading:g,iframeRef:h,onStartServer:i,onLoad:k}){return a?"stopped"===d?(0,b.jsx)("div",{className:"flex-1 bg-gray-900 flex items-center justify-center text-gray-500",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"â¸ï¸"}),(0,b.jsx)("p",{className:"text-lg mb-2",children:"Server not running"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:['Click "Start" to run ',a.name," on port ",a[c.portKey]]}),(0,b.jsxs)("button",{onClick:i,disabled:g||"prod"===c.id,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded-lg text-white flex items-center gap-2 mx-auto",children:[(0,b.jsx)(j.Play,{className:"w-5 h-5"}),g?"Starting...":"Start Dev Server"]})]})}):"starting"===d?(0,b.jsx)("div",{className:"flex-1 bg-gray-900 flex items-center justify-center text-gray-500",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-4 animate-spin",children:"âš™ï¸"}),(0,b.jsx)("p",{className:"text-lg mb-2",children:"Starting server..."}),(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:["Running npm run dev on port ",a[c.portKey]]})]})}):"error"===d?(0,b.jsx)("div",{className:"flex-1 bg-gray-900 flex items-center justify-center text-gray-500",children:(0,b.jsxs)("div",{className:"text-center max-w-md",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"âŒ"}),(0,b.jsx)("p",{className:"text-lg mb-2 text-red-400",children:"Server Error"}),(0,b.jsx)("p",{className:"text-sm text-gray-400 mb-4",children:e||"Unknown error occurred"}),(0,b.jsx)("button",{onClick:i,disabled:g,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-600 rounded-lg text-white",children:"Try Again"})]})}):f?(0,b.jsx)("div",{className:"flex-1 bg-white relative",children:(0,b.jsx)("iframe",{ref:h,src:f,className:"w-full h-full border-0",onLoad:k,onError:k,sandbox:"allow-same-origin allow-scripts allow-forms allow-popups",title:"Browser Preview"})}):(0,b.jsx)("div",{className:"flex-1 bg-gray-900 flex items-center justify-center text-gray-500",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"ðŸŒ"}),(0,b.jsx)("p",{children:"Enter a URL and click Go"})]})}):(0,b.jsx)("div",{className:"flex-1 bg-gray-900 flex items-center justify-center text-gray-500",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"text-4xl mb-4",children:"ðŸŒ"}),(0,b.jsx)("p",{children:"Select a project to preview"})]})})}function o({currentUrl:a,project:c,env:d}){return(0,b.jsxs)("div",{className:"px-3 py-1 border-t border-gray-700 bg-gray-800 flex items-center justify-between text-xs text-gray-500",children:[(0,b.jsx)("span",{children:a||"No URL loaded"}),(0,b.jsx)("span",{children:c?`${c.droplet_name} \xb7 localhost:${c[d.portKey]}`:"No project selected"})]})}function p({project:a,env:d,userId:e}){let f=(0,c.useRef)(null),{url:g,setUrl:h,currentUrl:i,setCurrentUrl:j,isLoading:k,setIsLoading:l,handleNavigate:p,handleRefresh:q}=function({project:a,env:b,iframeRef:d}){let[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(a){let c=a[b.portKey],d=`http://localhost:${c}`;f(d),"running"===a.dev_server_status&&h(d)}},[a,b]);let k=(0,c.useCallback)(()=>{e.trim()&&(j(!0),h(e.trim().startsWith("http")?e.trim():`http://${e.trim()}`))},[e]),l=(0,c.useCallback)(()=>{d.current&&g&&(j(!0),d.current.src=g)},[g,d]);return{url:e,setUrl:f,currentUrl:g,setCurrentUrl:h,isLoading:i,setIsLoading:j,handleNavigate:k,handleRefresh:l}}({project:a,env:d,iframeRef:f}),{serverStatus:r,serverError:s,isServerLoading:t,handleStartServer:u,handleStopServer:v,handleRestartServer:w,clearError:x}=function({project:a,env:b,userId:d,setCurrentUrl:e}){let[f,g]=(0,c.useState)("stopped"),[h,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!1);(0,c.useEffect)(()=>{a&&(g(a.dev_server_status||"stopped"),i(a.dev_server_error||null))},[a]);let l=(0,c.useCallback)(async()=>{if(a?.id)try{let c=await fetch("/api/dev-server"),d=await c.json();if(d.success){let c=d.projects.find(b=>b.id===a.id);if(c&&(g(c.dev_server_status||"stopped"),i(c.dev_server_error||null),"running"===c.dev_server_status)){let c=a[b.portKey];e(`http://localhost:${c}`)}}}catch(a){console.error("Failed to fetch server status:",a)}},[a,b,e]);(0,c.useEffect)(()=>{l();let a=setInterval(l,5e3);return()=>clearInterval(a)},[l]);let m=(0,c.useCallback)(async()=>{if(a?.id){k(!0),i(null);try{let c=await fetch("/api/dev-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"start",project_id:a.id,user_id:d,environment:b.id})}),f=await c.json();f.success?(g("running"),setTimeout(()=>{let c=a[b.portKey];e(`http://localhost:${c}`)},1e3)):(i(f.error),g("error"))}catch(a){console.error("Failed to start server:",a),i("Failed to start server"),g("error")}finally{k(!1)}}},[a,b,d,e]),n=(0,c.useCallback)(async()=>{if(a?.id){k(!0);try{let b=await fetch("/api/dev-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"stop",project_id:a.id})}),c=await b.json();c.success?(g("stopped"),e("")):i(c.error)}catch(a){console.error("Failed to stop server:",a),i("Failed to stop server")}finally{k(!1)}}},[a,e]);return{serverStatus:f,serverError:h,isServerLoading:j,handleStartServer:m,handleStopServer:n,handleRestartServer:(0,c.useCallback)(async()=>{if(a?.id){k(!0);try{let b=await fetch("/api/dev-server",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"restart",project_id:a.id})}),c=await b.json();c.success||i(c.error)}catch(a){console.error("Failed to restart server:",a),i("Failed to restart server")}finally{k(!1)}}},[a]),clearError:(0,c.useCallback)(()=>{i(null)},[])}}({project:a,env:d,userId:e,setCurrentUrl:j});return(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsx)(m,{url:g,setUrl:h,isLoading:k,serverStatus:r,isServerLoading:t,env:d,project:a,onNavigate:p,onRefresh:q,onStartServer:u,onStopServer:v,onRestartServer:w}),s&&(0,b.jsxs)("div",{className:"px-3 py-2 bg-red-900/50 border-b border-red-700 text-red-300 text-sm flex items-center justify-between",children:[(0,b.jsxs)("span",{children:["Error: ",s]}),(0,b.jsx)("button",{onClick:x,className:"text-red-400 hover:text-red-200",children:"âœ•"})]}),(0,b.jsx)(n,{project:a,env:d,serverStatus:r,serverError:s,currentUrl:i,isServerLoading:t,iframeRef:f,onStartServer:u,onLoad:()=>l(!1)}),(0,b.jsx)(o,{currentUrl:i,project:a,env:d})]})}var q=a.i(81338);let r=(0,q.default)("power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]),s=(0,q.default)("power-off",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var t=a.i(96591),u=a.i(68471);let v="161.35.229.220",w=`http://${v}:5403`;function x(a,b,c){if(a.readyState===WebSocket.OPEN)if(b.length>1e3){let d=[];for(let a=0;a<b.length;a+=1e3)d.push(b.slice(a,a+1e3));let e=0,f=()=>{e<d.length&&a.readyState===WebSocket.OPEN&&(a.send(JSON.stringify({type:"input",data:d[e]})),++e<d.length?setTimeout(f,50):setTimeout(()=>{a.readyState===WebSocket.OPEN&&(a.send(JSON.stringify({type:"input",data:"\r"})),c?.())},100))};f()}else a.send(JSON.stringify({type:"input",data:b})),setTimeout(()=>{a.readyState===WebSocket.OPEN&&(a.send(JSON.stringify({type:"input",data:"\r"})),c?.())},50)}function y(a,b){a.readyState===WebSocket.OPEN&&[1e3,1200,1500,2e3].forEach((c,d,e)=>{setTimeout(()=>{a.readyState===WebSocket.OPEN&&(a.send(JSON.stringify({type:"input",data:"\r"})),d===e.length-1&&b?.())},c)})}let z=function({projectPath:d="/var/www/Studio",wsUrl:e,port:g=5410,onMessage:h,sendRef:i,connectRef:j,onConversationMessage:k,onConnectionChange:l}){let{user:m}=(0,f.useUser)(),n=(0,c.useRef)(null),o=(0,c.useRef)(null),p=(0,c.useRef)(null),q=(0,c.useRef)(null),z=(0,c.useRef)(!1),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),I=(0,c.useRef)(null),{memoryStatus:J,susanContext:K,susanContextRef:L,fetchSusanContext:M,reset:N}=function(a){let[b,d]=(0,c.useState)("idle"),[e,f]=(0,c.useState)(null),g=(0,c.useRef)(null),h=(0,c.useCallback)(async()=>{d("loading"),console.log("[useSusanBriefing] Fetching context from Susan...");try{let b=await fetch(`${w}/api/context?project=${encodeURIComponent(a)}`);if(b.ok){let a=await b.json();return console.log("[useSusanBriefing] Context received:",{hasGreeting:!!a?.greeting,greetingLength:a?.greeting?.length||0,todos:a?.todos?.length||0,ports:a?.ports?.length||0}),f(a),g.current=a,d("loaded"),a}console.log("[useSusanBriefing] Susan returned non-OK:",b.status)}catch(a){console.log("[useSusanBriefing] Susan not available:",a)}return d("error"),null},[a]),i=(0,c.useCallback)(()=>{d("idle"),f(null),g.current=null},[]);return{memoryStatus:b,susanContext:e,susanContextRef:g,fetchSusanContext:h,reset:i}}(d),O=g+1,{connectToChad:P,sendToChad:Q,disconnect:R}=function(a,b,d,e=5401){let f=(0,c.useRef)(null),g=(0,c.useRef)(null),h=(0,c.useCallback)(()=>{if(!b)return void console.log("[ClaudeTerminal] No user ID available for Chad connection");try{let c=`ws://${v}:${e}/ws`;console.log("[ClaudeTerminal] Connecting to Chad at:",c);let h=new WebSocket(`${c}?project=${encodeURIComponent(a)}&userId=${b}&userName=${encodeURIComponent(d||"")}`);h.onopen=()=>{console.log("[ClaudeTerminal] Connected to Chad for transcription"),h.send(JSON.stringify({type:"session_start",payload:{}}))},h.onmessage=a=>{try{let b=JSON.parse(a.data);("session_started"===b.type||"session_created"===b.type)&&(g.current=b.sessionId,console.log("[ClaudeTerminal] Chad session started:",b.sessionId))}catch(a){console.log("[ClaudeTerminal] Chad message parse error:",a)}},h.onerror=a=>console.log("[ClaudeTerminal] Chad WebSocket error:",a),h.onclose=()=>{console.log("[ClaudeTerminal] Chad disconnected"),g.current=null},f.current=h}catch(a){console.log("[ClaudeTerminal] Could not connect to Chad:",a)}},[a,b,d,e]),i=(0,c.useCallback)(a=>{f.current?.readyState===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"terminal_output",payload:{sessionId:g.current,data:a}}))},[]),j=(0,c.useCallback)(()=>{f.current?.close(),f.current=null,g.current=null},[]);return{chadWsRef:f,chadSessionIdRef:g,connectToChad:h,sendToChad:i,disconnect:j}}(d,m?.id,m?.name,O),S=(0,c.useRef)(!1),T=(0,c.useRef)(!1),U=(0,c.useCallback)(a=>{n.current?.readyState===WebSocket.OPEN&&x(n.current,a)},[]);(0,c.useEffect)(()=>{i&&(i.current=A?U:null)},[i,U,A]),(0,c.useEffect)(()=>{l?.(A)},[A,l]),(0,c.useEffect)(()=>{if(!o.current||p.current)return;(async()=>{let{Terminal:b}=await a.A(56964),{FitAddon:c}=await a.A(10718),d=new b({theme:{background:"#0d1117",foreground:"#e6edf3",cursor:"#58a6ff",cursorAccent:"#0d1117",black:"#0d1117",red:"#ff7b72",green:"#3fb950",yellow:"#d29922",blue:"#58a6ff",magenta:"#bc8cff",cyan:"#39c5cf",white:"#e6edf3",brightBlack:"#484f58",brightRed:"#ffa198",brightGreen:"#56d364",brightYellow:"#e3b341",brightBlue:"#79c0ff",brightMagenta:"#d2a8ff",brightCyan:"#56d4dd",brightWhite:"#ffffff"},fontFamily:"JetBrains Mono, Menlo, Monaco, Consolas, monospace",fontSize:13,lineHeight:1.2,cursorBlink:!0,cursorStyle:"block",scrollback:5e3,convertEol:!0}),e=new c;d.loadAddon(e),o.current&&(d.open(o.current),e.fit(),d.writeln("\x1b[36mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\x1b[0m"),d.writeln(`\x1b[36m   ðŸ¤– AI Team Member Terminal (${g})       \x1b[0m`),d.writeln("\x1b[36mâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\x1b[0m"),d.writeln(""),d.writeln('\x1b[33mClick "Connect" to start the AI team member\x1b[0m'),d.writeln(""),p.current=d,q.current=e)})();let b=()=>{q.current&&setTimeout(()=>q.current?.fit(),100)};window.addEventListener("resize",b);let c=new ResizeObserver(b);return o.current&&c.observe(o.current),()=>{window.removeEventListener("resize",b),c.disconnect(),p.current&&(p.current.dispose(),p.current=null),q.current=null}},[g]);let V=(0,c.useCallback)(async()=>{if(n.current?.readyState===WebSocket.OPEN)return;D(!0),z.current=!1;let a=M(),b=e||`ws://${v}:${g}?path=${encodeURIComponent(d)}`;console.log("[ClaudeTerminal] Connecting via WebSocket to:",b);let c=new WebSocket(b);c.onopen=async()=>{console.log("[ClaudeTerminal] WebSocket connected"),B(!0),D(!1),P(),p.current&&(p.current.writeln("\x1b[32m[Connected]\x1b[0m"),p.current.writeln(""),p.current.writeln("\x1b[36mâ˜• Hold please... your AI team member will be right with you.\x1b[0m"),p.current.writeln("\x1b[90m   Starting Claude Code...\x1b[0m"),await a&&p.current.writeln("\x1b[35m   ðŸ“š Susan is loading memory...\x1b[0m"),p.current.writeln("")),q.current&&p.current&&c.send(JSON.stringify({type:"resize",cols:p.current.cols,rows:p.current.rows})),setTimeout(()=>{c.readyState===WebSocket.OPEN&&(c.send(JSON.stringify({type:"input",data:"claude"})),setTimeout(()=>{c.readyState===WebSocket.OPEN&&(c.send(JSON.stringify({type:"input",data:"\r"})),setTimeout(()=>{let a=L.current;if(!z.current&&c.readyState===WebSocket.OPEN)if(z.current=!0,S.current=!0,a?.greeting)console.log("[ClaudeTerminal] Sending Susan briefing to Claude"),p.current&&p.current.writeln("\x1b[35m\nðŸ“š Sending memory briefing to Claude...\x1b[0m"),x(c,a.greeting?a.greeting:"Susan couldn't load your memory. Starting fresh - what would you like to work on?",()=>{y(c,()=>{F(!0),p.current&&p.current.writeln("\x1b[32m\nâœ… Ready - chat box unlocked\x1b[0m")})});else console.log("[ClaudeTerminal] No Susan context available, sending /start command"),x(c,"/start",()=>{y(c,()=>{F(!0),p.current&&p.current.writeln("\x1b[32m\nâœ… Ready - chat box unlocked\x1b[0m")})})},25e3))},500))},2e3),setTimeout(()=>I.current?.focus(),100)},c.onmessage=a=>{try{let b=JSON.parse(a.data);if("output"===b.type&&p.current){p.current.write(b.data),p.current.scrollToBottom(),Q(b.data);let a=b.data.replace(/\x1b\[[0-9;]*m/g,"").replace(/\x1b\[[0-9;]*[ABCDEFGHJKSTfnsu]/g,"").replace(/\x1b\[[0-9;]*[JK]/g,"").replace(/\x1b\[\?[0-9;]*[hl]/g,"").replace(/\x1b[()][AB0-2]/g,"").replace(/\x1b\][^\x07\x1b]*(?:\x07|\x1b\\)/g,"").replace(/\x1b\][^\x07]*\x07/g,"").replace(/\x1b[^[]\S?/g,"").replace(/\r(?!\n)/g,"").replace(/\n{3,}/g,"\n\n").trim();!T.current&&(a.includes("Claude Code")||a.includes("Opus")||a.includes("What would you like")||a.includes("How can I help")||a.includes("â¯"))&&(T.current=!0,console.log("[ClaudeTerminal] Claude Code TUI detected"))}else"exit"===b.type&&(p.current&&p.current.writeln(`\x1b[33m[Process exited: ${b.code}]\x1b[0m`),B(!1))}catch(a){console.error("[ClaudeTerminal] Message parse error:",a)}},c.onerror=a=>{console.error("[ClaudeTerminal] WebSocket error:",a),p.current&&p.current.writeln("\x1b[31m[Connection error]\x1b[0m"),D(!1)},c.onclose=()=>{console.log("[ClaudeTerminal] WebSocket closed"),B(!1),D(!1),F(!1),p.current&&p.current.writeln("\x1b[33m[Disconnected]\x1b[0m")},n.current=c},[d,e,g,M,L,P,Q]),W=(0,c.useCallback)(()=>{n.current?.close(),n.current=null,R(),B(!1),F(!1),N(),S.current=!1,T.current=!1},[R,N]);(0,c.useEffect)(()=>{j&&(j.current=V)},[j,V]),(0,c.useEffect)(()=>{if(!A&&!C&&null===n.current){let a=setTimeout(()=>{V()},500);return()=>clearTimeout(a)}},[]);let X=(0,c.useCallback)(()=>{if(n.current?.readyState===WebSocket.OPEN){if(G.trim())x(n.current,G);else{var a;(a=n.current).readyState===WebSocket.OPEN&&a.send(JSON.stringify({type:"input",data:"\r"}))}H("")}},[G]);return(0,b.jsxs)("div",{className:"flex flex-col h-full bg-gray-900",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-800 border-b border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-base",children:"ðŸ¤–"}),(0,b.jsx)("span",{className:"text-sm font-medium text-white",children:"AI Worker"}),(0,b.jsxs)("span",{className:"text-xs text-orange-400/60",children:["[:",g,"]"]}),(0,b.jsx)("span",{className:`px-1.5 py-0.5 text-xs rounded ${A?"bg-green-600/20 text-green-400":C?"bg-yellow-600/20 text-yellow-400":"bg-gray-700 text-gray-400"}`,children:A?"Connected":C?"Connecting...":"Disconnected"}),A&&(0,b.jsxs)("span",{className:`flex items-center gap-1 px-1.5 py-0.5 text-xs rounded ${"loaded"===J?"bg-purple-600/20 text-purple-400":"loading"===J?"bg-yellow-600/20 text-yellow-400":"bg-gray-700 text-gray-500"}`,children:[(0,b.jsx)(u.Brain,{className:"w-3 h-3"}),"loaded"===J?"Memory":"loading"===J?"Loading...":"No Memory"]})]}),(0,b.jsx)("div",{className:"flex items-center gap-1",children:A?(0,b.jsxs)("button",{onClick:W,className:"flex items-center gap-1 px-2 py-1 text-xs bg-red-600/20 text-red-400 hover:bg-red-600/30 rounded",children:[(0,b.jsx)(s,{className:"w-3 h-3"}),"Disconnect"]}):(0,b.jsxs)("button",{onClick:V,disabled:C,className:"flex items-center gap-1 px-2 py-1 text-xs bg-green-600/20 text-green-400 hover:bg-green-600/30 rounded disabled:opacity-50",children:[(0,b.jsx)(r,{className:"w-3 h-3"}),C?"Connecting...":"Connect"]})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1 bg-gray-800/50 border-b border-gray-700 text-xs text-gray-500",children:[(0,b.jsx)(t.FolderOpen,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"truncate",children:d})]}),(0,b.jsx)("div",{ref:o,className:"flex-1 min-h-0 overflow-x-auto overflow-y-auto",style:{padding:"8px"}}),(0,b.jsxs)("div",{className:"shrink-0 border-t-2 border-orange-600",children:[(0,b.jsxs)("div",{className:"px-2 py-1 bg-orange-600/20 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-orange-400 text-xs font-medium",children:"Chat with Claude"}),!A&&(0,b.jsx)("span",{className:"text-orange-400/50 text-xs",children:"(connecting...)"}),A&&!E&&(0,b.jsx)("span",{className:"text-yellow-400/70 text-xs",children:"(loading Claude & briefing...)"}),A&&E&&(0,b.jsx)("span",{className:"text-green-400/70 text-xs",children:"(ready)"})]}),(0,b.jsx)("div",{className:"px-2 py-2 bg-gray-800",children:(0,b.jsx)("textarea",{ref:I,value:G,onChange:a=>H(a.target.value),onKeyDown:a=>{"Enter"===a.key&&!a.shiftKey&&(a.preventDefault(),A&&E&&X())},placeholder:A?E?"Type a message and press Enter... (Shift+Enter for new line)":"Please wait - loading Claude and sending briefing...":"Connecting to Claude...",rows:4,disabled:!A||!E,className:"w-full bg-gray-900 border-2 border-orange-600 rounded px-3 py-2 text-sm text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-orange-500 resize-none disabled:opacity-50 disabled:cursor-not-allowed"})})]})]})};var A=a.i(84852),B=a.i(77236),C=a.i(20912);let D={isRunning:!1,queue:0,processed:0,lastActivity:null,error:null,sessionsCapured:0,lastDumpTime:null,dumpIntervalMin:10},E={isRunning:!1,queue:0,processed:0,lastActivity:null,error:null,itemsFlagged:0,currentlyProcessing:null},F={isRunning:!1,queue:0,processed:0,lastActivity:null,error:null,itemsCategorized:0,currentlyFiling:null},G={};function H({teamBasePort:a,isGlobal:d=!1}){let e=a?a+1:void 0,f=function(a){if(!a)return"Global Team";let b=Math.floor((a-5400)/10);return 0===b?"Global Team":`Development Team ${b}`}(a),{chadStatus:g,jenStatus:h,susanStatus:i,buckets:j,previousBuckets:k,sessions:m,health:n,totalPending:o,loading:p,refreshAll:q}=function(a={}){let{chadPort:b,isGlobal:d}=a,e=d||!b?null:b>=5410&&b<5420?"dev1":b>=5420&&b<5430?"dev2":b>=5430&&b<5440?"dev3":null,[f,g]=(0,c.useState)(D),[h,i]=(0,c.useState)(E),[j,k]=(0,c.useState)(F),[l,m]=(0,c.useState)(G),[n,o]=(0,c.useState)(G),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!1),[t,u]=(0,c.useState)({chad:"idle",jen:"idle",susan:"idle",overall:"healthy"}),v=(0,c.useRef)([]),w=Object.values(l).reduce((a,b)=>a+b,0),x=(0,c.useCallback)(async()=>{try{let a=e?`?workspace=${e}`:"",b=e?`?workspace=${e}&limit=50`:"?limit=50",[c,d]=await Promise.all([fetch(`/api/ai-sessions/buckets${a}`,{cache:"no-store"}),fetch(`/api/ai-sessions${b}`,{cache:"no-store"})]);if(!c.ok||!d.ok)throw Error("Database fetch failed");let f=await c.json(),h=await d.json();if(f.success&&f.buckets){let a=f.buckets,b=f.stats||{};o(l),m(a),v.current=[...v.current.slice(-9),a];let c=(b.captured||0)+(b.active||0),d=b.last_session,e=d&&Date.now()-new Date(d).getTime()<18e5;g({isRunning:e||!1,queue:b.active||0,processed:b.total_sessions||0,lastActivity:d,error:null,sessionsCapured:c,lastDumpTime:d,dumpIntervalMin:10});let h=b.captured||0,j=b.flagged||0;i({isRunning:h>0,queue:h,processed:j,lastActivity:d,error:null,itemsFlagged:b.flagged||0,currentlyProcessing:h>0?"Processing...":null});let n=b.flagged||0,p=(b.pending||0)+(b.cleaned||0)+(b.archived||0);k({isRunning:n>0,queue:n,processed:p,lastActivity:d,error:null,itemsCategorized:p,currentlyFiling:n>0?"Filing...":null})}h.success&&h.sessions&&q(h.sessions)}catch(b){console.error("Failed to fetch from database:",b);let a=b instanceof Error?b.message:"Database connection failed";g(b=>({...b,error:a,isRunning:!1})),i(b=>({...b,error:a,isRunning:!1})),k(b=>({...b,error:a,isRunning:!1}))}},[l,e]),y=(0,c.useCallback)(()=>{let a=Date.now(),b="idle";if(f.error)b="error";else if(f.lastActivity){let c=new Date(f.lastActivity).getTime();a-c<6e5?b="healthy":a-c>18e5&&(b="stuck")}let c="idle";h.error?c="error":h.queue>0&&(c="healthy");let d="idle";j.error?d="error":j.queue>0&&(d="healthy");let e="healthy";"error"===b||"error"===c||"error"===d?e="down":"stuck"===b&&(e="degraded"),u({chad:b,jen:c,susan:d,overall:e})},[f,h,j]),z=(0,c.useCallback)(async()=>{s(!0),await x(),y(),s(!1)},[x,y]),A=(0,c.useCallback)(async a=>{console.log(`Trigger not supported - ${a} runs on database polling schedule`),await z()},[z]),B=(0,c.useCallback)(()=>{let a=Object.values(n).reduce((a,b)=>a+b,0);return Object.values(l).reduce((a,b)=>a+b,0)-a},[l,n]);return(0,c.useEffect)(()=>{z()},[]),(0,c.useEffect)(()=>{let a=setInterval(z,5e3);return()=>clearInterval(a)},[z]),(0,c.useEffect)(()=>{y()},[f,h,j,y]),{chadStatus:f,jenStatus:h,susanStatus:j,buckets:l,previousBuckets:n,sessions:p,health:t,totalPending:w,bucketDelta:B(),loading:r,triggerTeamMember:A,refreshAll:z}}({chadPort:e,isGlobal:d});return(0,b.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-4 py-2 bg-gray-800 border-b border-gray-700 flex items-center justify-between shrink-0 relative",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-lg font-semibold",children:"Session Hub"}),(0,b.jsx)(M,{health:n.overall})]}),(0,b.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2",children:(0,b.jsx)("span",{className:"text-lg font-bold text-cyan-400",children:f})}),(0,b.jsxs)("button",{onClick:q,disabled:p,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded transition-colors",children:[(0,b.jsx)(l.RefreshCw,{className:`w-4 h-4 ${p?"animate-spin":""}`}),"Refresh"]})]}),(0,b.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,b.jsx)(I,{name:"Chad",role:"Capture",health:n.chad,metric:g.sessionsCapured,metricLabel:"captured",color:"blue",error:g.error}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:0===m.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ“­"}),(0,b.jsx)("p",{className:"text-sm",children:"No sessions yet"}),(0,b.jsx)("p",{className:"text-xs mt-1",children:"Dumps every 10 min"})]}):m.map(a=>(0,b.jsx)(J,{session:a},a.id))})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,b.jsx)(I,{name:"Jen",role:"Scrub & Flag",health:n.jen,metric:h.itemsFlagged,metricLabel:"flagged",color:"purple",error:h.error}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-3",children:0===Object.keys(j).length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ·ï¸"}),(0,b.jsx)("p",{className:"text-sm",children:"No items flagged yet"})]}):(0,b.jsxs)("div",{className:"space-y-1",children:[Object.entries(j).sort((a,b)=>b[1]-a[1]).map(([a,c])=>(0,b.jsx)(K,{name:a,count:c,prev:k[a]??0},a)),(0,b.jsx)("div",{className:"pt-2 mt-2 border-t border-gray-700",children:(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total Pending"}),(0,b.jsx)("span",{className:"font-bold text-yellow-400",children:o})]})})]})})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,b.jsx)(I,{name:"Susan",role:"Categorize & File",health:n.susan,metric:i.itemsCategorized,metricLabel:"filed",color:"green",error:i.error}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-3",children:0===i.itemsCategorized?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-2xl mb-2",children:"ðŸ“"}),(0,b.jsx)("p",{className:"text-sm",children:"No items filed yet"}),(0,b.jsx)("p",{className:"text-xs mt-1",children:"Waiting for Jen"})]}):(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsx)(L,{sessions:m})})})]})]})]})}function I({name:a,role:c,health:d,metric:e,metricLabel:f,color:g,error:h}){return(0,b.jsxs)("div",{className:`p-3 border-b ${{blue:"bg-blue-900/50 border-blue-600",purple:"bg-purple-900/50 border-purple-600",green:"bg-green-900/50 border-green-600"}[g]} shrink-0`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`w-2 h-2 rounded-full ${{healthy:"bg-green-400",stuck:"bg-yellow-400 animate-pulse",error:"bg-red-400",idle:"bg-gray-500"}[d]}`}),(0,b.jsx)("span",{className:`font-semibold ${{blue:"text-blue-400",purple:"text-purple-400",green:"text-green-400"}[g]}`,children:a})]}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:c})]}),(0,b.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,b.jsx)("span",{className:"text-2xl font-bold text-white",children:e}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:f})]}),h&&(0,b.jsx)("div",{className:"mt-1 text-[10px] text-red-400 truncate",children:h})]})}function J({session:a}){let c=a.started_at?N(a.started_at):"??:??",d=a.ended_at?N(a.ended_at):"now",e=a.user_name||a.user_id||"Unknown",f=a.source_name||a.source_type||"Terminal",g=a.categorized_by_susan,h=a.scrubbed_by_jen&&!g,i=a.captured_by_chad&&!a.scrubbed_by_jen;return(0,b.jsxs)("div",{className:`p-2 rounded border text-sm ${g?"border-green-800/50 bg-green-900/10 opacity-50":h?"border-purple-800/50 bg-purple-900/20":i?"border-yellow-800/50 bg-yellow-900/20":"border-blue-800/50 bg-blue-900/20"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-white truncate",children:e}),(0,b.jsxs)("span",{className:"text-[10px] text-gray-500 font-mono shrink-0 ml-2",children:[c," - ",d]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 truncate",children:f}),(0,b.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${g?"bg-green-900/50 text-green-400":h?"bg-purple-900/50 text-purple-400":i?"bg-yellow-900/50 text-yellow-400":"bg-blue-900/50 text-blue-400"}`,children:g?"âœ“ Done":h?"â†’ Jen":i?"â†’ Susan":"Captured"})]})]})}function K({name:a,count:c,prev:d}){let e=c-d;return(0,b.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded ${c>0?"bg-purple-900/20":"bg-gray-800/30"}`,children:[(0,b.jsx)("span",{className:`text-sm truncate ${c>0?"text-white":"text-gray-500"}`,children:a}),(0,b.jsxs)("div",{className:"flex items-center gap-2 shrink-0 ml-2",children:[0!==e&&(0,b.jsxs)("span",{className:`text-[10px] font-mono ${e>0?"text-green-400":"text-red-400"}`,children:[e>0?"+":"",e]}),(0,b.jsx)("span",{className:`font-mono font-bold min-w-[24px] text-right ${c>0?"text-purple-400":"text-gray-600"}`,children:c})]})]})}function L({sessions:a}){let c={};a.filter(a=>a.categorized_by_susan).forEach(a=>{let b=a.project_path||a.source_name||"Unknown Project",d=b.split("/").pop()||b;c[d]||(c[d]={count:0,recent:[]}),c[d].count++,c[d].recent.length<3&&c[d].recent.push(a.user_name||a.user_id||"Unknown")});let d=Object.entries(c).sort((a,b)=>b[1].count-a[1].count);return 0===d.length?(0,b.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"No items filed to projects yet"}):(0,b.jsx)("div",{className:"space-y-2",children:d.map(([a,c])=>(0,b.jsxs)("div",{className:"p-2 rounded bg-green-900/20 border border-green-800/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-white truncate",children:a}),(0,b.jsx)("span",{className:"text-green-400 font-mono font-bold",children:c.count})]}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500 mt-1 truncate",children:c.recent.join(", ")})]},a))})}function M({health:a}){let c={healthy:{bg:"bg-green-600/20",text:"text-green-400",icon:B.CheckCircle,label:"Healthy"},degraded:{bg:"bg-yellow-600/20",text:"text-yellow-400",icon:A.AlertTriangle,label:"Degraded"},down:{bg:"bg-red-600/20",text:"text-red-400",icon:C.XCircle,label:"Down"}}[a],d=c.icon;return(0,b.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded ${c.bg}`,children:[(0,b.jsx)(d,{className:`w-3.5 h-3.5 ${c.text}`}),(0,b.jsx)("span",{className:`text-xs font-medium ${c.text}`,children:c.label})]})}function N(a){return new Date(a).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}var O=a.i(59089),P=a.i(23099),Q=a.i(89608),R=a.i(32808),S=a.i(97158),T=a.i(66782),U=a.i(90658),V=a.i(33020),W=a.i(30587),X=a.i(21605),Y=a.i(73826),Z=a.i(66962),$=a.i(5494),_=a.i(97233),aa=a.i(48934),ab=a.i(88304),ac=a.i(53828),ad=a.i(34498),ae=a.i(42084),af=a.i(99049),ag=a.i(23785),ah=a.i(58270),ai=a.i(87756),aj=a.i(31452),ak=a.i(55921);function al({project:a,summary:c,formatTimeAgo:d,onSelect:e,onEdit:f}){let{attributes:g,listeners:h,setNodeRef:i,transform:j,transition:k,isDragging:l}=(0,ab.useSortable)({id:a.id}),m={transform:ac.CSS.Transform.toString(j),transition:k,opacity:l?.5:1,zIndex:l?1e3:"auto"};return(0,b.jsx)("div",{ref:i,style:m,className:"p-3 bg-gray-800 hover:bg-gray-750 border border-gray-700 hover:border-blue-500 rounded cursor-pointer group transition-colors",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("button",{...g,...h,className:"p-1 text-gray-600 hover:text-white cursor-grab active:cursor-grabbing flex-shrink-0 mt-1",onClick:a=>a.stopPropagation(),children:(0,b.jsx)(T.GripVertical,{className:"w-4 h-4"})}),(0,b.jsx)("div",{onClick:()=>e(a),className:"flex-shrink-0",children:a.logo_url?(0,b.jsx)("img",{src:a.logo_url,alt:"",className:"w-10 h-10 rounded object-cover"}):(0,b.jsx)("div",{className:"w-10 h-10 rounded bg-blue-600/20 flex items-center justify-center text-blue-400 font-bold",children:a.name.charAt(0).toUpperCase()})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",onClick:()=>e(a),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-white font-medium",children:a.name}),(0,b.jsxs)("span",{className:"text-gray-600 text-xs",children:["(",a.slug,")"]}),(0,b.jsx)(R.ChevronRight,{className:"w-4 h-4 text-gray-600 group-hover:text-blue-400 ml-auto flex-shrink-0"})]}),a.description&&(0,b.jsx)("p",{className:"text-gray-400 text-sm mt-0.5 truncate",children:a.description}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 mt-2 text-xs",children:[a.droplet_name&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-gray-400",children:[(0,b.jsx)(Q.Server,{className:"w-3 h-3"}),a.droplet_name,a.droplet_ip&&(0,b.jsxs)("span",{className:"text-gray-600",children:["(",a.droplet_ip,")"]})]}),(a.port_dev||a.port_test||a.port_prod)&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[a.port_dev&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 bg-blue-600/20 text-blue-400 rounded",children:["Dev:",a.port_dev]}),a.port_test&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 bg-yellow-600/20 text-yellow-400 rounded",children:["Test:",a.port_test]}),a.port_prod&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 bg-green-600/20 text-green-400 rounded",children:["Prod:",a.port_prod]})]}),a.build_number&&(0,b.jsxs)("span",{className:"text-gray-500",children:["Build: ",(0,b.jsx)("span",{className:"text-gray-300",children:a.build_number})]}),a.git_repo&&(0,b.jsx)("span",{className:"text-gray-500 truncate max-w-[200px]",children:a.git_repo.replace("https://github.com/","")})]}),c&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-x-3 gap-y-1 mt-2 pt-2 border-t border-gray-700/50 text-xs",children:[c.todos.total>0&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-gray-400",children:[(0,b.jsx)(U.CheckSquare,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"text-yellow-400",children:c.todos.pending}),(0,b.jsx)("span",{className:"text-gray-600",children:"/"}),(0,b.jsx)("span",{className:"text-green-400",children:c.todos.completed}),(0,b.jsx)("span",{className:"text-gray-600",children:"todos"})]}),c.knowledge>0&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-gray-400",children:[(0,b.jsx)(V.BookOpen,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"text-purple-400",children:c.knowledge}),(0,b.jsx)("span",{className:"text-gray-600",children:"knowledge"})]}),c.bugs>0&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-gray-400",children:[(0,b.jsx)(X.AlertCircle,{className:"w-3 h-3"}),(0,b.jsx)("span",{className:"text-red-400",children:c.bugs}),(0,b.jsx)("span",{className:"text-gray-600",children:"bugs"})]}),c.sessions.pending>0&&(0,b.jsxs)("span",{className:"flex items-center gap-1 px-1.5 py-0.5 bg-yellow-600/10 text-yellow-400 rounded",children:[c.sessions.pending," pending"]}),c.last_activity&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-gray-500 ml-auto",children:[(0,b.jsx)(W.Clock,{className:"w-3 h-3"}),d(c.last_activity)]})]})]}),(0,b.jsx)("button",{onClick:b=>{b.stopPropagation(),f(a)},className:"p-2 text-gray-500 hover:text-white hover:bg-gray-700 rounded opacity-0 group-hover:opacity-100 transition-all flex-shrink-0",children:(0,b.jsx)(S.Settings,{className:"w-4 h-4"})})]})})}function am({onProjectsChange:a}){let{selectedClient:d}=(0,Z.useClient)(),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)("todos"),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)({}),s=(0,aa.useSensors)((0,aa.useSensor)(aa.PointerSensor,{activationConstraint:{distance:8}}),(0,aa.useSensor)(aa.KeyboardSensor,{coordinateGetter:ab.sortableKeyboardCoordinates})),t=d?e.filter(a=>a.client_id===d.id):e;(0,c.useEffect)(()=>{u()},[]),(0,c.useEffect)(()=>{t.length>0&&v()},[t]);let u=async()=>{try{let a=await fetch("/project-management/api/projects"),b=await a.json();b.success&&f(b.projects)}catch(a){console.error("Error fetching projects:",a)}finally{l(!1)}},v=async()=>{try{let a=await fetch("/project-management/api/projects/summary"),b=await a.json();b.success&&b.summaries&&r(b.summaries)}catch(a){console.error("Error fetching project summaries:",a)}},w=a=>{if(!a)return null;let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/6e4),d=Math.floor(c/60),e=Math.floor(d/24);return c<1?"just now":c<60?`${c}m ago`:d<24?`${d}h ago`:e<7?`${e}d ago`:b.toLocaleDateString()},x=a=>{h(a),j("todos")},y=a=>{p(a),n(!0)},z=()=>{n(!1),p(null)},A=()=>{u(),a?.(),z()},B=async b=>{let{active:c,over:d}=b;if(!d||c.id===d.id)return;let g=t.findIndex(a=>a.id===c.id),h=t.findIndex(a=>a.id===d.id);if(-1===g||-1===h)return;let i=(0,ab.arrayMove)(t,g,h),j=[...e];i.forEach((a,b)=>{let c=j.findIndex(b=>b.id===a.id);-1!==c&&(j[c]={...j[c],sort_order:b})}),f(j);try{await Promise.all(i.map((a,b)=>fetch("/project-management/api/projects",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a.id,sort_order:b})}))),a?.()}catch(a){console.error("Error saving project order:",a),u()}};return k?(0,b.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,b.jsx)("div",{className:"animate-spin text-2xl",children:"âš™ï¸"})}):g?(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsxs)("button",{onClick:()=>{h(null)},className:"flex items-center gap-2 text-gray-400 hover:text-white mb-3 text-sm",children:[(0,b.jsx)(P.ArrowLeft,{className:"w-4 h-4"}),"All Projects"]}),(0,b.jsx)("div",{className:"mb-3 pb-3 border-b border-gray-700",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-white",children:g.name}),g.description&&(0,b.jsx)("p",{className:"text-gray-400 text-sm",children:g.description}),(0,b.jsxs)("div",{className:"flex items-center gap-3 mt-2 text-xs text-gray-500",children:[g.droplet_name&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(Q.Server,{className:"w-3 h-3"}),g.droplet_name]}),g.port_dev&&(0,b.jsxs)("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 rounded",children:["Dev: ",g.port_dev]})]})]}),(0,b.jsx)("button",{onClick:()=>y(g),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded",children:(0,b.jsx)(S.Settings,{className:"w-4 h-4"})})]})}),(0,b.jsx)($.default,{activeTab:i,onTabChange:j}),(0,b.jsx)("div",{className:"flex-1 overflow-auto mt-3",children:(()=>{if(!g)return null;let a=g.server_path||"";switch(i){case"todos":return(0,b.jsx)(ad.default,{projectPath:a,projectId:g.id});case"knowledge":return(0,b.jsx)(ak.default,{projectPath:a,projectId:g.id});case"docs":return(0,b.jsx)(ae.default,{projectPath:a,projectId:g.id});case"database":return(0,b.jsx)(af.default,{projectPath:a,projectId:g.id});case"structure":return(0,b.jsx)(ag.default,{projectPath:a,projectId:g.id});case"conventions":return(0,b.jsx)(aj.default,{projectPath:a,projectId:g.id});case"notepad":return(0,b.jsx)(ah.default,{projectPath:a,projectId:g.id});case"bugs":return(0,b.jsx)(ai.default,{projectPath:a,projectId:g.id});default:return null}})()}),m&&(0,b.jsx)(_.default,{project:o,onClose:z,onSave:A})]}):(0,b.jsxs)("div",{className:"flex flex-col h-full",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-gray-400 text-sm",children:[t.length," projects"]}),d&&(0,b.jsxs)("span",{className:"px-2 py-0.5 bg-blue-600/20 text-blue-400 rounded text-xs flex items-center gap-1",children:[(0,b.jsx)(Y.Building2,{className:"w-3 h-3"}),d.name]})]}),(0,b.jsxs)("button",{onClick:()=>{p(null),n(!0)},className:"flex items-center gap-1 px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm",children:[(0,b.jsx)(O.Plus,{className:"w-3 h-3"}),"Add"]})]}),0===t.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-4xl mb-2",children:"ðŸ“"}),(0,b.jsx)("p",{children:"No projects yet"})]}):(0,b.jsx)(aa.DndContext,{sensors:s,collisionDetection:aa.closestCenter,onDragEnd:B,children:(0,b.jsx)(ab.SortableContext,{items:t.map(a=>a.id),strategy:ab.verticalListSortingStrategy,children:(0,b.jsx)("div",{className:"flex-1 overflow-auto space-y-2",children:t.map(a=>(0,b.jsx)(al,{project:a,summary:q[a.id],formatTimeAgo:w,onSelect:x,onEdit:y},a.id))})})}),m&&(0,b.jsx)(_.default,{project:o,onClose:z,onSave:A})]})}let an=(0,q.default)("plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M17 8a1 1 0 0 1 1 1v4a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1z",key:"1xoxul"}],["path",{d:"M9 8V2",key:"14iosj"}]]),ao=(0,q.default)("plug-zap",[["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m18 3-4 4h6l-4 4",key:"16psg9"}]]),ap=(0,q.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),aq=[{id:"dev",name:"Dev Studio",portKey:"port_dev"},{id:"test",name:"Test",portKey:"port_test"},{id:"prod",name:"Production",portKey:"port_prod",readOnly:!0}],ar=[{id:"files",icon:"ðŸ“",label:"Files"},{id:"terminal",icon:"ðŸ’»",label:"Terminal"},{id:"ai-usage",icon:"ðŸ’°",label:"AI Usage"},{id:"browser",icon:"ðŸŒ",label:"Browser"},{id:"schema",icon:"ðŸ—„ï¸",label:"DB Schema"},{id:"chatlog",icon:"ðŸ“œ",label:"Chat Log"},{id:"hub",icon:"ðŸŽ¯",label:"Session Hub"},{id:"storage",icon:"ðŸ’¾",label:"Storage"},{id:"projects",icon:"âš™ï¸",label:"Projects"},{id:"docs",icon:"ðŸ“",label:"Docs"},{id:"health",icon:"ðŸ©º",label:"AI Health"}];function as(){let a=(0,c.useContext)(d.PageTitleContext),h=(0,c.useContext)(d.PageActionsContext),{selectedTeam:j,selectTeamById:k,connectionStatus:l,connect:m,disconnect:n}=(0,e.useDeveloper)(),{user:o}=(0,f.useUser)(),q=(0,f.useMinRole)("engineer"),[r,s]=(0,c.useState)("browser"),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(aq[0]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)({});return((0,c.useEffect)(()=>{async function a(){try{let a=await fetch("/api/dev-session/status"),b=await a.json();b.success&&b.lockedTeams&&D(b.lockedTeams)}catch(a){console.error("Failed to fetch locked teams:",a)}}a();let b=setInterval(a,1e4);return()=>clearInterval(b)},[]),(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/projects"),b=await a.json();b.success&&b.projects&&(u(b.projects),b.projects.length>0&&w(b.projects[0]))}catch(a){console.error("Failed to fetch projects:",a)}finally{B(!1)}}()},[]),(0,c.useEffect)(()=>(a({title:"Studio",description:"Development environment with Claude AI"}),h((0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("select",{value:v?.id||"",onChange:a=>{w(t.find(b=>b.id===a.target.value)||null)},className:"w-44 bg-gray-800/80 text-white text-sm px-3 py-1.5 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-white/30",disabled:A,children:A?(0,b.jsx)("option",{children:"Loading..."}):0===t.length?(0,b.jsx)("option",{children:"No projects"}):t.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))}),(0,b.jsx)("select",{value:x.id,onChange:a=>{let b=aq.find(b=>b.id===a.target.value);b&&y(b)},className:"w-44 bg-gray-800/80 text-white text-sm px-3 py-1.5 rounded-lg border border-gray-600 focus:outline-none focus:ring-2 focus:ring-white/30",children:aq.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))})]})),()=>{a({title:"",description:""}),h(null)}),[a,h,t,v,x,A]),q)?"connected"!==l?(0,b.jsx)("div",{className:"h-full flex items-center justify-center bg-gray-900",children:(0,b.jsx)("div",{className:"max-w-lg w-full mx-4",children:(0,b.jsxs)("div",{className:"bg-gray-800 rounded-2xl border border-gray-700 shadow-2xl overflow-hidden",children:[(0,b.jsxs)("div",{className:"p-6 text-center border-b border-gray-700",style:{background:"linear-gradient(to right, #3B82F6, #06B6D4)"},children:[(0,b.jsx)(ap,{className:"w-12 h-12 text-white mx-auto mb-3"}),(0,b.jsx)("h2",{className:"text-xl font-bold text-white",children:"Welcome to Studio"}),(0,b.jsx)("p",{className:"text-white/80 text-sm mt-1",children:"Select your dev team and connect to begin"})]}),(0,b.jsxs)("div",{className:"p-6 space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Select Development Team"}),(0,b.jsx)("div",{className:"space-y-2",children:e.DEVELOPER_TEAMS.map((a,c)=>{let d=C[a.id],e=d&&d.userId!==o?.id,f=d&&d.userId===o?.id;return(0,b.jsxs)("button",{onClick:()=>!e&&k(a.id),disabled:e,className:`w-full p-3 rounded-lg border text-left transition-all flex items-center justify-between ${e?"border-red-800/50 bg-red-900/20 cursor-not-allowed opacity-60":j.id===a.id?"border-cyan-500 bg-cyan-500/20":"border-gray-600 bg-gray-700/50 hover:border-gray-500"}`,children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold ${e?"bg-red-800/50 text-red-300":j.id===a.id?"bg-cyan-500 text-white":"bg-gray-600 text-gray-300"}`,children:e?(0,b.jsx)(g.Lock,{className:"w-4 h-4"}):c+1}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsxs)("span",{className:`font-medium ${e?"text-red-400":j.id===a.id?"text-cyan-400":"text-gray-300"}`,children:["Development Team ",c+1]}),e&&(0,b.jsxs)("span",{className:"text-xs text-red-400/70",children:["Locked by ",d.userName]})]})]}),e?(0,b.jsx)("span",{className:"text-red-400 text-xs",children:"In Use"}):f?(0,b.jsx)("span",{className:"text-green-400 text-xs",children:"Your Session"}):j.id===a.id?(0,b.jsx)("span",{className:"text-cyan-400 text-sm",children:"Selected"}):(0,b.jsx)("span",{className:"text-green-400 text-xs",children:"Available"})]},a.id)})})]}),(0,b.jsx)("button",{onClick:()=>o?.id&&m(o.id),disabled:!o?.id||"connecting"===l,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-blue-500 to-cyan-500 text-white font-medium rounded-lg hover:from-blue-600 hover:to-cyan-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"connecting"===l?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(an,{className:"w-5 h-5 animate-pulse"}),(0,b.jsx)("span",{children:"Connecting..."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ao,{className:"w-5 h-5"}),(0,b.jsxs)("span",{children:["Connect to Development Team ",j.id.replace("dev","")]})]})}),(0,b.jsxs)("p",{className:"text-center text-gray-500 text-xs",children:["Your session will be logged for ",o?.name||"your account"]})]})]})})}):(0,b.jsxs)("div",{className:"h-full flex bg-gray-900",children:[(0,b.jsx)("div",{className:"w-14 bg-gray-800 border-r border-gray-700 flex flex-col items-center py-2 flex-shrink-0",children:(0,b.jsx)(i,{items:ar,activePanel:r,onPanelChange:s})}),(0,b.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,b.jsx)("div",{className:"flex-1 flex flex-col border-r border-gray-700",children:"browser"===r?(0,b.jsx)(p,{project:v,env:x}):"hub"===r?(0,b.jsx)(H,{teamBasePort:j.basePort}):"projects"===r?(0,b.jsx)("div",{className:"flex-1 overflow-auto p-4",children:(0,b.jsx)(am,{})}):(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-600 text-sm",children:r?`${r} panel - coming soon`:"Select a panel from the sidebar"})}),(0,b.jsxs)("div",{className:"w-[400px] bg-gray-850 flex flex-col flex-shrink-0",children:[(0,b.jsxs)("div",{className:"h-10 flex items-center justify-between px-3",style:{background:"linear-gradient(to right, #3B82F6, #06B6D4)"},children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-sm font-medium text-white",children:"AI Team"}),(0,b.jsxs)("span",{className:"text-xs text-white/70",children:["(",j.portRange,")"]})]}),(0,b.jsxs)("button",{onClick:n,className:"flex items-center gap-2 px-3 py-1 bg-green-500/30 text-white border border-white/30 rounded-lg hover:bg-red-500/30 hover:border-red-400/50 transition-colors",children:[(0,b.jsx)(ao,{className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Connected"}),(0,b.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-400 animate-pulse"})]})]}),(0,b.jsx)("div",{className:"flex-1 min-h-0 flex flex-col",children:(0,b.jsx)(z,{port:j.basePort,projectPath:v?.server_path||"/var/www/Studio"})})]})]})]}):(0,b.jsx)("div",{className:"h-full flex items-center justify-center bg-gray-900",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(g.Lock,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,b.jsx)("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Restricted"}),(0,b.jsx)("p",{className:"text-gray-400",children:"Engineer+ access required for the Dev Studio Environment."})]})})}a.s(["default",()=>as],47408)}];

//# sourceMappingURL=Studio_kodiack-dashboard-5500_src_app_studio_page_tsx_0659159f._.js.map