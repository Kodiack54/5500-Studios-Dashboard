module.exports=[36e3,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(30836),e=a.i(84852),f=a.i(77236),g=a.i(20912);a.i(59539),a.i(32808),a.i(51679);let h=[{id:"global",name:"Global Team",workspace:"global"},{id:"dev1",name:"Dev Team 1",workspace:"dev1"},{id:"dev2",name:"Dev Team 2",workspace:"dev2"},{id:"dev3",name:"Dev Team 3",workspace:"dev3"}],i=["Bugs Open","Bugs Fixed","Todos","Journal","Work Log","Ideas","Decisions","Lessons","System Breakdown","How-To Guide","Schematic","Reference","Naming Conventions","File Structure","Database Patterns","API Patterns","Component Patterns","Quirks & Gotchas","Snippets","Other"];function j(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)({}),[j,r]=(0,c.useState)({}),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)({todos:0,bugs:0,knowledge:0,total:0}),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)({todos:0,bugs:0,knowledge:0,total:0}),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)({}),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),[O,P]=(0,c.useState)(null),[Q,R]=(0,c.useState)("healthy"),S=(0,c.useCallback)(async()=>{L(!0),P(null);try{let[a,b,c,d,f,i,j]=await Promise.all([fetch("/api/ai-sessions?limit=100",{cache:"no-store"}),fetch("/api/ai-sessions/buckets",{cache:"no-store"}),fetch("/api/ai-extractions",{cache:"no-store"}),fetch("/api/ai-extractions/by-project",{cache:"no-store"}),fetch("/api/ai-extractions/clair",{cache:"no-store"}),fetch("/project-management/api/projects",{cache:"no-store"}),fetch("/project-management/api/projects/summary",{cache:"no-store"})]);if(!a.ok||!b.ok)throw Error("Failed to fetch from database");let k=await a.json(),l=await b.json(),m=c.ok?await c.json():{success:!1},n=d.ok?await d.json():{success:!1},o=f.ok?await f.json():{success:!1},p=i.ok?await i.json():{success:!1},q=j.ok?await j.json():{success:!1};if(k.success){e(k.sessions||[]);let a=(k.sessions||[]).filter(a=>"transcript"===a.source_type);if(a.length>0){let b=a[0],c=new Date(b.started_at||0),d=(new Date().getTime()-c.getTime())/6e4;R(d<=18?"healthy":"missed")}else R("missed")}if(l.success&&(g(l.buckets||{}),H(l.stats||null)),m.success&&r(m.buckets||{}),n.success&&(v(n.projects||[]),x(n.totals||{todos:0,bugs:0,knowledge:0,total:0})),o.success&&(z(o.projects||[]),B(o.totals||{todos:0,bugs:0,knowledge:0,total:0})),p.success&&p.projects){let a=p.projects,b=q.success&&q.summaries||{},c={};for(let d of a){let a=b[d.id]||{};c[d.id]={id:d.id,name:d.name,slug:d.slug,server_path:d.server_path,parent_id:d.parent_id||null,todos:a.pending_todos||a.todos||0,knowledge:a.pending_knowledge||a.knowledge||0,bugs:a.pending_bugs||a.bugs||0,children:[]}}let d=[];for(let b of a){let e=c[b.id];if(!e.parent_id){let f=[],g=e.todos,h=e.knowledge,i=e.bugs;for(let d of a)if(d.parent_id===b.id){let a=c[d.id];f.push(a),g+=a.todos,h+=a.knowledge,i+=a.bugs}d.push({...e,todos:g,knowledge:h,bugs:i,children:f.sort((a,b)=>a.name.localeCompare(b.name))})}}d.sort((a,b)=>a.name.localeCompare(b.name)),t(d)}let s=h.map(async a=>{try{let b=await fetch(`/api/ai-sessions/buckets?workspace=${a.workspace}`,{cache:"no-store"});if(b.ok){let c=(await b.json()).stats||{};return{id:a.id,status:{captured:Number(c.active||0)+Number(c.captured||0),flagged:Number(c.flagged||0),filed:Number(c.pending||0)+Number(c.cleaned||0)+Number(c.archived||0)}}}}catch{}return{id:a.id,status:{captured:0,flagged:0,filed:0}}}),u=await Promise.all(s),w={};u.forEach(a=>{w[a.id]=a.status}),J(w),N(new Date)}catch(a){P(a instanceof Error?a.message:"Database connection failed")}finally{L(!1)}},[]);(0,c.useEffect)(()=>{let a=localStorage.getItem("session-logs-project-order");if(a)try{D(JSON.parse(a))}catch{}},[]),(0,c.useEffect)(()=>{C.length>0&&localStorage.setItem("session-logs-project-order",JSON.stringify(C))},[C]);let T=a=>{F(a)},U=(a,b)=>{if(a.preventDefault(),!E||E===b)return;let c=[...new Set([...u.map(a=>a.id),...y.map(a=>a.id)])],d=C.length>0?C:c,e=d.indexOf(E),f=d.indexOf(b);if(-1===e||-1===f)return;let g=[...d];g.splice(e,1),g.splice(f,0,E),D(g)},V=()=>{F(null)},W=a=>0===C.length?a:[...a].sort((a,b)=>{let c=C.indexOf(a.id),d=C.indexOf(b.id);return -1===c&&-1===d?0:-1===c?1:-1===d?-1:c-d});(0,c.useEffect)(()=>{S()},[]),(0,c.useEffect)(()=>{let a=setInterval(S,5e3);return()=>clearInterval(a)},[S]);let X={active:Number(G?.active||f.active||0),processed:Number(G?.scrubbed||f.processed||f.pending_review||0),flagged:Number(G?.flagged||f.flagged||0),pending:Number(G?.pending||f.pending||0),published:Number(f.published||f.cataloged||0),cleaned:Number(G?.cleaned||f.cleaned||0),archived:Number(G?.archived||f.archived||0),total:Number(G?.total_sessions||Object.values(f).reduce((a,b)=>a+Number(b),0)),last24h:Number(G?.last_24h||0)},Y=O?"down":"healthy";return(0,b.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 text-white overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 bg-gray-800 border-b border-gray-700 flex items-center justify-between shrink-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-xl font-bold",children:"Session Logs"}),(0,b.jsx)("span",{className:"text-sm text-gray-400",children:"Database View"}),(0,b.jsx)(q,{health:Y})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[M&&(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:["Last updated: ",M.toLocaleTimeString()]}),(0,b.jsxs)("button",{onClick:S,disabled:K,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-700 text-white text-sm rounded-lg transition-colors",children:[(0,b.jsx)(d.RefreshCw,{className:`w-4 h-4 ${K?"animate-spin":""}`}),"Refresh"]})]})]}),O&&(0,b.jsxs)("div",{className:"px-6 py-2 bg-red-900/50 border-b border-red-700 text-red-300 text-sm",children:["Database Error: ",O]}),(0,b.jsx)("div",{className:"p-4 bg-gray-850 border-b border-gray-700 shrink-0",children:(0,b.jsx)("div",{className:"grid grid-cols-4 gap-4",children:h.map(a=>{let c=I[a.id]||{captured:0,flagged:0,filed:0};return(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-gray-700 bg-gray-800/50",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,b.jsx)("span",{className:"font-medium text-white",children:a.name})}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-400",children:c.captured}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:"Captured"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-purple-400",children:c.flagged}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:"Flagged"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-lg font-bold text-green-400",children:c.filed}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:"Filed"})]})]})]},a.id)})})}),(0,b.jsxs)("div",{className:"flex border-b border-gray-700 shrink-0",children:[(0,b.jsxs)("div",{className:"flex-[3] px-4 py-3 bg-gray-800/50 border-r border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center justify-around",children:[(0,b.jsx)(l,{label:"Active",value:X.active,color:"cyan"}),(0,b.jsx)(k,{}),(0,b.jsx)(l,{label:"Processed",value:X.processed,color:"blue"}),(0,b.jsx)(k,{}),(0,b.jsx)(l,{label:"Extracted",value:X.flagged,color:"purple"}),(0,b.jsx)(k,{}),(0,b.jsx)(l,{label:"Pending",value:X.pending,color:"yellow"}),(0,b.jsx)(k,{}),(0,b.jsx)(l,{label:"Cleaned",value:X.cleaned,color:"teal"}),(0,b.jsx)(k,{}),(0,b.jsx)(l,{label:"Archived",value:X.archived,color:"green"})]}),(0,b.jsxs)("div",{className:"text-center mt-2 text-xs text-gray-500",children:[X.total," total sessions | ",X.last24h," in last 24h"]})]}),(0,b.jsx)("div",{className:"flex-1 px-3 py-2 bg-gray-800/50",children:(0,b.jsx)("div",{className:"space-y-0.5",children:["active","processed","cleaned","archived"].map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-gray-400 capitalize",children:a}),(0,b.jsx)("span",{className:"font-mono font-bold text-white",children:f[a]||0})]},a))})})]}),(0,b.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,b.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,b.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Chad's Sessions (",a.length,")"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-2.5 h-2.5 rounded-full ${"healthy"===Q?"bg-green-500":"bg-red-500 animate-pulse"}`,title:"healthy"===Q?"Chad: Capturing every 15 min":"Chad: MISSED 15-min capture!"}),(0,b.jsx)("span",{className:"text-xs text-gray-500",children:"Chad"})]})]})}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:0===a.length?(0,b.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,b.jsx)("div",{className:"text-3xl mb-2",children:"ðŸ“­"}),(0,b.jsx)("p",{children:"No sessions in database"})]}):a.map(a=>(0,b.jsx)(m,{session:a},a.id))})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,b.jsx)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:(0,b.jsx)("h2",{className:"text-sm font-medium text-gray-300",children:"Jen's Extractions"})}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-3",children:(0,b.jsx)("div",{className:"space-y-1",children:i.map(a=>(0,b.jsx)(p,{name:a,count:j[a]||0},a))})})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col border-r border-gray-700 min-w-0",children:[(0,b.jsxs)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:[(0,b.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Susan's Filing (",w.total,")"]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-1 text-[10px]",children:[(0,b.jsxs)("span",{className:"text-blue-400",children:["Todos ",w.todos]}),(0,b.jsxs)("span",{className:"text-red-400",children:["Bugs ",w.bugs]}),(0,b.jsxs)("span",{className:"text-green-400",children:["Knowledge ",w.knowledge]})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-2",children:(0,b.jsx)("div",{className:"space-y-1",children:0===u.length?(0,b.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs",children:"No items filed"}):W(u).map(a=>(0,b.jsx)(n,{project:a,isDragging:E===a.id,onDragStart:()=>T(a.id),onDragOver:b=>U(b,a.id),onDragEnd:V},a.id))})})]}),(0,b.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,b.jsxs)("div",{className:"px-4 py-2 bg-gray-800/50 border-b border-gray-700 shrink-0",children:[(0,b.jsxs)("h2",{className:"text-sm font-medium text-gray-300",children:["Clair's Published (",A.total,")"]}),(0,b.jsxs)("div",{className:"flex gap-3 mt-1 text-[10px]",children:[(0,b.jsxs)("span",{className:"text-blue-400",children:["Todos ",A.todos]}),(0,b.jsxs)("span",{className:"text-red-400",children:["Bugs ",A.bugs]}),(0,b.jsxs)("span",{className:"text-green-400",children:["Knowledge ",A.knowledge]})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto p-2",children:(0,b.jsx)("div",{className:"space-y-1",children:0===y.length?(0,b.jsx)("div",{className:"text-center py-4 text-gray-500 text-xs",children:"No items published"}):W(y).map(a=>(0,b.jsx)(o,{project:a,isDragging:E===a.id,onDragStart:()=>T(a.id),onDragOver:b=>U(b,a.id),onDragEnd:V},a.id))})})]})]})]})}function k(){return(0,b.jsx)("span",{className:"text-gray-600 text-xs",children:"â†’"})}function l({label:a,value:c,color:d}){return(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:`text-xl font-bold ${{cyan:"text-cyan-400",blue:"text-blue-400",indigo:"text-indigo-400",purple:"text-purple-400",yellow:"text-yellow-400",teal:"text-teal-400",green:"text-green-400"}[d]||"text-gray-400"}`,children:c}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500",children:a})]})}function m({session:a}){let c=a.started_at?function(a){let b=new Date(a),c=new Date,d=new Date(c);d.setDate(d.getDate()-1);let e=b.toDateString()===c.toDateString(),f=b.toDateString()===d.toDateString(),g=b.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});if(e)return`Today ${g}`;{if(f)return`Yesterday ${g}`;let a=b.toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${a} ${g}`}}(a.started_at):"??:??",d=(()=>{if("internal_claude"===a.source_type){let b=a.terminal_port;return 5400===b?"Internal Claude (Main)":5410===b?"Internal Claude (Dev Team 1)":5420===b?"Internal Claude (Dev Team 2)":5430===b?"Internal Claude (Dev Team 3)":"Internal Claude"}return"external"===a.source_type?"External Claude":"chat_systems"===a.source_type?"Chat Systems":a.source_name&&a.source_name.trim()?a.source_name:a.user_name&&a.user_name.trim()?a.user_name:a.user_id&&!a.user_id.includes("-")?a.user_id:"Unknown"})(),e={active:"bg-cyan-900/50 text-cyan-400",processed:"bg-blue-900/50 text-blue-400",published:"bg-indigo-900/50 text-indigo-400",flagged:"bg-purple-900/50 text-purple-400",pending:"bg-yellow-900/50 text-yellow-400",cleaned:"bg-teal-900/50 text-teal-400",archived:"bg-gray-900/50 text-gray-400"};return(0,b.jsxs)("div",{className:"p-2 rounded border border-gray-700 bg-gray-800/50 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium text-white truncate",children:d}),(0,b.jsx)("span",{className:"text-[10px] text-gray-500 font-mono shrink-0 ml-2",children:c})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,b.jsx)("span",{className:"text-xs text-gray-500 truncate",children:a.project_path||a.source_name||"Unknown"}),(0,b.jsx)("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${e[a.status||"captured"]||e.captured}`,children:a.status||"captured"})]})]})}function n({project:a,isDragging:c,onDragStart:d,onDragOver:e,onDragEnd:f}){return(0,b.jsxs)("div",{draggable:!0,onDragStart:d,onDragOver:e,onDragEnd:f,className:`py-1.5 px-2 rounded bg-gray-800/30 text-xs cursor-grab active:cursor-grabbing ${c?"opacity-50 border border-blue-500":""}`,children:[(0,b.jsx)("div",{className:`font-medium truncate ${a.total>0?"text-white":"text-gray-500"}`,children:a.name}),(0,b.jsxs)("div",{className:"flex gap-3 mt-0.5 text-[10px]",children:[(0,b.jsxs)("span",{className:a.todos>0?"text-blue-400":"text-gray-600",children:["Todos ",a.todos]}),(0,b.jsxs)("span",{className:a.bugs>0?"text-red-400":"text-gray-600",children:["Bugs ",a.bugs]}),(0,b.jsxs)("span",{className:a.knowledge>0?"text-green-400":"text-gray-600",children:["Knowledge ",a.knowledge]})]})]})}function o({project:a,isDragging:c,onDragStart:d,onDragOver:e,onDragEnd:f}){return(0,b.jsxs)("div",{draggable:!0,onDragStart:d,onDragOver:e,onDragEnd:f,className:`py-1.5 px-2 rounded bg-gray-800/30 text-xs cursor-grab active:cursor-grabbing ${c?"opacity-50 border border-blue-500":""}`,children:[(0,b.jsx)("div",{className:`font-medium truncate ${a.total>0?"text-white":"text-gray-500"}`,children:a.name}),(0,b.jsxs)("div",{className:"flex gap-3 mt-0.5 text-[10px]",children:[(0,b.jsxs)("span",{className:a.todos>0?"text-blue-400":"text-gray-600",children:["Todos ",a.todos]}),(0,b.jsxs)("span",{className:a.bugs>0?"text-red-400":"text-gray-600",children:["Bugs ",a.bugs]}),(0,b.jsxs)("span",{className:a.knowledge>0?"text-green-400":"text-gray-600",children:["Knowledge ",a.knowledge]})]})]})}function p({name:a,count:c}){return(0,b.jsxs)("div",{className:`flex items-center justify-between py-1.5 px-2 rounded ${{active:"bg-cyan-900/20",processed:"bg-blue-900/20",published:"bg-indigo-900/20",flagged:"bg-purple-900/20",pending:"bg-yellow-900/20",cleaned:"bg-teal-900/20",archived:"bg-gray-800/30"}[a]||"bg-gray-800/30"}`,children:[(0,b.jsx)("span",{className:`text-sm truncate ${c>0?"text-white":"text-gray-500"}`,children:a}),(0,b.jsx)("span",{className:`font-mono font-bold min-w-[24px] text-right ${c>0?"text-white":"text-gray-600"}`,children:c})]})}function q({health:a}){let c={healthy:{bg:"bg-green-600/20",text:"text-green-400",icon:f.CheckCircle,label:"Connected"},degraded:{bg:"bg-yellow-600/20",text:"text-yellow-400",icon:e.AlertTriangle,label:"Degraded"},down:{bg:"bg-red-600/20",text:"text-red-400",icon:g.XCircle,label:"Disconnected"}}[a],d=c.icon;return(0,b.jsxs)("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded ${c.bg}`,children:[(0,b.jsx)(d,{className:`w-3.5 h-3.5 ${c.text}`}),(0,b.jsx)("span",{className:`text-xs font-medium ${c.text}`,children:c.label})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=Studio_kodiack-dashboard-5500_src_app_session-logs_page_tsx_39967913._.js.map