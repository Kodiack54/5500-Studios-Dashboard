module.exports=[61272,a=>{"use strict";var b=a.i(18030),c=a.i(30072),d=a.i(38270);let e=[{name:"SOW",offset:100},{name:"Docs",offset:200},{name:"Proposal",offset:300}];function f({name:a,displayName:c,port:d,status:f,online:g,total:h,processes:i,storageBytes:j=0,isSelected:k,onClick:l}){let m,n=i.find(a=>a.name.includes("-main")),o=n?.status==="online",p=e.map((a,b)=>{let c=i.find(c=>c.name.includes(`-w${b+2}`)||c.name.includes(a.name.toLowerCase()));return{...a,port:d+a.offset,online:c?.status==="online",cpu:c?.cpu||0,memory:c?.memory||0}}),q=i.reduce((a,b)=>a+(b.cpu||0),0),r=i.reduce((a,b)=>a+(b.memory||0),0),s=i.length>0?q/i.length:0,t=r/1048576,u={healthy:"border-green-500 bg-green-500/10",partial:"border-yellow-500 bg-yellow-500/10",stopped:"border-red-500 bg-red-500/10",degraded:"border-orange-500 bg-orange-500/10"};return(0,b.jsxs)("div",{onClick:l,className:`flex items-center gap-4 px-4 py-3 cursor-pointer border-l-4 transition-all ${u[f]||u.stopped} ${k?"ring-2 ring-blue-500 bg-blue-500/20":"hover:bg-gray-700/50"}`,children:[(0,b.jsxs)("div",{className:"w-32 flex-shrink-0",children:[(0,b.jsx)("div",{className:"font-mono text-sm text-white font-bold",children:d}),(0,b.jsx)("div",{className:"text-xs text-gray-400 truncate",children:c})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-shrink-0",children:[(0,b.jsx)("div",{className:`w-3 h-3 rounded-full ${o?"bg-green-500":"bg-red-500"}`,title:`Main: ${o?"Online":"Offline"}`}),p.map(a=>(0,b.jsx)("div",{className:`w-3 h-3 rounded-full ${a.online?"bg-green-500":"bg-red-500"}`,title:`${a.name}: ${a.online?"Online":"Offline"}`},a.name))]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"CPU"}),(0,b.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,b.jsx)("div",{className:`h-full transition-all ${s>80?"bg-red-500":s>50?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(s,100)}%`}})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"MEM"}),(0,b.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,b.jsx)("div",{className:`h-full transition-all ${t>400?"bg-red-500":t>200?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(t/512*100,100)}%`}})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"NET"}),(0,b.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(0,b.jsx)("div",{className:"h-full bg-cyan-500",style:{width:"25%"}})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-1 max-w-20",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 w-7",children:"DISK"}),(0,b.jsx)("div",{className:"flex-1 h-2 bg-gray-700 rounded overflow-hidden",children:(m=j/0x200000000*100,(0,b.jsx)("div",{className:`h-full ${m>90?"bg-red-500":m>75?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(m,100)}%`}}))})]})]}),(0,b.jsx)("div",{className:"flex-shrink-0 w-10 text-center",children:"healthy"===f?(0,b.jsx)("span",{className:"text-green-400 text-lg",children:"✓"}):"partial"===f?(0,b.jsxs)("span",{className:"text-yellow-400 text-sm",children:[g,"/",h]}):(0,b.jsx)("span",{className:"text-red-400 text-lg",children:"✗"})}),(0,b.jsx)("a",{href:`/api/engine-redirect?port=${d}`,target:"_blank",rel:"noopener noreferrer",onClick:a=>a.stopPropagation(),className:`flex-shrink-0 px-4 py-1.5 text-sm font-medium rounded transition-colors ${o?"bg-green-600 hover:bg-green-500 text-white":"bg-gray-600 hover:bg-gray-500 text-gray-300"}`,children:"Online"})]})}function g({tradeline:a,displayName:d,port:e}){var f;let[g,i]=(0,c.useState)(null),[j,k]=(0,c.useState)(!0),[l,m]=(0,c.useState)(null);(0,c.useEffect)(()=>{n(!0)},[a]),(0,c.useEffect)(()=>{let a=setInterval(n,1e4);return()=>clearInterval(a)},[a]);let n=async(b=!1)=>{b&&k(!0),m(null);try{let b=await fetch(`/api/tradelines/status/${a}`),c=await b.json();if(!1!==c.success){let a=c.processes||[],b=a.filter(a=>"online"===a.status).length,d=a.reduce((a,b)=>a+(b.memory||0),0),e=a.length>0?a.reduce((a,b)=>a+(b.cpu||0),0)/a.length:0,f=a.find(a=>a.name?.includes("-main")),g=f?.uptime?Math.floor((Date.now()-f.uptime)/1e3):void 0,h="stopped";b===a.length&&a.length>0?h="online":b>0&&(h="partial"),i({status:h,uptime:g,memory:d,cpu:e,processes:a.map(a=>({name:a.name,status:a.status,cpu:a.cpu||0,memory:a.memory||0}))})}else m(c.error||"Failed to fetch status")}catch(a){m(a.message)}finally{k(!1)}};return j?(0,b.jsxs)("div",{className:"p-4 h-full flex flex-col",children:[(0,b.jsx)("div",{className:"flex items-start justify-between h-14 flex-shrink-0",children:(0,b.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:d}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",e," | ",a]})]})}),(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500 text-sm",children:"Loading stats..."})]}):l?(0,b.jsxs)("div",{className:"p-4 h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between h-14 flex-shrink-0 mb-4",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:d}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",e," | ",a]})]}),(0,b.jsx)("button",{onClick:()=>n(!0),className:"px-3 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors flex-shrink-0",children:"Retry"})]}),(0,b.jsx)("div",{className:"text-xs text-red-400 bg-red-500/10 px-3 py-2 rounded",children:l})]}):(0,b.jsxs)("div",{className:"p-4 space-y-4 h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between h-14 flex-shrink-0",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0 pr-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-white leading-tight line-clamp-2",children:d}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:["Port ",e," | ",a]})]}),(0,b.jsx)("button",{onClick:()=>n(),className:"px-3 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors flex-shrink-0",children:"Refresh"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(h,{label:"Status",value:g?.status||"-",color:g?.status==="online"?"green":g?.status==="stopped"?"red":"gray"}),(0,b.jsx)(h,{label:"Uptime",value:(a=>{if(!a)return"-";let b=Math.floor(a/3600),c=Math.floor(a%3600/60);return`${b}h ${c}m`})(g?.uptime),color:"cyan"}),(0,b.jsx)(h,{label:"Memory",value:(f=g?.memory)?`${Math.round(f/1048576)} MB`:"-",color:"blue"}),(0,b.jsx)(h,{label:"CPU",value:g?.cpu!==void 0?`${g.cpu.toFixed(1)}%`:"-",color:g?.cpu&&g.cpu>80?"red":g?.cpu&&g.cpu>50?"yellow":"green"})]}),g?.processes&&g.processes.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3",children:[(0,b.jsx)("h4",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Processes"}),(0,b.jsx)("div",{className:"space-y-1.5",children:g.processes.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-300 font-mono text-xs",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[a.cpu.toFixed(1),"% CPU"]}),(0,b.jsxs)("span",{className:"text-xs text-gray-500",children:[Math.round(a.memory/1048576),"MB"]}),(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${"online"===a.status?"bg-green-500":"bg-red-500"}`})]})]},a.name))})]}),(g?.opportunities_found!==void 0||g?.documents_scraped!==void 0)&&(0,b.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-3 space-y-2",children:[void 0!==g.opportunities_found&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Opportunities"}),(0,b.jsx)("span",{className:"text-white",children:g.opportunities_found.toLocaleString()})]}),void 0!==g.documents_scraped&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Documents"}),(0,b.jsx)("span",{className:"text-white",children:g.documents_scraped.toLocaleString()})]}),g.last_run&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Last Run"}),(0,b.jsx)("span",{className:"text-white",children:new Date(g.last_run).toLocaleTimeString()})]}),g.version&&(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-500",children:"Version"}),(0,b.jsx)("span",{className:"text-white font-mono",children:g.version})]})]})]})}function h({label:a,value:c,color:d}){return(0,b.jsxs)("div",{className:`border rounded-lg p-3 ${{blue:"border-blue-500/30 bg-blue-500/10",green:"border-green-500/30 bg-green-500/10",red:"border-red-500/30 bg-red-500/10",yellow:"border-yellow-500/30 bg-yellow-500/10",cyan:"border-cyan-500/30 bg-cyan-500/10",gray:"border-gray-500/30 bg-gray-500/10"}[d]}`,children:[(0,b.jsx)("div",{className:`text-xl font-bold ${{blue:"text-blue-400",green:"text-green-400",red:"text-red-400",yellow:"text-yellow-400",cyan:"text-cyan-400",gray:"text-gray-400"}[d]}`,children:c}),(0,b.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide",children:a})]})}let i={"SAM.gov":"Federal","Cal-e-Procure":"State",PlanetBids:"Local",PublicPurchase:"Municipal",BidNet:"Regional"},j={discovery:"Stage 1",scraping:"Stage 2",analysis:"Stage 3",storage:"Stage 4"};function k({tradeline:a}){let[d,e]=(0,c.useState)(null),[f,g]=(0,c.useState)(!0),[h,k]=(0,c.useState)(null),l=async(b=!1)=>{b&&g(!0);try{let b=await fetch(`/api/tradelines/stats/${a}`),c=await b.json();c.success?(e(c),k(null)):k(c.error||"Failed to fetch stats")}catch(a){k(a.message)}finally{g(!1)}};return((0,c.useEffect)(()=>{l(!0)},[a]),(0,c.useEffect)(()=>{let a=setInterval(()=>l(),3e4);return()=>clearInterval(a)},[a]),f)?(0,b.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm",children:"Loading stats..."}):h||!d?(0,b.jsxs)("div",{className:"p-4",children:[(0,b.jsx)("div",{className:"text-xs text-gray-500 uppercase tracking-wide mb-2",children:"Today's Stats"}),(0,b.jsx)("div",{className:"text-gray-600 text-sm",children:"No data available"})]}):(0,b.jsxs)("div",{className:"h-full overflow-y-auto",children:[(0,b.jsx)("div",{className:"bg-black/30 px-4 py-2 border-b border-gray-700 sticky top-0",children:(0,b.jsx)("h3",{className:"text-xs uppercase text-gray-500 font-medium tracking-wide",children:"Today's Stats"})}),(0,b.jsxs)("div",{className:"p-3 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{className:"bg-gray-700/30 rounded p-2",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-cyan-400",children:d.today.opportunities}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500 uppercase",children:"Ops Today"})]}),(0,b.jsxs)("div",{className:"bg-gray-700/30 rounded p-2",children:[(0,b.jsx)("div",{className:"text-lg font-bold text-blue-400",children:d.today.documents}),(0,b.jsx)("div",{className:"text-[10px] text-gray-500 uppercase",children:"Docs Today"})]})]}),(0,b.jsx)("div",{className:"bg-gray-700/30 rounded p-2",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 uppercase",children:"AI Cost Today"}),(0,b.jsxs)("span",{className:"text-sm font-mono text-green-400",children:["$",d.today.aiCost.toFixed(2)]})]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"By Source"}),(0,b.jsx)("div",{className:"space-y-1",children:Object.entries(d.today.bySource).map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-gray-400",children:i[a]||a}),(0,b.jsx)("span",{className:"text-white font-mono",children:c})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"By Stage"}),(0,b.jsx)("div",{className:"grid grid-cols-4 gap-1",children:Object.entries(d.today.byStage).map(([a,c])=>(0,b.jsxs)("div",{className:"bg-gray-700/50 rounded p-1.5 text-center",children:[(0,b.jsx)("div",{className:"text-sm font-bold text-white",children:c}),(0,b.jsx)("div",{className:"text-[9px] text-gray-500",children:j[a]||a})]},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,b.jsx)("span",{className:"text-[10px] text-gray-500 uppercase",children:"Storage"}),(0,b.jsxs)("span",{className:"text-[10px] text-gray-400",children:[d.storage.usedFormatted," / ",d.storage.limitFormatted]})]}),(0,b.jsx)("div",{className:"h-2 bg-gray-700 rounded overflow-hidden",children:(0,b.jsx)("div",{className:`h-full transition-all ${d.storage.percent>90?"bg-red-500":d.storage.percent>75?"bg-yellow-500":"bg-cyan-500"}`,style:{width:`${Math.min(d.storage.percent,100)}%`}})}),(0,b.jsxs)("div",{className:"text-[10px] text-gray-500 mt-0.5 text-right",children:[d.storage.percent,"% used"]})]}),(0,b.jsxs)("div",{className:"border-t border-gray-700 pt-3",children:[(0,b.jsx)("div",{className:"text-[10px] text-gray-500 uppercase mb-1.5",children:"All Time"}),(0,b.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total Ops"}),(0,b.jsx)("span",{className:"text-white font-mono",children:d.totals.opportunities.toLocaleString()})]}),(0,b.jsxs)("div",{className:"flex justify-between text-xs mt-1",children:[(0,b.jsx)("span",{className:"text-gray-400",children:"Total Docs"}),(0,b.jsx)("span",{className:"text-white font-mono",children:d.totals.documents.toLocaleString()})]})]})]})]})}function l({tradeline:a,activeWorker:d}){let[e,f]=(0,c.useState)({main:[],w1:[],w2:[],w3:[],w4:[]}),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!1),m=(0,c.useRef)(null),n=async()=>{try{let b=await fetch(`/api/tradelines/logs/${a}?lines=50&workers=all`),c=await b.json();if(c.success&&c.workers){let a={main:o(c.workers.main?.logs||""),w1:o(c.workers.w1?.logs||""),w2:o(c.workers.w2?.logs||""),w3:o(c.workers.w3?.logs||""),w4:o(c.workers.w4?.logs||"")};f(a),j(null)}else j(c.error||"Failed to fetch logs")}catch(a){j(a.message)}finally{h(!1)}},o=a=>a?a.replace(/\u001b\[[0-9;]*m/g,"").split("\n").filter(Boolean).map((a,b)=>{let c=a.match(/\[([^\]]+)\]\s*\[(\w+)\]\s*(.+)/);if(c){let a,[,d,e,f]=c,[g,h]=f.split(" | ");if(h)try{let b=JSON.parse(h);a=b.module||b.source}catch{}return{id:`${b}-${d}`,timestamp:d,level:e.toLowerCase(),message:g.trim(),source:a}}return{id:`${b}-${Date.now()}`,timestamp:new Date().toISOString(),level:"info",message:a}}):[];(0,c.useEffect)(()=>{h(!0),f({main:[],w1:[],w2:[],w3:[],w4:[]}),n()},[a]),(0,c.useEffect)(()=>{if(k)return;let a=setInterval(n,5e3);return()=>clearInterval(a)},[a,k]),(0,c.useEffect)(()=>{!k&&m.current&&(m.current.scrollTop=m.current.scrollHeight)},[e,d,k]);let p={info:"bg-blue-500/20 text-blue-400",warn:"bg-yellow-500/20 text-yellow-400",error:"bg-red-500/20 text-red-400",debug:"bg-gray-500/20 text-gray-400"},q=e[d];return(0,b.jsxs)("div",{className:"h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-700 bg-gray-800/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-2 h-2 rounded-full ${!i?"bg-green-500 animate-pulse":"bg-red-500"}`}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:i?"Error":"Live (5s)"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{onClick:()=>l(!k),className:`px-2 py-1 text-xs rounded transition-colors ${k?"bg-green-500/20 text-green-400 hover:bg-green-500/30":"bg-yellow-500/20 text-yellow-400 hover:bg-yellow-500/30"}`,children:k?"Resume":"Pause"}),(0,b.jsx)("button",{onClick:n,className:"px-2 py-1 text-xs bg-gray-700 text-gray-400 rounded hover:bg-gray-600 hover:text-white transition-colors",children:"Refresh"})]})]}),(0,b.jsx)("div",{ref:m,className:"flex-1 overflow-y-auto p-2 font-mono text-xs space-y-1 bg-gray-900/50",children:g?(0,b.jsx)("div",{className:"text-gray-500 text-center py-8",children:"Loading logs..."}):i?(0,b.jsxs)("div",{className:"text-red-400 text-center py-8",children:["Error: ",i]}):0===q.length?(0,b.jsx)("div",{className:"text-gray-500 text-center py-8",children:"No logs available"}):q.map(a=>(0,b.jsxs)("div",{className:"flex items-start gap-2 py-0.5 hover:bg-gray-800/50 px-1 rounded",children:[(0,b.jsx)("span",{className:"text-gray-600 flex-shrink-0",children:(a=>{try{return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return a}})(a.timestamp)}),(0,b.jsx)("span",{className:`px-1.5 py-0.5 rounded text-[10px] uppercase flex-shrink-0 ${p[a.level]||p.info}`,children:a.level}),a.source&&(0,b.jsxs)("span",{className:"text-purple-400 flex-shrink-0",children:["[",a.source,"]"]}),(0,b.jsx)("span",{className:"text-gray-300",children:a.message})]},a.id))})]})}function m({tradeline:a,port:d}){let[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)([]),[i,j]=(0,c.useState)(-1),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(!1),o=(0,c.useRef)(null),p=(0,c.useRef)(null);(0,c.useEffect)(()=>{h([{command:"",output:`Connected to ${a} (port ${d})
Type 'help' for available commands.
─────────────────────────────────────`,timestamp:new Date}])},[a,d]),(0,c.useEffect)(()=>{p.current&&(p.current.scrollTop=p.current.scrollHeight)},[g]);let q=(a,b,c=!1)=>{h(d=>[...d,{command:a,output:b,timestamp:new Date,isError:c}])},r=async b=>{let c=b.trim().toLowerCase(),e=b.trim();if(c){if(l(a=>[...a.filter(a=>a!==c),c].slice(-50)),j(-1),"help"===c)return void q(e,`Available commands:
  status     - Get server status from API
  logs       - Fetch recent logs
  restart    - Restart server (requires --confirm)
  stop       - Stop server (requires --confirm)
  start      - Start server
  clear      - Clear terminal
  health     - Check server health

Raw SSH commands (executed on engine server):
  pm2 list              - List all PM2 processes
  pm2 show <name>       - Show process details
  pm2 restart <name>    - Restart specific process
  pm2 logs <name>       - Stream process logs
  tail -n 50 <file>     - Read last 50 lines of file
  ls, pwd, uptime       - System commands`);if("clear"===c)return void h([]);n(!0);try{if("status"===c){let b=await fetch(`/api/tradelines/status/${a}`),c=await b.json();if(!1!==c.success){let b=c.processes?.map(a=>`  ${a.name}: ${a.status} (CPU: ${a.cpu?.toFixed(1)}%, Mem: ${Math.round((a.memory||0)/1024/1024)}MB)`).join("\n")||"";q(e,`Server Status: ${a}
────────────────────────
Status: ${c.status||"unknown"}
Port: ${d}
${b?`Processes:
${b}`:""}`)}else q(e,c.error||"Failed to get status",!0)}else if("logs"===c){let b=await fetch(`/api/tradelines/logs/${a}?lines=20`),c=await b.json();c.success&&c.logs?q(e,`Recent Logs:
────────────────────────
${c.logs}`):q(e,c.error||"Failed to fetch logs",!0)}else if("health"===c){let b=await fetch(`/api/servers/health?projectId=tradelines&slotId=${a}`),c=await b.json();q(e,`Health Check:
────────────────────────
${JSON.stringify(c,null,2)}`)}else if("restart --confirm"===c){let b=await fetch(`/api/tradelines/restart/${a}`,{method:"POST"}),c=await b.json();c.success?q(e,`✓ Restart command sent to ${a}`):q(e,c.error||"Restart failed",!0)}else if("restart"===c)q(e,`⚠️  This will restart ${a}.
Type 'restart --confirm' to proceed.`);else if("stop --confirm"===c){let b=await fetch(`/api/tradelines/stop/${a}`,{method:"POST"}),c=await b.json();c.success?q(e,`✓ Stop command sent to ${a}`):q(e,c.error||"Stop failed",!0)}else if("stop"===c)q(e,`⚠️  This will stop ${a}.
Type 'stop --confirm' to proceed.`);else if("start"===c){let b=await fetch(`/api/tradelines/start/${a}`,{method:"POST"}),c=await b.json();c.success?q(e,`✓ Start command sent to ${a}`):q(e,c.error||"Start failed",!0)}else{let b=await fetch(`/api/tradelines/exec/${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e})}),c=await b.json();if(c.success){let a=c.stdout||c.stderr||"Command executed (no output)";q(e,a,!!c.stderr&&!c.stdout)}else q(e,c.error||"Command failed",!0)}}catch(a){q(e,`Error: ${a.message}`,!0)}finally{n(!1)}}};return(0,b.jsxs)("div",{className:"h-full flex flex-col bg-gray-900 font-mono text-sm cursor-text",onClick:()=>{o.current?.focus()},children:[(0,b.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 bg-gray-800 border-b border-gray-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("div",{className:"flex gap-1.5",children:[(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-red-500"}),(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),(0,b.jsx)("div",{className:"w-3 h-3 rounded-full bg-green-500"})]}),(0,b.jsxs)("span",{className:"text-xs text-gray-400 ml-2",children:[a,"@nextbid:~"]})]}),(0,b.jsxs)("span",{className:"text-xs text-gray-600",children:["port ",d]})]}),(0,b.jsxs)("div",{ref:p,className:"flex-1 overflow-y-auto p-3 space-y-2",children:[g.map((a,c)=>(0,b.jsxs)("div",{children:[a.command&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-green-400",children:"$"}),(0,b.jsx)("span",{className:"text-white",children:a.command})]}),(0,b.jsx)("pre",{className:`whitespace-pre-wrap text-xs leading-relaxed ${a.isError?"text-red-400":"text-gray-400"}`,children:a.output})]},c)),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-green-400",children:"$"}),(0,b.jsx)("input",{ref:o,type:"text",value:e,onChange:a=>f(a.target.value),onKeyDown:a=>{if("Enter"!==a.key||m){if("ArrowUp"===a.key){if(a.preventDefault(),k.length>0){let a=i<k.length-1?i+1:i;j(a),f(k[k.length-1-a]||"")}}else if("ArrowDown"===a.key)if(a.preventDefault(),i>0){let a=i-1;j(a),f(k[k.length-1-a]||"")}else j(-1),f("");else if("Tab"===a.key){a.preventDefault();let b=["status","logs","health","restart","stop","start","clear","help","pm2 list","pm2 status","pm2 show","pm2 restart","pm2 logs","pm2 stop","tail","ls","pwd","uptime","df -h","free -h"].filter(a=>a.startsWith(e.toLowerCase()));1===b.length?f(b[0]):b.length>1&&b.length<=5&&q(e,`Completions: ${b.join(", ")}`)}}else r(e),f("")},className:"flex-1 bg-transparent text-white outline-none",placeholder:"",autoFocus:!0,disabled:m}),m?(0,b.jsx)("span",{className:"text-yellow-400 animate-pulse",children:"..."}):(0,b.jsx)("span",{className:"text-gray-600 animate-pulse",children:"|"})]})]})]})}let n=[{id:"main",label:"Engine",offset:0},{id:"w1",label:"Discovery",offset:1},{id:"w2",label:"Scope",offset:2},{id:"w3",label:"Research",offset:3},{id:"w4",label:"Assistant",offset:4}];function o({tradelines:a,healthAll:e,analytics:h,initialError:i}){let j,[o,p]=(0,c.useState)(i),[q,r]=(0,c.useState)(a.length>0?a[0]:null),[s,t]=(0,c.useState)("feed"),[u,v]=(0,c.useState)("main"),w=(0,c.useContext)(d.PageTitleContext),x=(0,c.useContext)(d.PageActionsContext);(0,c.useEffect)(()=>(w({title:"Tradeline Servers",description:"7101 - NextBid Engine Patcher - Manage all 20 tradeline servers"}),x(null),()=>x(null)),[w,x]);let y=a=>e.tradelines?.[a]||{status:"stopped",online:0,total:4,processes:[]},z=q?y(q.name):null,A=q?.ports?.main||0;return(0,b.jsxs)("div",{className:"h-full flex flex-col -mt-4 overflow-hidden",children:[o&&(0,b.jsxs)("div",{className:"flex-shrink-0 bg-red-500/15 border border-red-500/30 text-red-400 px-4 py-3 rounded-lg mx-4 mb-4",children:[(0,b.jsx)("strong",{children:"Error:"})," ",o]}),(0,b.jsxs)("div",{className:"flex-shrink-0 flex gap-4 mx-4",children:[(0,b.jsxs)("div",{className:"w-3/4 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden h-[280px] flex flex-col",children:[(0,b.jsxs)("div",{className:"flex-shrink-0 bg-black/30 px-4 py-2 border-b border-gray-700 flex items-center justify-between",children:[(0,b.jsxs)("h3",{className:"text-xs uppercase text-gray-500 font-medium tracking-wide",children:["Tradeline Servers (",a.length,")"]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),a.filter(a=>"healthy"===y(a.name).status).length," Healthy"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-yellow-500"}),a.filter(a=>"partial"===y(a.name).status).length," Partial"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"w-2 h-2 rounded-full bg-red-500"}),a.filter(a=>"stopped"===y(a.name).status||!y(a.name).status).length," Stopped"]})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto divide-y divide-gray-700/50",children:a.map(a=>{let c,d=y(a.name),e=(c=a.name,h?.tradelines?.find(a=>a.name===c)||null);return(0,b.jsx)(f,{name:a.name,displayName:a.displayName,port:a.ports?.main||0,status:d.status||"stopped",online:d.online||0,total:d.total||4,processes:d.processes||[],storageBytes:e?.storageBytes||0,isSelected:q?.name===a.name,onClick:()=>r(a)},a.name)})})]}),(0,b.jsx)("div",{className:"w-1/4 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden h-[280px]",children:q?(0,b.jsx)(g,{tradeline:q.name,displayName:q.displayName,port:A}):(0,b.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500 text-sm p-4",children:"Select a server"})})]}),q&&(0,b.jsxs)("div",{className:"flex-1 min-h-0 mt-4 mx-4 flex gap-4 overflow-hidden",children:[(0,b.jsx)("div",{className:"w-80 flex-shrink-0 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden",children:(0,b.jsx)(k,{tradeline:q.name})}),(0,b.jsxs)("div",{className:"flex-1 bg-gray-800 border border-gray-700 rounded-xl overflow-hidden flex flex-col",children:[(0,b.jsxs)("div",{className:"flex-shrink-0 flex items-center border-b border-gray-700 bg-black/30",children:[(0,b.jsx)("button",{onClick:()=>t("feed"),className:`px-4 py-2 text-sm font-medium transition-colors ${"feed"===s?"text-white border-b-2 border-blue-500 bg-gray-800/50":"text-gray-400 hover:text-white"}`,children:"Live Feed"}),(0,b.jsx)("div",{className:"w-px h-6 bg-gray-700 mx-1"}),"feed"===s&&(j=z?.slotId||"00",n.map(a=>({id:a.id,label:a.label,suffix:0===a.offset?j:`${a.offset}${j}`}))).map(a=>(0,b.jsxs)("button",{onClick:()=>v(a.id),className:`px-3 py-2 text-xs font-medium transition-colors ${u===a.id?"text-blue-400 bg-blue-500/10":"text-gray-500 hover:text-gray-300"}`,children:[a.label,(0,b.jsx)("span",{className:"ml-1 text-gray-600 text-[10px]",children:a.suffix})]},a.id)),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsx)("button",{onClick:()=>t("terminal"),className:`px-4 py-2 text-sm font-medium transition-colors ${"terminal"===s?"text-white border-b-2 border-blue-500 bg-gray-800/50":"text-gray-400 hover:text-white"}`,children:"Terminal"})]}),(0,b.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:"feed"===s?(0,b.jsx)(l,{tradeline:q.name,activeWorker:u}):(0,b.jsx)(m,{tradeline:q.name,port:A})})]})]}),!q&&(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:"Select a server from the list above to view details"})]})}a.s(["default",()=>o],61272)}];

//# sourceMappingURL=d1936_src_app_servers_tradelines_components_TradelinesClient_tsx_42d95904._.js.map